import { createContext, useContext, useState, useCallback, useEffect } from 'react';
import { jsx } from 'react/jsx-runtime';
import wt from 'axios';

var nt=Object.defineProperty,st=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var G=(e,t,r)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))dt.call(t,r)&&G(e,r,t[r]);if(F)for(var r of F(t))ut.call(t,r)&&G(e,r,t[r]);return e},g=(e,t)=>st(e,ct(t));var A=(e,t,r)=>new Promise((i,a)=>{var d=c=>{try{n(r.next(c));}catch(o){a(o);}},_=c=>{try{n(r.throw(c));}catch(o){a(o);}},n=c=>c.done?i(c.value):Promise.resolve(c.value).then(d,_);n((r=r.apply(e,t)).next());});var C=(a=>(a.created="created",a.pending="pending",a.completed="completed",a.failed="failed",a))(C||{}),lt=(a=>(a.created="created",a.started="started",a.completed="completed",a.failed="failed",a))(lt||{});var O=(n=>(n.NO_PARTICIPANT="NO_PARTICIPANT",n.START="START",n.CLAIM="CLAIM",n.PENDING="PENDING",n.COMPLETED="COMPLETED",n.FAILED="FAILED",n.AUTH_REQUIRED="AUTH_REQUIRED",n))(O||{});var T=(p=>(p.telegram_join="telegram_join",p.telegram_connect="telegram_connect",p.youtube_view="youtube_view",p.image_upload="image_upload",p.twitter_repost="twitter_repost",p.twitter_follow="twitter_follow",p.twitter_reply="twitter_reply",p.twitter_like="twitter_like",p.twitter_activity="twitter_activity",p.twitter_connect="twitter_connect",p.discord_join="discord_join",p.discord_connect="discord_connect",p.submit_string="submit_string",p.manual="manual",p.daily_login="daily_login",p.open_url="open_url",p.youtube_subscribe="youtube_subscribe",p.twitch_follow="twitch_follow",p))(T||{});var N=createContext({apiUrl:"",apiKey:"",authToken:void 0,setAuthToken:()=>{}}),y=()=>useContext(N);function j({children:e,state:t,apiKey:r,apiUrl:i}){return t!=null||(t=ht(r,i)),jsx(N.Provider,{value:t,children:e})}var ht=(e,t)=>{let[r,i]=useState({apiUrl:t,apiKey:e,userAuthToken:void 0}),a=r.userAuthToken,d=useCallback(_=>{i(n=>g(w({},n),{userAuthToken:_}));},[]);return {apiUrl:t,apiKey:e,authToken:a,setAuthToken:d}};var v=()=>{let{authToken:e,apiUrl:t,apiKey:r}=y(),i=()=>{let _=wt.create({baseURL:t,timeout:1e4,headers:{"Api-Key":r,"Api-Version":"1.0"}});return _.interceptors.request.use(n=>{let c=e;return c&&(n.headers.Authorization=`Bearer ${c}`),n},n=>Promise.reject(n)),_.interceptors.response.use(n=>n,n=>(n.response&&n.response.status===401&&typeof window!="undefined"&&localStorage.removeItem("token"),Promise.reject(n))),_},[a,d]=useState(i());return useEffect(()=>{d(i());},[t,r,e]),a};var x={discord_not_connected:"Discord account is not connected",discord_guild_user_not_found:"Discord user not found in channel ",discord_guild_required_role_not_exists:"Discord channel verification must be passed",discord_guild_user_is_pending:"Please validate that your accepted Terms of Discord channel",discord_unauthenticated:"Please re-authenticate your discord account",telegram_not_connected:"Telegram account is not connected",telegram_member_not_found:"Telegram account not found in group",telegram_unauthenticated:"Please re-authenticate your telegram account",twitter_not_connected:"X account is not connected",twitter_follower_not_found:"Your X account do not follow required account",twitter_unauthenticated:"Please re-authenticate your X account",youtube_invalid_video_watch_length:"Please watch whole video",file_not_provided:"File not provided",file_size_exceeds:"File size exceeds limit",invalid_file_type:"Invalid file type",mission_not_found:"Mission not found",mission_not_started:"Mission not started",mission_ended:"Mission ended",task_not_found:"Task not found",task_inactive:"Task inactive",participant_not_found:"Participant not found",third_party_unauthenticated:"Please re-authenticate your account",invalid_email:"Invalid email address",invalid_value:"Invalid value",invalid_captcha:"Invalid captcha"},K=e=>e===x.discord_unauthenticated||e===x.telegram_unauthenticated||e===x.twitter_unauthenticated;var $=createContext({missions:[],tasks:[],getTasksForMission:()=>[],updateTaskStatus:()=>{},maintenance:!1}),H=()=>useContext($);function q({children:e,state:t}){return t!=null||(t=yt()),jsx($.Provider,{value:t,children:e})}var yt=()=>{let[e,t]=useState([]),[r,i]=useState([]),{authToken:a}=y(),d=v(),[_,n]=useState(!1);useEffect(()=>{e.length>0&&o(e.map(u=>u.id));},[e]),useEffect(()=>{a&&a.length===0&&n(!0);},[a]);let c=useCallback(()=>{d&&d.get("missions").then(function(u){t(u.data);}).catch(function(){n(!0);}).finally(function(){});},[d]),o=u=>{let m=u.map(f=>d.get(`missions/${f}/tasks`));Promise.all(m).then(function(f){let P=new Set(Object.values(T)),h=f.map(k=>k.data).flat().filter(k=>P.has(k.type));i(h);}).catch(function(){n(!0);});},s=(u,m)=>{i(r.map(f=>f.id===u?g(w({},f),{participation:{status:m}}):f));},l=useCallback(u=>r.filter(m=>m.mission_id===u),[r]);return useEffect(()=>{c();},[a,c]),{missions:e,tasks:r,getTasksForMission:l,updateTaskStatus:s,maintenance:_}};var J=(r=>(r.points="points",r.multiplier="multiplier",r))(J||{});var z=createContext({participant:void 0,isThirdPartyAuthenticated:()=>!1,addPoints:()=>{},getParticipant:()=>{}}),M=()=>useContext(z);function V({children:e,state:t,errorCallback:r}){return t!=null||(t=Mt(r)),jsx(z.Provider,{value:t,children:e})}var Mt=e=>{let[t,r]=useState(),{authToken:i}=y(),a=v();useEffect(()=>{i?d():r(void 0);},[i]);let d=()=>{a.get("participants/me").then(function(c){r(c.data);}).catch(function(c){console.error(c),e&&e(c);});};return {participant:t,isThirdPartyAuthenticated:c=>!!(t!=null&&t.authenticated.includes(c)),addPoints:c=>{c.points_reward&&r(o=>{var s;if(o)if(c.reward_type==="points"){let l=Math.floor(c.points_reward*((s=t==null?void 0:t.points_multiplier)!=null?s:1));r(u=>{if(u)return g(w({},u),{points:(u==null?void 0:u.points)+l})});}else r(l=>{if(l)return g(w({},l),{points_multiplier:(l==null?void 0:l.points_multiplier)+c.points_reward})});});},getParticipant:d}};var W=createContext({isParticipationLoading:!1,participate:()=>Promise.resolve(!1)}),X=()=>useContext(W);function Q({children:e,state:t,errorCallback:r}){return t!=null||(t=Dt(r)),jsx(W.Provider,{value:t,children:e})}var Dt=e=>{let[t,r]=useState(!1),{updateTaskStatus:i}=H(),{addPoints:a,getParticipant:d}=M(),_=v(),n=o=>{var l,u,m,f,P,h,k,p;let s="";(u=(l=o==null?void 0:o.response)==null?void 0:l.data)!=null&&u.message?typeof((f=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:f.message)=="string"&&(s=(h=(P=o==null?void 0:o.response)==null?void 0:P.data)==null?void 0:h.message.toString()):(k=o==null?void 0:o.response)!=null&&k.message&&(s=(p=o==null?void 0:o.response)==null?void 0:p.message.toString()),s?s in x?(K(s)&&d(),e&&e(x[s])):e&&e(s):e&&e("Server error, please try again later");};return {isParticipationLoading:t,participate:(o,s,l)=>A(void 0,null,function*(){r(!0);let u=w({},s);if(s!=null&&s.file){let m=yield fetch(s.file).then(f=>f.blob()).then(f=>{let P=new FileReader;return P.readAsDataURL(f),new Promise(h=>{P.onloadend=()=>{h(P.result);};})});u=g(w({},s),{file:{imageSrc:m}});}return yield _.post(`tasks/${o.id}`,s?u:void 0).then(function(m){return i(o.id,m.data.status),m.data.status==="completed"&&o.points_reward&&a(o),l&&l(),!0}).catch(function(m){n(m);}).finally(function(){r(!1);}),!1})}};var S=(i=>(i.twitter="twitter",i.telegram="telegram",i.discord="discord",i))(S||{});var Z=()=>{let e=new URL(window.location.href);return e.search="",e.href};var tt=Object.fromEntries(Object.values(S).map(e=>[e,!1])),et=createContext({isLoading:!1,authenticated:tt,authenticate:()=>({}),isAuthenticated:()=>!1}),rt=()=>useContext(et);function it({children:e,state:t,errorCallback:r}){return t!=null||(t=Nt(r)),jsx(et.Provider,{value:t,children:e})}var Nt=e=>{let[t,r]=useState(tt),[i,a]=useState(!1),{participant:d}=M(),_=v();return useEffect(()=>{let o=Object.fromEntries(Object.values(S).map(s=>[s,!!(d!=null&&d.authenticated.includes(s))]));r(o);},[d]),{isLoading:i,authenticated:t,authenticate:o=>{a(!0),_.get(`auth/${o}`,{params:{redirect_url:Z()}}).then(function(s){if(s.data.url){if(s.data.url.includes("?error="))throw new Error("Failed to authenticate with ThirdPartyAuth: "+s.data.url.split("?error=")[1]);window.location.href=s.data.url;}}).catch(function(s){console.error(s),e&&e(s);}).finally(()=>{a(!1);});},isAuthenticated:o=>t[o]||!1}};var Yt=e=>{var U;let{task:t,participationDisabled:r,maintenance:i,children:a,callbacks:d,onSuccess:_}=e,[n,c]=useState(!1),{participate:o,isParticipationLoading:s}=X(),l=rt(),u=t.participation&&t.participation.status==="completed",m=()=>A(void 0,null,function*(){switch(t.type){case"discord_join":window.open(t.metadata.invite_url,"_blank");break;case"twitter_follow":window.open(`https://twitter.com/intent/follow?screen_name=${t.metadata.username}`,"_blank");break;case"twitter_like":window.open(t.metadata.post_url,"_blank");break;case"twitter_reply":window.open(t.metadata.post_url,"_blank");break;case"twitter_repost":window.open(`https://twitter.com/intent/retweet?tweet_id=${t.metadata.post_id}`,"_blank");break;case"telegram_join":window.open(`https://t.me/${t.metadata.username}`,"_blank");break;case"image_upload":let b=yield d.onFileUpload(t);h({file:b});return;case"submit_string":let I=yield d.onSubmitString(t);h({value:I});return;case"open_url":window.open(t.metadata.url,"_blank");break;case"youtube_view":let ot=yield d.onYoutubeView(t,t.metadata.video_id);h({seconds:ot});return;case"daily_login":h();return;case"twitch_follow":window.open(t.metadata.twitch_url,"_blank");break;case"youtube_subscribe":window.open(t.metadata.channel_url,"_blank");break}c(!0);}),f=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.isAuthenticated("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.isAuthenticated("twitter");case"telegram_connect":case"telegram_join":return l.isAuthenticated("telegram");default:return !0}},P=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.authenticate("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.authenticate("twitter");case"telegram_connect":case"telegram_join":return l.authenticate("telegram")}},h=b=>A(void 0,null,function*(){(yield o(t,b,_))||c(!1);}),k=()=>{r||i||u||(f()?n?h():m():P());},p=()=>{var b,I;return u?"COMPLETED":t.participation?((b=t.participation)==null?void 0:b.status)==="pending"?"PENDING":((I=t.participation)==null?void 0:I.status)==="failed"?"FAILED":n?"CLAIM":f()?"START":"AUTH_REQUIRED":"NO_PARTICIPANT"};return a({onClick:!!(u||i||r||t.type==="manual"||t.type==="twitter_activity")?void 0:k,type:p(),isLoading:l.isLoading||s,disabled:r||i,comment:(U=t.participation)==null?void 0:U.comment})},$t=e=>{let{task:t,participationDisabled:r,maintenance:i,errorCallback:a,onSuccess:d}=e;return jsx(Q,{errorCallback:a,children:jsx(it,{errorCallback:a,children:jsx(Yt,{task:t,participationDisabled:r,maintenance:i,callbacks:e.callbacks,onSuccess:d,children:e.children})})})},Ht=$t;var qt=(i=>(i.guaranteed="guaranteed",i.scoreboard="scoreboard",i.lottery="lottery",i))(qt||{}),Jt=(i=>(i.crypto="crypto",i.points="points",i.points_per_task="points_per_task",i))(Jt||{});var zt=(a=>(a.participant_reward_added="participant_reward_added",a.participant_reward_removed="participant_reward_removed",a.third_party_authenticated="third_party_authenticated",a.task_completed="task_completed",a))(zt||{});var Vt=(r=>(r.email="email",r.is_equal="is_equal",r))(Vt||{});var Tr=({children:e,apiKey:t,apiUrl:r,errorCallback:i})=>jsx(j,{apiKey:t,apiUrl:r,children:jsx(V,{errorCallback:i,children:jsx(q,{children:e})})});

export { j as GamesocialProvider, Jt as MissionRewardType, qt as MissionType, q as MissionsProvider, lt as ParticipantMissionStatus, V as ParticipantProvider, C as ParticipantTaskStatus, zt as QuestWebhookType, Tr as QuestsProvider, O as TaskButtonType, Q as TaskProvider, J as TaskRewardType, T as TaskType, Vt as TaskValidation, Ht as TaskWrapper, S as ThirdPartyProvider, x as errorMessages, Z as getCurrentHrefWithoutQueryParams, K as shouldRefetchParticipant, y as useGamesocial, ht as useGamesocialState, H as useMissions, yt as useMissionsState, M as useParticipant, Mt as useParticipantState, X as useTask, Dt as useTaskState };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb2RlbHMvZW51bXMvcGFydGljaXBhbnRzLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfYnV0dG9uX3R5cGUuZW51bS50cyIsIi4uL3NyYy9tb2RlbHMvZW51bXMvdGFza3MuZW51bS50cyIsIi4uL3NyYy9wcm92aWRlcnMvdGFzay50c3giLCIuLi9zcmMvcHJvdmlkZXJzL2dhbWVzb2NpYWwudHN4IiwiLi4vc3JjL2hvb2tzL3VzZUFwaS50cyIsIi4uL3NyYy91dGlscy9lcnJvcnMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL21pc3Npb25zLnRzeCIsIi4uL3NyYy9wcm92aWRlcnMvcGFydGljaXBhbnQudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy90YXNrX3Jld2FyZF90eXBlLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3RoaXJkX3BhcnR5LmVudW0udHMiLCIuLi9zcmMvdXRpbHMvdXRpbHMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL3RoaXJkX3BhcnR5X2F1dGgudHN4IiwiLi4vc3JjL2NvbXBvbmVudHMvVGFza1dyYXBwZXIudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy9taXNzaW9ucy5lbnVtLnRzIiwiLi4vc3JjL21vZGVscy9lbnVtcy9xdWVzdF93ZWJob29rX3R5cGUudHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfdmFsaWRhdGlvbi5lbnVtLnRzIiwiLi4vc3JjL3dyYXBwZXJzLnRzeCJdLCJuYW1lcyI6WyJQYXJ0aWNpcGFudFRhc2tTdGF0dXMiLCJQYXJ0aWNpcGFudE1pc3Npb25TdGF0dXMiLCJUYXNrQnV0dG9uVHlwZSIsIlRhc2tUeXBlIiwiY3JlYXRlQ29udGV4dCIsInVzZUNvbnRleHQiLCJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwianN4IiwiY29udGV4dCIsInVzZUdhbWVzb2NpYWwiLCJHYW1lc29jaWFsUHJvdmlkZXIiLCJjaGlsZHJlbiIsInN0YXRlIiwiYXBpS2V5IiwiYXBpVXJsIiwidXNlR2FtZXNvY2lhbFN0YXRlIiwiY29uZmlnIiwic2V0Q29uZmlnIiwiYXV0aFRva2VuIiwic2V0QXV0aFRva2VuIiwidG9rZW4iLCJwcmV2IiwiX19zcHJlYWRQcm9wcyIsIl9fc3ByZWFkVmFsdWVzIiwiYXhpb3MiLCJ1c2VFZmZlY3QiLCJ1c2VBcGkiLCJjcmVhdGVBcGkiLCJhcGkiLCJlcnJvciIsInJlc3BvbnNlIiwic2V0QXBpIiwiZXJyb3JNZXNzYWdlcyIsInNob3VsZFJlZmV0Y2hQYXJ0aWNpcGFudCIsInVzZU1pc3Npb25zIiwiTWlzc2lvbnNQcm92aWRlciIsInVzZU1pc3Npb25zU3RhdGUiLCJtaXNzaW9ucyIsInNldE1pc3Npb25zIiwidGFza3MiLCJzZXRUYXNrcyIsIm1haW50ZW5hbmNlIiwic2V0TWFpbnRlbmFuY2UiLCJnZXRUYXNrcyIsIm0iLCJnZXRNaXNzaW9ucyIsIm1pc3Npb25JZHMiLCJwcm9taXNlcyIsImlkIiwicmVzcG9uc2VzIiwidmFsaWRUeXBlcyIsInIiLCJ0IiwidXBkYXRlVGFza1N0YXR1cyIsInRhc2tJZCIsInN0YXR1cyIsInRhc2siLCJnZXRUYXNrc0Zvck1pc3Npb24iLCJtaXNzaW9uSWQiLCJUYXNrUmV3YXJkVHlwZSIsInVzZVBhcnRpY2lwYW50IiwiUGFydGljaXBhbnRQcm92aWRlciIsImVycm9yQ2FsbGJhY2siLCJ1c2VQYXJ0aWNpcGFudFN0YXRlIiwicGFydGljaXBhbnQiLCJzZXRQYXJ0aWNpcGFudCIsImdldFBhcnRpY2lwYW50IiwidGhpcmRQYXJ0eSIsIl9hIiwicG9pbnRzIiwidXNlVGFzayIsIlRhc2tQcm92aWRlciIsInVzZVRhc2tTdGF0ZSIsImlzUGFydGljaXBhdGlvbkxvYWRpbmciLCJzZXRJc1BhcnRpY2lwYXRpb25Mb2FkaW5nIiwiYWRkUG9pbnRzIiwiaGFuZGxlRXJyb3IiLCJlIiwiX2IiLCJfYyIsIl9kIiwiX2UiLCJfZiIsIl9nIiwiX2giLCJtZXNzYWdlIiwiYm9keSIsImNhbGxiYWNrIiwiX19hc3luYyIsImRhdGEiLCJiYXNlNjQiLCJibG9iIiwicmVhZGVyIiwicmVzIiwiVGhpcmRQYXJ0eVByb3ZpZGVyIiwiZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMiLCJ1cmwiLCJkZWZhdWx0UHJvdmlkZXJTdGF0dXMiLCJwcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoIiwiVGhpcmRQYXJ0eUF1dGhQcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoU3RhdGUiLCJhdXRoZW50aWNhdGVkIiwic2V0QXV0aGVudGljYXRlZCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsIm5ld1N0YXR1cyIsIlRhc2tXcmFwcGVyQmFzZSIsInByb3BzIiwicGFydGljaXBhdGlvbkRpc2FibGVkIiwiY2FsbGJhY2tzIiwib25TdWNjZXNzIiwibGlua0NsaWNrZWQiLCJzZXRMaW5rQ2xpY2tlZCIsInBhcnRpY2lwYXRlIiwidGhpcmRQYXJ0eUF1dGgiLCJjb21wbGV0ZWQiLCJvbkxpbmtDbGljayIsImZpbGUiLCJvblBhcnRpY2lwYXRlIiwidmFsdWUiLCJzZWNvbmRzV2F0Y2hlZCIsImlzQXV0aGVudGljYXRlZCIsImF1dGhlbnRpY2F0ZSIsImhhbmRsZUNsaWNrIiwiZ2V0VHlwZSIsIlRhc2tXcmFwcGVyIiwiVGFza1dyYXBwZXJfZGVmYXVsdCIsIk1pc3Npb25UeXBlIiwiTWlzc2lvblJld2FyZFR5cGUiLCJRdWVzdFdlYmhvb2tUeXBlIiwiVGFza1ZhbGlkYXRpb24iLCJRdWVzdHNQcm92aWRlciJdLCJtYXBwaW5ncyI6Im9vQkFBTyxJQUFLQSxPQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsT0FBQSxJQU9BQyxRQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsUUFBQSxJQ1BMLElBQUtDLE9BQ1ZBLEVBQUEsZUFBaUIsaUJBQ2pCQSxFQUFBLE1BQVEsUUFDUkEs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IHtcbiAgY3JlYXRlZCA9ICdjcmVhdGVkJyxcbiAgcGVuZGluZyA9ICdwZW5kaW5nJyxcbiAgY29tcGxldGVkID0gJ2NvbXBsZXRlZCcsXG4gIGZhaWxlZCA9ICdmYWlsZWQnLFxufVxuXG5leHBvcnQgZW51bSBQYXJ0aWNpcGFudE1pc3Npb25TdGF0dXMge1xuICBjcmVhdGVkID0gJ2NyZWF0ZWQnLFxuICBzdGFydGVkID0gJ3N0YXJ0ZWQnLFxuICBjb21wbGV0ZWQgPSAnY29tcGxldGVkJyxcbiAgZmFpbGVkID0gJ2ZhaWxlZCcsXG59XG4iLCJleHBvcnQgZW51bSBUYXNrQnV0dG9uVHlwZSB7XG4gIE5PX1BBUlRJQ0lQQU5UID0gXCJOT19QQVJUSUNJUEFOVFwiLCAvLyBJZiBub3QgcGFydGljaXBhbnQgaXMgZm91bmQuIFVzdWFsbHkgdGhhdCBtZWFucyB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZC5cbiAgU1RBUlQgPSBcIlNUQVJUXCIsIC8vIElmIHRoZSB0YXNrIGlzIG5vdCBjb21wbGV0ZWQgYW5kIHRoZSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQuXG4gIENMQUlNID0gXCJDTEFJTVwiLCAvLyBJZiB0aGUgdGFzayBoYXMgYmVlbiBzdGFydGVkIGFuZCB0aGUgdXNlciBpcyBhdXRoZW50aWNhdGVkLlxuICBQRU5ESU5HID0gXCJQRU5ESU5HXCIsIC8vIElmIHRoZSB0YXNrIGlzIHBlbmRpbmdcbiAgQ09NUExFVEVEID0gXCJDT01QTEVURURcIiwgLy8gSWYgdGhlIHRhc2sgaXMgY29tcGxldGVkXG4gIEZBSUxFRCA9IFwiRkFJTEVEXCIsIC8vIElmIHRoZSB0YXNrIGhhcyBmYWlsZWRcbiAgQVVUSF9SRVFVSVJFRCA9IFwiQVVUSF9SRVFVSVJFRFwiLCAvLyBJZiB0YXNrIHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIGZpcnN0XG59XG4iLCJleHBvcnQgZW51bSBUYXNrVHlwZSB7XG4gIHRlbGVncmFtX2pvaW4gPSBcInRlbGVncmFtX2pvaW5cIixcbiAgdGVsZWdyYW1fY29ubmVjdCA9IFwidGVsZWdyYW1fY29ubmVjdFwiLFxuXG4gIHlvdXR1YmVfdmlldyA9IFwieW91dHViZV92aWV3XCIsXG4gIGltYWdlX3VwbG9hZCA9IFwiaW1hZ2VfdXBsb2FkXCIsXG5cbiAgdHdpdHRlcl9yZXBvc3QgPSBcInR3aXR0ZXJfcmVwb3N0XCIsXG4gIHR3aXR0ZXJfZm9sbG93ID0gXCJ0d2l0dGVyX2ZvbGxvd1wiLFxuICB0d2l0dGVyX3JlcGx5ID0gXCJ0d2l0dGVyX3JlcGx5XCIsXG4gIHR3aXR0ZXJfbGlrZSA9IFwidHdpdHRlcl9saWtlXCIsXG4gIHR3aXR0ZXJfYWN0aXZpdHkgPSBcInR3aXR0ZXJfYWN0aXZpdHlcIixcbiAgdHdpdHRlcl9jb25uZWN0ID0gXCJ0d2l0dGVyX2Nvbm5lY3RcIixcblxuICBkaXNjb3JkX2pvaW4gPSBcImRpc2NvcmRfam9pblwiLFxuICBkaXNjb3JkX2Nvbm5lY3QgPSBcImRpc2NvcmRfY29ubmVjdFwiLFxuXG4gIHN1Ym1pdF9zdHJpbmcgPSBcInN1Ym1pdF9zdHJpbmdcIixcbiAgbWFudWFsID0gXCJtYW51YWxcIixcblxuICBkYWlseV9sb2dpbiA9IFwiZGFpbHlfbG9naW5cIixcbiAgb3Blbl91cmwgPSBcIm9wZW5fdXJsXCIsXG4gIHlvdXR1YmVfc3Vic2NyaWJlID0gXCJ5b3V0dWJlX3N1YnNjcmliZVwiLFxuICB0d2l0Y2hfZm9sbG93ID0gXCJ0d2l0Y2hfZm9sbG93XCIsXG59XG4iLCJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbXBvcnQgeyB1c2VBcGkgfSBmcm9tIFwiQC9ob29rcy91c2VBcGlcIjtcbmltcG9ydCB7IFBhcnRpY2lwYW50VGFza1N0YXR1cyB9IGZyb20gXCJAL21vZGVscy9lbnVtcy9wYXJ0aWNpcGFudHMuZW51bVwiO1xuaW1wb3J0IHsgSVRhc2sgfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy90YXNrXCI7XG5pbXBvcnQgeyBlcnJvck1lc3NhZ2VzLCBzaG91bGRSZWZldGNoUGFydGljaXBhbnQgfSBmcm9tIFwiQC91dGlscy9lcnJvcnNcIjtcbmltcG9ydCB7IHVzZU1pc3Npb25zIH0gZnJvbSBcIi4vbWlzc2lvbnNcIjtcbmltcG9ydCB7IHVzZVBhcnRpY2lwYW50IH0gZnJvbSBcIi4vcGFydGljaXBhbnRcIjtcblxudHlwZSBUYXNrU3RhdGUgPSB7XG4gIGlzUGFydGljaXBhdGlvbkxvYWRpbmc6IGJvb2xlYW47XG4gIHBhcnRpY2lwYXRlOiAodGFzazogSVRhc2ssIGJvZHk/OiBhbnksIGNhbGxiYWNrPzogYW55KSA9PiBQcm9taXNlPGJvb2xlYW4+O1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8VGFza1N0YXRlPih7XG4gIGlzUGFydGljaXBhdGlvbkxvYWRpbmc6IGZhbHNlLFxuICBwYXJ0aWNpcGF0ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlVGFzayA9ICgpID0+IHVzZUNvbnRleHQoY29udGV4dCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBUYXNrUHJvdmlkZXIoe1xuICBjaGlsZHJlbixcbiAgc3RhdGUsXG4gIGVycm9yQ2FsbGJhY2ssXG59OiB7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIHN0YXRlPzogVGFza1N0YXRlO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICBzdGF0ZSA/Pz0gdXNlVGFza1N0YXRlKGVycm9yQ2FsbGJhY2spO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVRhc2tTdGF0ZSA9IChcbiAgZXJyb3JDYWxsYmFjaz86IChlcnJvcjogYW55KSA9PiB2b2lkXG4pOiBUYXNrU3RhdGUgPT4ge1xuICBjb25zdCBbaXNQYXJ0aWNpcGF0aW9uTG9hZGluZywgc2V0SXNQYXJ0aWNpcGF0aW9uTG9hZGluZ10gPVxuICAgIHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgeyB1cGRhdGVUYXNrU3RhdHVzIH0gPSB1c2VNaXNzaW9ucygpO1xuICBjb25zdCB7IGFkZFBvaW50cywgZ2V0UGFydGljaXBhbnQgfSA9IHVzZVBhcnRpY2lwYW50KCk7XG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIGNvbnN0IGhhbmRsZUVycm9yID0gKGU6IGFueSkgPT4ge1xuICAgIGxldCBtZXNzYWdlOiBzdHJpbmcgPSBcIlwiO1xuICAgIGlmIChlPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSkge1xuICAgICAgaWYgKHR5cGVvZiBlPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtZXNzYWdlID0gZT8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UudG9TdHJpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHRvZG9cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGU/LnJlc3BvbnNlPy5tZXNzYWdlKSB7XG4gICAgICBtZXNzYWdlID0gZT8ucmVzcG9uc2U/Lm1lc3NhZ2UudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIGVycm9yQ2FsbGJhY2sgJiYgZXJyb3JDYWxsYmFjayhcIlNlcnZlciBlcnJvciwgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlclwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG1lc3NhZ2UgaW4gZXJyb3JNZXNzYWdlcykge1xuICAgICAgICBjb25zdCBzID0gc2hvdWxkUmVmZXRjaFBhcnRpY2lwYW50KG1lc3NhZ2UpO1xuICAgICAgICBpZiAocykge1xuICAgICAgICAgIC8vIFRPRE8gTWF5YmUgYXdhaXQgdGhpc1xuICAgICAgICAgIGdldFBhcnRpY2lwYW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKGVycm9yTWVzc2FnZXNbbWVzc2FnZV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBwYXJ0aWNpcGF0ZSA9IGFzeW5jIChcbiAgICB0YXNrOiBJVGFzayxcbiAgICBib2R5PzogYW55LFxuICAgIGNhbGxiYWNrPzogYW55XG4gICk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIHNldElzUGFydGljaXBhdGlvbkxvYWRpbmcodHJ1ZSk7XG4gICAgbGV0IGRhdGEgPSB7IC4uLmJvZHkgfTtcbiAgICBpZiAoYm9keT8uZmlsZSkge1xuICAgICAgY29uc3QgYmFzZTY0ID0gYXdhaXQgZmV0Y2goYm9keS5maWxlKVxuICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmJsb2IoKSlcbiAgICAgICAgLnRoZW4oKGJsb2IpID0+IHtcbiAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpO1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzKSA9PiB7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4ge1xuICAgICAgICAgICAgICByZXMocmVhZGVyLnJlc3VsdCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIGRhdGEgPSB7XG4gICAgICAgIC4uLmJvZHksXG4gICAgICAgIGZpbGU6IHtcbiAgICAgICAgICBpbWFnZVNyYzogYmFzZTY0LFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG4gICAgYXdhaXQgYXBpXG4gICAgICAucG9zdChgdGFza3MvJHt0YXNrLmlkfWAsIGJvZHkgPyBkYXRhIDogdW5kZWZpbmVkKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHVwZGF0ZVRhc2tTdGF0dXModGFzay5pZCwgcmVzcG9uc2UuZGF0YS5zdGF0dXMpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgcmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09IFBhcnRpY2lwYW50VGFza1N0YXR1cy5jb21wbGV0ZWQgJiZcbiAgICAgICAgICB0YXNrLnBvaW50c19yZXdhcmRcbiAgICAgICAgKSB7XG4gICAgICAgICAgYWRkUG9pbnRzKHRhc2spO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBoYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXRJc1BhcnRpY2lwYXRpb25Mb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaXNQYXJ0aWNpcGF0aW9uTG9hZGluZyxcbiAgICBwYXJ0aWNpcGF0ZSxcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDYWxsYmFjaywgdXNlQ29udGV4dCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcblxuaW50ZXJmYWNlIElDb25maWcge1xuICBhcGlVcmw6IHN0cmluZztcbiAgYXBpS2V5OiBzdHJpbmc7XG4gIHVzZXJBdXRoVG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZDtcbn1cblxudHlwZSBHYW1lc29jaWFsU3RhdGUgPSB7XG4gIGFwaVVybDogc3RyaW5nO1xuICBhcGlLZXk6IHN0cmluZztcbiAgYXV0aFRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIHNldEF1dGhUb2tlbjogKHRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHZvaWQ7XG59O1xuXG5jb25zdCBjb250ZXh0ID0gY3JlYXRlQ29udGV4dDxHYW1lc29jaWFsU3RhdGU+KHtcbiAgYXBpVXJsOiBcIlwiLFxuICBhcGlLZXk6IFwiXCIsXG4gIGF1dGhUb2tlbjogdW5kZWZpbmVkLFxuICBzZXRBdXRoVG9rZW46ICgpID0+IHt9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VHYW1lc29jaWFsID0gKCkgPT4gdXNlQ29udGV4dChjb250ZXh0KTtcblxuZXhwb3J0IGZ1bmN0aW9uIEdhbWVzb2NpYWxQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbiAgYXBpS2V5LFxuICBhcGlVcmwsXG59OiB7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIHN0YXRlPzogR2FtZXNvY2lhbFN0YXRlO1xuICBhcGlLZXk6IHN0cmluZztcbiAgYXBpVXJsOiBzdHJpbmc7XG59KSB7XG4gIHN0YXRlID8/PSB1c2VHYW1lc29jaWFsU3RhdGUoYXBpS2V5LCBhcGlVcmwpO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZUdhbWVzb2NpYWxTdGF0ZSA9IChcbiAgYXBpS2V5OiBzdHJpbmcsXG4gIGFwaVVybDogc3RyaW5nXG4pOiBHYW1lc29jaWFsU3RhdGUgPT4ge1xuICBjb25zdCBbY29uZmlnLCBzZXRDb25maWddID0gdXNlU3RhdGU8SUNvbmZpZz4oe1xuICAgIGFwaVVybDogYXBpVXJsLFxuICAgIGFwaUtleTogYXBpS2V5LFxuICAgIHVzZXJBdXRoVG9rZW46IHVuZGVmaW5lZCxcbiAgfSk7XG5cbiAgY29uc3QgYXV0aFRva2VuID0gY29uZmlnLnVzZXJBdXRoVG9rZW47XG5cbiAgY29uc3Qgc2V0QXV0aFRva2VuID0gdXNlQ2FsbGJhY2soKHRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHtcbiAgICBzZXRDb25maWcoKHByZXYpID0+ICh7XG4gICAgICAuLi5wcmV2LFxuICAgICAgdXNlckF1dGhUb2tlbjogdG9rZW4sXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIHtcbiAgICBhcGlVcmwsXG4gICAgYXBpS2V5LFxuICAgIGF1dGhUb2tlbixcbiAgICBzZXRBdXRoVG9rZW4sXG4gIH07XG59O1xuIiwiaW1wb3J0IHsgdXNlR2FtZXNvY2lhbCB9IGZyb20gXCJAL3Byb3ZpZGVycy9nYW1lc29jaWFsXCI7XG5pbXBvcnQgYXhpb3MsIHsgQXhpb3NJbnN0YW5jZSB9IGZyb20gXCJheGlvc1wiO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgY29uc3QgdXNlQXBpID0gKCk6IEF4aW9zSW5zdGFuY2UgPT4ge1xuICBjb25zdCB7IGF1dGhUb2tlbiwgYXBpVXJsLCBhcGlLZXkgfSA9IHVzZUdhbWVzb2NpYWwoKTtcblxuICBjb25zdCBjcmVhdGVBcGkgPSAoKTogQXhpb3NJbnN0YW5jZSA9PiB7XG4gICAgY29uc3QgYXBpID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgIGJhc2VVUkw6IGFwaVVybCxcbiAgICAgIHRpbWVvdXQ6IDEwMDAwLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkFwaS1LZXlcIjogYXBpS2V5LFxuICAgICAgICBcIkFwaS1WZXJzaW9uXCI6IFwiMS4wXCIsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYXBpLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShcbiAgICAgIChjb25maWcpID0+IHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBhdXRoVG9rZW47XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7dG9rZW59YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgfSxcbiAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgICk7XG5cbiAgICBhcGkuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShcbiAgICAgIChyZXNwb25zZSkgPT4ge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICB9LFxuICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgIC8vIEVuc3VyZSB0aGlzIHJ1bnMgb25seSBpbiB0aGUgYnJvd3NlclxuICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRva2VuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIGFwaTtcbiAgfTtcblxuICBjb25zdCBbYXBpLCBzZXRBcGldID0gdXNlU3RhdGU8QXhpb3NJbnN0YW5jZT4oY3JlYXRlQXBpKCkpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc2V0QXBpKGNyZWF0ZUFwaSgpKTtcbiAgfSwgW2FwaVVybCwgYXBpS2V5LCBhdXRoVG9rZW5dKTtcblxuICByZXR1cm4gYXBpO1xufTtcbiIsImV4cG9ydCB0eXBlIEVycm9yTWVzc2FnZXMgPSB7XG4gIFtrZXk6IHN0cmluZ106IHN0cmluZztcbn07XG5cbmV4cG9ydCBjb25zdCBlcnJvck1lc3NhZ2VzOiBFcnJvck1lc3NhZ2VzID0ge1xuICBkaXNjb3JkX25vdF9jb25uZWN0ZWQ6IFwiRGlzY29yZCBhY2NvdW50IGlzIG5vdCBjb25uZWN0ZWRcIixcbiAgZGlzY29yZF9ndWlsZF91c2VyX25vdF9mb3VuZDogXCJEaXNjb3JkIHVzZXIgbm90IGZvdW5kIGluIGNoYW5uZWwgXCIsXG4gIGRpc2NvcmRfZ3VpbGRfcmVxdWlyZWRfcm9sZV9ub3RfZXhpc3RzOlxuICAgIFwiRGlzY29yZCBjaGFubmVsIHZlcmlmaWNhdGlvbiBtdXN0IGJlIHBhc3NlZFwiLFxuICBkaXNjb3JkX2d1aWxkX3VzZXJfaXNfcGVuZGluZzpcbiAgICBcIlBsZWFzZSB2YWxpZGF0ZSB0aGF0IHlvdXIgYWNjZXB0ZWQgVGVybXMgb2YgRGlzY29yZCBjaGFubmVsXCIsXG4gIGRpc2NvcmRfdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSByZS1hdXRoZW50aWNhdGUgeW91ciBkaXNjb3JkIGFjY291bnRcIixcblxuICB0ZWxlZ3JhbV9ub3RfY29ubmVjdGVkOiBcIlRlbGVncmFtIGFjY291bnQgaXMgbm90IGNvbm5lY3RlZFwiLFxuICB0ZWxlZ3JhbV9tZW1iZXJfbm90X2ZvdW5kOiBcIlRlbGVncmFtIGFjY291bnQgbm90IGZvdW5kIGluIGdyb3VwXCIsXG4gIHRlbGVncmFtX3VuYXV0aGVudGljYXRlZDogXCJQbGVhc2UgcmUtYXV0aGVudGljYXRlIHlvdXIgdGVsZWdyYW0gYWNjb3VudFwiLFxuXG4gIHR3aXR0ZXJfbm90X2Nvbm5lY3RlZDogXCJYIGFjY291bnQgaXMgbm90IGNvbm5lY3RlZFwiLFxuICB0d2l0dGVyX2ZvbGxvd2VyX25vdF9mb3VuZDogXCJZb3VyIFggYWNjb3VudCBkbyBub3QgZm9sbG93IHJlcXVpcmVkIGFjY291bnRcIixcbiAgdHdpdHRlcl91bmF1dGhlbnRpY2F0ZWQ6IFwiUGxlYXNlIHJlLWF1dGhlbnRpY2F0ZSB5b3VyIFggYWNjb3VudFwiLFxuXG4gIHlvdXR1YmVfaW52YWxpZF92aWRlb193YXRjaF9sZW5ndGg6IFwiUGxlYXNlIHdhdGNoIHdob2xlIHZpZGVvXCIsXG5cbiAgZmlsZV9ub3RfcHJvdmlkZWQ6IFwiRmlsZSBub3QgcHJvdmlkZWRcIixcbiAgZmlsZV9zaXplX2V4Y2VlZHM6IFwiRmlsZSBzaXplIGV4Y2VlZHMgbGltaXRcIixcbiAgaW52YWxpZF9maWxlX3R5cGU6IFwiSW52YWxpZCBmaWxlIHR5cGVcIixcblxuICBtaXNzaW9uX25vdF9mb3VuZDogXCJNaXNzaW9uIG5vdCBmb3VuZFwiLFxuICBtaXNzaW9uX25vdF9zdGFydGVkOiBcIk1pc3Npb24gbm90IHN0YXJ0ZWRcIixcbiAgbWlzc2lvbl9lbmRlZDogXCJNaXNzaW9uIGVuZGVkXCIsXG5cbiAgdGFza19ub3RfZm91bmQ6IFwiVGFzayBub3QgZm91bmRcIixcbiAgdGFza19pbmFjdGl2ZTogXCJUYXNrIGluYWN0aXZlXCIsXG5cbiAgcGFydGljaXBhbnRfbm90X2ZvdW5kOiBcIlBhcnRpY2lwYW50IG5vdCBmb3VuZFwiLFxuXG4gIHRoaXJkX3BhcnR5X3VuYXV0aGVudGljYXRlZDogXCJQbGVhc2UgcmUtYXV0aGVudGljYXRlIHlvdXIgYWNjb3VudFwiLFxuXG4gIGludmFsaWRfZW1haWw6IFwiSW52YWxpZCBlbWFpbCBhZGRyZXNzXCIsXG4gIGludmFsaWRfdmFsdWU6IFwiSW52YWxpZCB2YWx1ZVwiLFxuICBpbnZhbGlkX2NhcHRjaGE6IFwiSW52YWxpZCBjYXB0Y2hhXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgc2hvdWxkUmVmZXRjaFBhcnRpY2lwYW50ID0gKGVycm9yOiBzdHJpbmcpID0+IHtcbiAgcmV0dXJuIChcbiAgICBlcnJvciA9PT0gZXJyb3JNZXNzYWdlcy5kaXNjb3JkX3VuYXV0aGVudGljYXRlZCB8fFxuICAgIGVycm9yID09PSBlcnJvck1lc3NhZ2VzLnRlbGVncmFtX3VuYXV0aGVudGljYXRlZCB8fFxuICAgIGVycm9yID09PSBlcnJvck1lc3NhZ2VzLnR3aXR0ZXJfdW5hdXRoZW50aWNhdGVkXG4gICk7XG59O1xuIiwiaW1wb3J0IHsgdXNlQXBpIH0gZnJvbSBcIkAvaG9va3MvdXNlQXBpXCI7XG5pbXBvcnQgeyBQYXJ0aWNpcGFudFRhc2tTdGF0dXMgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvcGFydGljaXBhbnRzLmVudW1cIjtcbmltcG9ydCB7IElNaXNzaW9uIH0gZnJvbSBcIkAvbW9kZWxzL2ludGVyZmFjZXMvbWlzc2lvblwiO1xuaW1wb3J0IHsgSVRhc2sgfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy90YXNrXCI7XG5pbXBvcnQge1xuICBjcmVhdGVDb250ZXh0LFxuICB1c2VDYWxsYmFjayxcbiAgdXNlQ29udGV4dCxcbiAgdXNlRWZmZWN0LFxuICB1c2VTdGF0ZSxcbn0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBUYXNrVHlwZSB9IGZyb20gXCIuLlwiO1xuaW1wb3J0IHsgdXNlR2FtZXNvY2lhbCB9IGZyb20gXCIuL2dhbWVzb2NpYWxcIjtcblxudHlwZSBNaXNzaW9uc1N0YXRlID0ge1xuICBtaXNzaW9uczogSU1pc3Npb25bXTtcbiAgdGFza3M6IElUYXNrW107XG4gIGdldFRhc2tzRm9yTWlzc2lvbjogKG1pc3Npb25JZDogc3RyaW5nKSA9PiBJVGFza1tdO1xuICB1cGRhdGVUYXNrU3RhdHVzOiAodGFza0lkOiBzdHJpbmcsIHN0YXR1czogUGFydGljaXBhbnRUYXNrU3RhdHVzKSA9PiB2b2lkO1xuICBtYWludGVuYW5jZTogYm9vbGVhbjtcbn07XG5cbmNvbnN0IGNvbnRleHQgPSBjcmVhdGVDb250ZXh0PE1pc3Npb25zU3RhdGU+KHtcbiAgbWlzc2lvbnM6IFtdLFxuICB0YXNrczogW10sXG4gIGdldFRhc2tzRm9yTWlzc2lvbjogKCkgPT4gW10sXG4gIHVwZGF0ZVRhc2tTdGF0dXM6ICgpID0+IHt9LFxuICBtYWludGVuYW5jZTogZmFsc2UsXG59KTtcblxuZXhwb3J0IGNvbnN0IHVzZU1pc3Npb25zID0gKCkgPT4gdXNlQ29udGV4dChjb250ZXh0KTtcblxuZXhwb3J0IGZ1bmN0aW9uIE1pc3Npb25zUHJvdmlkZXIoe1xuICBjaGlsZHJlbixcbiAgc3RhdGUsXG59OiB7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIHN0YXRlPzogTWlzc2lvbnNTdGF0ZTtcbn0pIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHN0YXRlID8/PSB1c2VNaXNzaW9uc1N0YXRlKCk7XG4gIHJldHVybiA8Y29udGV4dC5Qcm92aWRlciB2YWx1ZT17c3RhdGV9PntjaGlsZHJlbn08L2NvbnRleHQuUHJvdmlkZXI+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlTWlzc2lvbnNTdGF0ZSA9ICgpOiBNaXNzaW9uc1N0YXRlID0+IHtcbiAgY29uc3QgW21pc3Npb25zLCBzZXRNaXNzaW9uc10gPSB1c2VTdGF0ZTxJTWlzc2lvbltdPihbXSk7XG4gIGNvbnN0IFt0YXNrcywgc2V0VGFza3NdID0gdXNlU3RhdGU8SVRhc2tbXT4oW10pO1xuICBjb25zdCB7IGF1dGhUb2tlbiB9ID0gdXNlR2FtZXNvY2lhbCgpO1xuICBjb25zdCBhcGkgPSB1c2VBcGkoKTtcblxuICBjb25zdCBbbWFpbnRlbmFuY2UsIHNldE1haW50ZW5hbmNlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChtaXNzaW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBnZXRUYXNrcyhtaXNzaW9ucy5tYXAoKG0pID0+IG0uaWQpKTtcbiAgICB9XG4gIH0sIFttaXNzaW9uc10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGF1dGhUb2tlbiAmJiBhdXRoVG9rZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICBzZXRNYWludGVuYW5jZSh0cnVlKTtcbiAgICB9XG4gIH0sIFthdXRoVG9rZW5dKTtcblxuICBjb25zdCBnZXRNaXNzaW9ucyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoYXBpKSB7XG4gICAgICBhcGlcbiAgICAgICAgLmdldChcIm1pc3Npb25zXCIpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIHNldE1pc3Npb25zKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNldE1haW50ZW5hbmNlKHRydWUpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAvLyBhbHdheXMgZXhlY3V0ZWRcbiAgICAgICAgfSk7XG4gICAgfVxuICB9LCBbYXBpXSk7XG5cbiAgY29uc3QgZ2V0VGFza3MgPSAobWlzc2lvbklkczogc3RyaW5nW10pID0+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IG1pc3Npb25JZHMubWFwKChpZCkgPT4gYXBpLmdldChgbWlzc2lvbnMvJHtpZH0vdGFza3NgKSk7XG4gICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2VzKSB7XG4gICAgICAgIGNvbnN0IHZhbGlkVHlwZXMgPSBuZXcgU2V0KE9iamVjdC52YWx1ZXMoVGFza1R5cGUpKTtcbiAgICAgICAgY29uc3QgdGFza3MgPSByZXNwb25zZXNcbiAgICAgICAgICAubWFwKChyKSA9PiByLmRhdGEpXG4gICAgICAgICAgLmZsYXQoKVxuICAgICAgICAgIC5maWx0ZXIoKHQpID0+IHZhbGlkVHlwZXMuaGFzKHQudHlwZSkpO1xuICAgICAgICBzZXRUYXNrcyh0YXNrcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2V0TWFpbnRlbmFuY2UodHJ1ZSk7XG4gICAgICB9KTtcbiAgfTtcblxuICBjb25zdCB1cGRhdGVUYXNrU3RhdHVzID0gKHRhc2tJZDogc3RyaW5nLCBzdGF0dXM6IFBhcnRpY2lwYW50VGFza1N0YXR1cykgPT4ge1xuICAgIHNldFRhc2tzKFxuICAgICAgdGFza3MubWFwKCh0YXNrKSA9PlxuICAgICAgICB0YXNrLmlkID09PSB0YXNrSWQgPyB7IC4uLnRhc2ssIHBhcnRpY2lwYXRpb246IHsgc3RhdHVzIH0gfSA6IHRhc2tcbiAgICAgIClcbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IGdldFRhc2tzRm9yTWlzc2lvbiA9IHVzZUNhbGxiYWNrKFxuICAgIChtaXNzaW9uSWQ6IHN0cmluZykgPT4ge1xuICAgICAgcmV0dXJuIHRhc2tzLmZpbHRlcigodCkgPT4gdC5taXNzaW9uX2lkID09PSBtaXNzaW9uSWQpO1xuICAgIH0sXG4gICAgW3Rhc2tzXVxuICApO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZ2V0TWlzc2lvbnMoKTtcbiAgfSwgW2F1dGhUb2tlbiwgZ2V0TWlzc2lvbnNdKTtcblxuICByZXR1cm4ge1xuICAgIG1pc3Npb25zLFxuICAgIHRhc2tzLFxuICAgIGdldFRhc2tzRm9yTWlzc2lvbixcbiAgICB1cGRhdGVUYXNrU3RhdHVzLFxuICAgIG1haW50ZW5hbmNlLFxuICB9O1xufTtcbiIsImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlQXBpIH0gZnJvbSBcIkAvaG9va3MvdXNlQXBpXCI7XG5pbXBvcnQgeyBUYXNrUmV3YXJkVHlwZSB9IGZyb20gXCJAL21vZGVscy9lbnVtcy90YXNrX3Jld2FyZF90eXBlLmVudW1cIjtcbmltcG9ydCB7IElUYXNrIH0gZnJvbSBcIkAvbW9kZWxzL2ludGVyZmFjZXMvdGFza1wiO1xuaW1wb3J0IHsgVGhpcmRQYXJ0eVByb3ZpZGVyIH0gZnJvbSBcIi4uL21vZGVscy9lbnVtcy90aGlyZF9wYXJ0eS5lbnVtXCI7XG5pbXBvcnQgeyBJUGFydGljaXBhbnQgfSBmcm9tIFwiLi4vbW9kZWxzL2ludGVyZmFjZXMvcGFydGljaXBhbnRcIjtcbmltcG9ydCB7IHVzZUdhbWVzb2NpYWwgfSBmcm9tIFwiLi9nYW1lc29jaWFsXCI7XG5cbnR5cGUgUGFydGljaXBhbnRTdGF0ZSA9IHtcbiAgcGFydGljaXBhbnQ/OiBJUGFydGljaXBhbnQ7XG4gIGlzVGhpcmRQYXJ0eUF1dGhlbnRpY2F0ZWQ6ICh0aGlyZFBhcnR5OiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IGJvb2xlYW47XG4gIGFkZFBvaW50czogKHRhc2s6IElUYXNrKSA9PiB2b2lkO1xuICBnZXRQYXJ0aWNpcGFudDogKCkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IGNvbnRleHQgPSBjcmVhdGVDb250ZXh0PFBhcnRpY2lwYW50U3RhdGU+KHtcbiAgcGFydGljaXBhbnQ6IHVuZGVmaW5lZCxcbiAgaXNUaGlyZFBhcnR5QXV0aGVudGljYXRlZDogKCkgPT4gZmFsc2UsXG4gIGFkZFBvaW50czogKCkgPT4ge30sXG4gIGdldFBhcnRpY2lwYW50OiAoKSA9PiB7fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlUGFydGljaXBhbnQgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gUGFydGljaXBhbnRQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbiAgZXJyb3JDYWxsYmFjayxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBQYXJ0aWNpcGFudFN0YXRlO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICBzdGF0ZSA/Pz0gdXNlUGFydGljaXBhbnRTdGF0ZShlcnJvckNhbGxiYWNrKTtcbiAgcmV0dXJuIDxjb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzdGF0ZX0+e2NoaWxkcmVufTwvY29udGV4dC5Qcm92aWRlcj47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VQYXJ0aWNpcGFudFN0YXRlID0gKFxuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWRcbik6IFBhcnRpY2lwYW50U3RhdGUgPT4ge1xuICBjb25zdCBbcGFydGljaXBhbnQsIHNldFBhcnRpY2lwYW50XSA9IHVzZVN0YXRlPElQYXJ0aWNpcGFudD4oKTtcbiAgY29uc3QgeyBhdXRoVG9rZW4gfSA9IHVzZUdhbWVzb2NpYWwoKTtcblxuICBjb25zdCBhcGkgPSB1c2VBcGkoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChhdXRoVG9rZW4pIHtcbiAgICAgIGdldFBhcnRpY2lwYW50KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFBhcnRpY2lwYW50KHVuZGVmaW5lZCk7XG4gICAgfVxuICB9LCBbYXV0aFRva2VuXSk7XG5cbiAgY29uc3QgZ2V0UGFydGljaXBhbnQgPSAoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZ2V0KGBwYXJ0aWNpcGFudHMvbWVgKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHNldFBhcnRpY2lwYW50KHJlc3BvbnNlLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKGVycm9yKTtcbiAgICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGlzVGhpcmRQYXJ0eUF1dGhlbnRpY2F0ZWQgPSAoXG4gICAgdGhpcmRQYXJ0eTogVGhpcmRQYXJ0eVByb3ZpZGVyXG4gICk6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiAhIXBhcnRpY2lwYW50Py5hdXRoZW50aWNhdGVkLmluY2x1ZGVzKHRoaXJkUGFydHkpO1xuICB9O1xuXG4gIGNvbnN0IGFkZFBvaW50cyA9ICh0YXNrOiBJVGFzaykgPT4ge1xuICAgIGlmICghdGFzay5wb2ludHNfcmV3YXJkKSByZXR1cm47XG5cbiAgICBzZXRQYXJ0aWNpcGFudCgocHJldikgPT4ge1xuICAgICAgaWYgKCFwcmV2KSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgaWYgKHRhc2sucmV3YXJkX3R5cGUgPT09IFRhc2tSZXdhcmRUeXBlLnBvaW50cykge1xuICAgICAgICBjb25zdCBwb2ludHMgPSBNYXRoLmZsb29yKFxuICAgICAgICAgIHRhc2sucG9pbnRzX3Jld2FyZCEgKiAocGFydGljaXBhbnQ/LnBvaW50c19tdWx0aXBsaWVyID8/IDEpXG4gICAgICAgICk7XG4gICAgICAgIHNldFBhcnRpY2lwYW50KChwcmV2KSA9PiB7XG4gICAgICAgICAgaWYgKCFwcmV2KSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgICAgcG9pbnRzOiBwcmV2Py5wb2ludHMgKyBwb2ludHMsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRQYXJ0aWNpcGFudCgocHJldikgPT4ge1xuICAgICAgICAgIGlmICghcHJldikgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICAgIHBvaW50c19tdWx0aXBsaWVyOiBwcmV2Py5wb2ludHNfbXVsdGlwbGllciArIHRhc2sucG9pbnRzX3Jld2FyZCEsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBwYXJ0aWNpcGFudCxcbiAgICBpc1RoaXJkUGFydHlBdXRoZW50aWNhdGVkLFxuICAgIGFkZFBvaW50cyxcbiAgICBnZXRQYXJ0aWNpcGFudCxcbiAgfTtcbn07XG4iLCJleHBvcnQgZW51bSBUYXNrUmV3YXJkVHlwZSB7XG4gIHBvaW50cyA9IFwicG9pbnRzXCIsXG4gIG11bHRpcGxpZXIgPSBcIm11bHRpcGxpZXJcIixcbn1cbiIsImV4cG9ydCBlbnVtIFRoaXJkUGFydHlQcm92aWRlciB7XG4gIHR3aXR0ZXIgPSBcInR3aXR0ZXJcIixcbiAgdGVsZWdyYW0gPSBcInRlbGVncmFtXCIsXG4gIGRpc2NvcmQgPSBcImRpc2NvcmRcIixcbn1cbiIsImV4cG9ydCBjb25zdCBnZXRDdXJyZW50SHJlZldpdGhvdXRRdWVyeVBhcmFtcyA9ICgpID0+IHtcbiAgLy8gQ3JlYXRlIGEgbmV3IFVSTCBvYmplY3QgYmFzZWQgb24gd2luZG93LmxvY2F0aW9uXG4gIGNvbnN0IHVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG4gIC8vIFNldCB0aGUgc2VhcmNoIChxdWVyeSBwYXJhbWV0ZXJzKSB0byBhbiBlbXB0eSBzdHJpbmcgdG8gcmVtb3ZlIGl0XG4gIHVybC5zZWFyY2ggPSBcIlwiO1xuXG4gIC8vIFJldHVybiB0aGUgaHJlZiB3aXRob3V0IHF1ZXJ5IHBhcmFtZXRlcnNcbiAgcmV0dXJuIHVybC5ocmVmO1xufTtcbiIsImltcG9ydCB7IHVzZUFwaSB9IGZyb20gXCJAL2hvb2tzL3VzZUFwaVwiO1xuaW1wb3J0IHsgVGhpcmRQYXJ0eVByb3ZpZGVyIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3RoaXJkX3BhcnR5LmVudW1cIjtcbmltcG9ydCB7IGdldEN1cnJlbnRIcmVmV2l0aG91dFF1ZXJ5UGFyYW1zIH0gZnJvbSBcIkAvdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVBhcnRpY2lwYW50IH0gZnJvbSBcIi4vcGFydGljaXBhbnRcIjtcblxudHlwZSBQcm92aWRlclN0YXR1cyA9IHtcbiAgW2tleSBpbiBUaGlyZFBhcnR5UHJvdmlkZXJdOiBib29sZWFuO1xufTtcblxuY29uc3QgZGVmYXVsdFByb3ZpZGVyU3RhdHVzOiBQcm92aWRlclN0YXR1cyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgT2JqZWN0LnZhbHVlcyhUaGlyZFBhcnR5UHJvdmlkZXIpLm1hcCgocHJvdmlkZXIpID0+IFtwcm92aWRlciwgZmFsc2VdKVxuKSBhcyBQcm92aWRlclN0YXR1cztcblxudHlwZSBUaGlyZFBhcnR5QXV0aFN0YXRlID0ge1xuICBpc0xvYWRpbmc6IGJvb2xlYW47XG4gIGF1dGhlbnRpY2F0ZWQ6IFByb3ZpZGVyU3RhdHVzO1xuICBhdXRoZW50aWNhdGU6IChwcm92aWRlcjogVGhpcmRQYXJ0eVByb3ZpZGVyKSA9PiB2b2lkO1xuICBpc0F1dGhlbnRpY2F0ZWQ6IChwcm92aWRlcjogVGhpcmRQYXJ0eVByb3ZpZGVyKSA9PiBib29sZWFuO1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8VGhpcmRQYXJ0eUF1dGhTdGF0ZT4oe1xuICBpc0xvYWRpbmc6IGZhbHNlLFxuICBhdXRoZW50aWNhdGVkOiBkZWZhdWx0UHJvdmlkZXJTdGF0dXMsXG4gIGF1dGhlbnRpY2F0ZTogKCkgPT4gKHt9KSxcbiAgaXNBdXRoZW50aWNhdGVkOiAoKSA9PiBmYWxzZSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlVGhpcmRQYXJ0eUF1dGggPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gVGhpcmRQYXJ0eUF1dGhQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbiAgZXJyb3JDYWxsYmFjayxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBUaGlyZFBhcnR5QXV0aFN0YXRlO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICBzdGF0ZSA/Pz0gdXNlVGhpcmRQYXJ0eUF1dGhTdGF0ZShlcnJvckNhbGxiYWNrKTtcbiAgcmV0dXJuIDxjb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzdGF0ZX0+e2NoaWxkcmVufTwvY29udGV4dC5Qcm92aWRlcj47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VUaGlyZFBhcnR5QXV0aFN0YXRlID0gKFxuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWRcbik6IFRoaXJkUGFydHlBdXRoU3RhdGUgPT4ge1xuICBjb25zdCBbYXV0aGVudGljYXRlZCwgc2V0QXV0aGVudGljYXRlZF0gPSB1c2VTdGF0ZTxQcm92aWRlclN0YXR1cz4oXG4gICAgZGVmYXVsdFByb3ZpZGVyU3RhdHVzXG4gICk7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG4gIGNvbnN0IHsgcGFydGljaXBhbnQgfSA9IHVzZVBhcnRpY2lwYW50KCk7XG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgbmV3U3RhdHVzOiBQcm92aWRlclN0YXR1cyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgIE9iamVjdC52YWx1ZXMoVGhpcmRQYXJ0eVByb3ZpZGVyKS5tYXAoKHByb3ZpZGVyKSA9PiBbXG4gICAgICAgIHByb3ZpZGVyLFxuICAgICAgICAhIXBhcnRpY2lwYW50Py5hdXRoZW50aWNhdGVkLmluY2x1ZGVzKHByb3ZpZGVyKSxcbiAgICAgIF0pXG4gICAgKSBhcyBQcm92aWRlclN0YXR1cztcblxuICAgIHNldEF1dGhlbnRpY2F0ZWQobmV3U3RhdHVzKTtcbiAgfSwgW3BhcnRpY2lwYW50XSk7XG5cbiAgY29uc3QgaXNBdXRoZW50aWNhdGVkID0gKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gYXV0aGVudGljYXRlZFtwcm92aWRlcl0gfHwgZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgYXV0aGVudGljYXRlID0gKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpOiB2b2lkID0+IHtcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZ2V0KGBhdXRoLyR7cHJvdmlkZXJ9YCwge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICByZWRpcmVjdF91cmw6IGdldEN1cnJlbnRIcmVmV2l0aG91dFF1ZXJ5UGFyYW1zKCksXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnVybCkge1xuICAgICAgICAgIC8vY2hlY2sgaWYgdGhlcmUgaXMgYW4gZXJyb3IgaW4gcXVlcnkgcGFyYW1zXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEudXJsLmluY2x1ZGVzKFwiP2Vycm9yPVwiKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICBcIkZhaWxlZCB0byBhdXRoZW50aWNhdGUgd2l0aCBUaGlyZFBhcnR5QXV0aDogXCIgK1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEudXJsLnNwbGl0KFwiP2Vycm9yPVwiKVsxXVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHJlc3BvbnNlLmRhdGEudXJsO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKGVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGlzTG9hZGluZyxcbiAgICBhdXRoZW50aWNhdGVkLFxuICAgIGF1dGhlbnRpY2F0ZSxcbiAgICBpc0F1dGhlbnRpY2F0ZWQsXG4gIH07XG59O1xuIiwiaW1wb3J0IHsgUGFydGljaXBhbnRUYXNrU3RhdHVzIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3BhcnRpY2lwYW50cy5lbnVtXCI7XG5pbXBvcnQgeyBUYXNrQnV0dG9uVHlwZSB9IGZyb20gXCJAL21vZGVscy9lbnVtcy90YXNrX2J1dHRvbl90eXBlLmVudW1cIjtcbmltcG9ydCB7IFRhc2tUeXBlIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3Rhc2tzLmVudW1cIjtcbmltcG9ydCB7XG4gIElEaXNjb3JkSm9pbk1ldGFkYXRhLFxuICBJT3BlblVybE1ldGFkYXRhLFxuICBJVGFzayxcbiAgSVRlbGVncmFtSm9pbk1ldGFkYXRhLFxuICBJVHdpdGNoRm9sbG93TWV0YWRhdGEsXG4gIElUd2l0dGVyRm9sbG93TWV0YWRhdGEsXG4gIElUd2l0dGVyTGlrZU1ldGFkYXRhLFxuICBJVHdpdHRlclJlcGx5TWV0YWRhdGEsXG4gIElUd2l0dGVyUmVwb3N0TWV0YWRhdGEsXG4gIElZb3V0dWJlU3Vic2NyaWJlTWV0YWRhdGEsXG4gIElZb3V0dWJlVmlld01ldGFkYXRhLFxufSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy90YXNrXCI7XG5pbXBvcnQgeyBUYXNrUHJvdmlkZXIsIHVzZVRhc2sgfSBmcm9tIFwiQC9wcm92aWRlcnMvdGFza1wiO1xuaW1wb3J0IHtcbiAgVGhpcmRQYXJ0eUF1dGhQcm92aWRlcixcbiAgdXNlVGhpcmRQYXJ0eUF1dGgsXG59IGZyb20gXCJAL3Byb3ZpZGVycy90aGlyZF9wYXJ0eV9hdXRoXCI7XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgVGhpcmRQYXJ0eVByb3ZpZGVyIH0gZnJvbSBcIi4uXCI7XG5cbmludGVyZmFjZSBUYXNrQ2FsbGJhY2tzIHtcbiAgb25Zb3V0dWJlVmlldzogKHRhc2s6IElUYXNrLCB2aWRlb0lkOiBzdHJpbmcpID0+IFByb21pc2U8bnVtYmVyPjtcbiAgb25GaWxlVXBsb2FkOiAodGFzazogSVRhc2spID0+IFByb21pc2U8c3RyaW5nPjtcbiAgb25TdWJtaXRTdHJpbmc6ICh0YXNrOiBJVGFzaykgPT4gUHJvbWlzZTxzdHJpbmc+O1xufVxuXG50eXBlIFByb3BzID0ge1xuICB0YXNrOiBJVGFzaztcbiAgcGFydGljaXBhdGlvbkRpc2FibGVkOiBib29sZWFuO1xuICBtYWludGVuYW5jZTogYm9vbGVhbjtcbiAgY2hpbGRyZW46IChwcm9wczoge1xuICAgIG9uQ2xpY2s/OiAoZTogUmVhY3QuTW91c2VFdmVudDxIVE1MQnV0dG9uRWxlbWVudCwgTW91c2VFdmVudD4pID0+IHZvaWQ7XG4gICAgdHlwZTogVGFza0J1dHRvblR5cGU7XG4gICAgaXNMb2FkaW5nPzogYm9vbGVhbjtcbiAgICBkaXNhYmxlZD86IGJvb2xlYW47XG4gICAgY29tbWVudDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgfSkgPT4gUmVhY3QuUmVhY3RFbGVtZW50O1xuICBjYWxsYmFja3M6IFRhc2tDYWxsYmFja3M7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbiAgb25TdWNjZXNzPzogKCkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IFRhc2tXcmFwcGVyQmFzZTogUmVhY3QuRkM8UHJvcHM+ID0gKHByb3BzOiBQcm9wcykgPT4ge1xuICBjb25zdCB7XG4gICAgdGFzayxcbiAgICBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQsXG4gICAgbWFpbnRlbmFuY2UsXG4gICAgY2hpbGRyZW4sXG4gICAgY2FsbGJhY2tzLFxuICAgIG9uU3VjY2VzcyxcbiAgfSA9IHByb3BzO1xuICBjb25zdCBbbGlua0NsaWNrZWQsIHNldExpbmtDbGlja2VkXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcblxuICBjb25zdCB7IHBhcnRpY2lwYXRlLCBpc1BhcnRpY2lwYXRpb25Mb2FkaW5nIH0gPSB1c2VUYXNrKCk7XG5cbiAgY29uc3QgdGhpcmRQYXJ0eUF1dGggPSB1c2VUaGlyZFBhcnR5QXV0aCgpO1xuXG4gIGNvbnN0IGNvbXBsZXRlZCA9XG4gICAgdGFzay5wYXJ0aWNpcGF0aW9uICYmXG4gICAgdGFzay5wYXJ0aWNpcGF0aW9uLnN0YXR1cyA9PT0gUGFydGljaXBhbnRUYXNrU3RhdHVzLmNvbXBsZXRlZDtcblxuICBjb25zdCBvbkxpbmtDbGljayA9IGFzeW5jICgpID0+IHtcbiAgICBzd2l0Y2ggKHRhc2sudHlwZSkge1xuICAgICAgY2FzZSBUYXNrVHlwZS5kaXNjb3JkX2pvaW46XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElEaXNjb3JkSm9pbk1ldGFkYXRhKS5pbnZpdGVfdXJsLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfZm9sbG93OlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICBgaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvZm9sbG93P3NjcmVlbl9uYW1lPSR7XG4gICAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJVHdpdHRlckZvbGxvd01ldGFkYXRhKS51c2VybmFtZVxuICAgICAgICAgIH1gLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfbGlrZTpcbiAgICAgICAgd2luZG93Lm9wZW4oKHRhc2subWV0YWRhdGEgYXMgSVR3aXR0ZXJMaWtlTWV0YWRhdGEpLnBvc3RfdXJsLCBcIl9ibGFua1wiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwbHk6XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElUd2l0dGVyUmVwbHlNZXRhZGF0YSkucG9zdF91cmwsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBvc3Q6XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgIGBodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9yZXR3ZWV0P3R3ZWV0X2lkPSR7XG4gICAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJVHdpdHRlclJlcG9zdE1ldGFkYXRhKS5wb3N0X2lkXG4gICAgICAgICAgfWAsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUudGVsZWdyYW1fam9pbjpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgYGh0dHBzOi8vdC5tZS8keyh0YXNrLm1ldGFkYXRhIGFzIElUZWxlZ3JhbUpvaW5NZXRhZGF0YSkudXNlcm5hbWV9YCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS5pbWFnZV91cGxvYWQ6XG4gICAgICAgIGNvbnN0IGZpbGUgPSBhd2FpdCBjYWxsYmFja3Mub25GaWxlVXBsb2FkKHRhc2spO1xuICAgICAgICBvblBhcnRpY2lwYXRlKHtcbiAgICAgICAgICBmaWxlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY2FzZSBUYXNrVHlwZS5zdWJtaXRfc3RyaW5nOlxuICAgICAgICBjb25zdCB2YWx1ZSA9IGF3YWl0IGNhbGxiYWNrcy5vblN1Ym1pdFN0cmluZyh0YXNrKTtcbiAgICAgICAgb25QYXJ0aWNpcGF0ZSh7XG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICBjYXNlIFRhc2tUeXBlLm9wZW5fdXJsOlxuICAgICAgICB3aW5kb3cub3BlbigodGFzay5tZXRhZGF0YSBhcyBJT3BlblVybE1ldGFkYXRhKS51cmwsIFwiX2JsYW5rXCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUueW91dHViZV92aWV3OlxuICAgICAgICBjb25zdCBzZWNvbmRzV2F0Y2hlZCA9IGF3YWl0IGNhbGxiYWNrcy5vbllvdXR1YmVWaWV3KFxuICAgICAgICAgIHRhc2ssXG4gICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVlvdXR1YmVWaWV3TWV0YWRhdGEpLnZpZGVvX2lkXG4gICAgICAgICk7XG4gICAgICAgIG9uUGFydGljaXBhdGUoe1xuICAgICAgICAgIHNlY29uZHM6IHNlY29uZHNXYXRjaGVkLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY2FzZSBUYXNrVHlwZS5kYWlseV9sb2dpbjpcbiAgICAgICAgb25QYXJ0aWNpcGF0ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXRjaF9mb2xsb3c6XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElUd2l0Y2hGb2xsb3dNZXRhZGF0YSkudHdpdGNoX3VybCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS55b3V0dWJlX3N1YnNjcmliZTpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVlvdXR1YmVTdWJzY3JpYmVNZXRhZGF0YSkuY2hhbm5lbF91cmwsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBzZXRMaW5rQ2xpY2tlZCh0cnVlKTtcbiAgfTtcblxuICBjb25zdCBpc0F1dGhlbnRpY2F0ZWQgPSAoKSA9PiB7XG4gICAgc3dpdGNoICh0YXNrLnR5cGUpIHtcbiAgICAgIGNhc2UgVGFza1R5cGUuZGlzY29yZF9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS5kaXNjb3JkX2pvaW46XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5pc0F1dGhlbnRpY2F0ZWQoVGhpcmRQYXJ0eVByb3ZpZGVyLmRpc2NvcmQpO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfZm9sbG93OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2xpa2U6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwbHk6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwb3N0OlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguaXNBdXRoZW50aWNhdGVkKFRoaXJkUGFydHlQcm92aWRlci50d2l0dGVyKTtcbiAgICAgIGNhc2UgVGFza1R5cGUudGVsZWdyYW1fY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUudGVsZWdyYW1fam9pbjpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmlzQXV0aGVudGljYXRlZChUaGlyZFBhcnR5UHJvdmlkZXIudGVsZWdyYW0pO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGF1dGhlbnRpY2F0ZSA9ICgpID0+IHtcbiAgICBzd2l0Y2ggKHRhc2sudHlwZSkge1xuICAgICAgY2FzZSBUYXNrVHlwZS5kaXNjb3JkX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLmRpc2NvcmRfam9pbjpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmF1dGhlbnRpY2F0ZShUaGlyZFBhcnR5UHJvdmlkZXIuZGlzY29yZCk7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9mb2xsb3c6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfbGlrZTpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBseTpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBvc3Q6XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5hdXRoZW50aWNhdGUoVGhpcmRQYXJ0eVByb3ZpZGVyLnR3aXR0ZXIpO1xuICAgICAgY2FzZSBUYXNrVHlwZS50ZWxlZ3JhbV9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS50ZWxlZ3JhbV9qb2luOlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguYXV0aGVudGljYXRlKFRoaXJkUGFydHlQcm92aWRlci50ZWxlZ3JhbSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IG9uUGFydGljaXBhdGUgPSBhc3luYyAoYm9keT86IGFueSkgPT4ge1xuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBwYXJ0aWNpcGF0ZSh0YXNrLCBib2R5LCBvblN1Y2Nlc3MpO1xuICAgIGlmICghcmVzcCkge1xuICAgICAgc2V0TGlua0NsaWNrZWQoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVDbGljayA9ICgpID0+IHtcbiAgICBpZiAocGFydGljaXBhdGlvbkRpc2FibGVkIHx8IG1haW50ZW5hbmNlIHx8IGNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAoIWlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICBhdXRoZW50aWNhdGUoKTtcbiAgICB9IGVsc2UgaWYgKGxpbmtDbGlja2VkKSB7XG4gICAgICBvblBhcnRpY2lwYXRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9uTGlua0NsaWNrKCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGdldFR5cGUgPSAoKSA9PiB7XG4gICAgaWYgKGNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLkNPTVBMRVRFRDtcbiAgICB9XG5cbiAgICBpZiAoIXRhc2sucGFydGljaXBhdGlvbikge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLk5PX1BBUlRJQ0lQQU5UO1xuICAgIH1cblxuICAgIGlmICh0YXNrLnBhcnRpY2lwYXRpb24/LnN0YXR1cyA9PT0gUGFydGljaXBhbnRUYXNrU3RhdHVzLnBlbmRpbmcpIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5QRU5ESU5HO1xuICAgIH1cblxuICAgIGlmICh0YXNrLnBhcnRpY2lwYXRpb24/LnN0YXR1cyA9PT0gUGFydGljaXBhbnRUYXNrU3RhdHVzLmZhaWxlZCkge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLkZBSUxFRDtcbiAgICB9XG5cbiAgICBpZiAobGlua0NsaWNrZWQpIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5DTEFJTTtcbiAgICB9XG5cbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5TVEFSVDtcbiAgICB9XG5cbiAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuQVVUSF9SRVFVSVJFRDtcbiAgfTtcblxuICBjb25zdCBub09uQ2xpY2sgPSAoKSA9PiB7XG4gICAgaWYgKGNvbXBsZXRlZCB8fCBtYWludGVuYW5jZSB8fCBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICB0YXNrLnR5cGUgPT09IFRhc2tUeXBlLm1hbnVhbCB8fFxuICAgICAgdGFzay50eXBlID09PSBUYXNrVHlwZS50d2l0dGVyX2FjdGl2aXR5XG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiBjaGlsZHJlbih7XG4gICAgb25DbGljazogIW5vT25DbGljaygpID8gaGFuZGxlQ2xpY2sgOiB1bmRlZmluZWQsXG4gICAgdHlwZTogZ2V0VHlwZSgpLFxuICAgIGlzTG9hZGluZzogdGhpcmRQYXJ0eUF1dGguaXNMb2FkaW5nIHx8IGlzUGFydGljaXBhdGlvbkxvYWRpbmcsXG4gICAgZGlzYWJsZWQ6IHBhcnRpY2lwYXRpb25EaXNhYmxlZCB8fCBtYWludGVuYW5jZSxcbiAgICBjb21tZW50OiB0YXNrLnBhcnRpY2lwYXRpb24/LmNvbW1lbnQsXG4gIH0pO1xufTtcblxuY29uc3QgVGFza1dyYXBwZXI6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wczogUHJvcHMpID0+IHtcbiAgY29uc3QgeyB0YXNrLCBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQsIG1haW50ZW5hbmNlLCBlcnJvckNhbGxiYWNrLCBvblN1Y2Nlc3MgfSA9XG4gICAgcHJvcHM7XG4gIHJldHVybiAoXG4gICAgPFRhc2tQcm92aWRlciBlcnJvckNhbGxiYWNrPXtlcnJvckNhbGxiYWNrfT5cbiAgICAgIDxUaGlyZFBhcnR5QXV0aFByb3ZpZGVyIGVycm9yQ2FsbGJhY2s9e2Vycm9yQ2FsbGJhY2t9PlxuICAgICAgICA8VGFza1dyYXBwZXJCYXNlXG4gICAgICAgICAgdGFzaz17dGFza31cbiAgICAgICAgICBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQ9e3BhcnRpY2lwYXRpb25EaXNhYmxlZH1cbiAgICAgICAgICBtYWludGVuYW5jZT17bWFpbnRlbmFuY2V9XG4gICAgICAgICAgY2FsbGJhY2tzPXtwcm9wcy5jYWxsYmFja3N9XG4gICAgICAgICAgb25TdWNjZXNzPXtvblN1Y2Nlc3N9XG4gICAgICAgID5cbiAgICAgICAgICB7cHJvcHMuY2hpbGRyZW59XG4gICAgICAgIDwvVGFza1dyYXBwZXJCYXNlPlxuICAgICAgPC9UaGlyZFBhcnR5QXV0aFByb3ZpZGVyPlxuICAgIDwvVGFza1Byb3ZpZGVyPlxuICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgVGFza1dyYXBwZXI7XG4iLCJleHBvcnQgZW51bSBNaXNzaW9uVHlwZSB7XG4gIGd1YXJhbnRlZWQgPSBcImd1YXJhbnRlZWRcIixcbiAgc2NvcmVib2FyZCA9IFwic2NvcmVib2FyZFwiLFxuICBsb3R0ZXJ5ID0gXCJsb3R0ZXJ5XCIsXG59XG5cbmV4cG9ydCBlbnVtIE1pc3Npb25SZXdhcmRUeXBlIHtcbiAgY3J5cHRvID0gXCJjcnlwdG9cIixcbiAgcG9pbnRzID0gXCJwb2ludHNcIixcbiAgcG9pbnRzX3Blcl90YXNrID0gXCJwb2ludHNfcGVyX3Rhc2tcIixcbn1cbiIsImV4cG9ydCBlbnVtIFF1ZXN0V2ViaG9va1R5cGUge1xuICBwYXJ0aWNpcGFudF9yZXdhcmRfYWRkZWQgPSAncGFydGljaXBhbnRfcmV3YXJkX2FkZGVkJyxcbiAgcGFydGljaXBhbnRfcmV3YXJkX3JlbW92ZWQgPSAncGFydGljaXBhbnRfcmV3YXJkX3JlbW92ZWQnLFxuICB0aGlyZF9wYXJ0eV9hdXRoZW50aWNhdGVkID0gJ3RoaXJkX3BhcnR5X2F1dGhlbnRpY2F0ZWQnLFxuICB0YXNrX2NvbXBsZXRlZCA9ICd0YXNrX2NvbXBsZXRlZCcsXG59XG4iLCJleHBvcnQgZW51bSBUYXNrVmFsaWRhdGlvbiB7XG4gIGVtYWlsID0gXCJlbWFpbFwiLFxuICBpc19lcXVhbCA9IFwiaXNfZXF1YWxcIixcbn1cbiIsImltcG9ydCB7IEdhbWVzb2NpYWxQcm92aWRlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9nYW1lc29jaWFsXCI7XG5pbXBvcnQgeyBNaXNzaW9uc1Byb3ZpZGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL21pc3Npb25zXCI7XG5pbXBvcnQgeyBQYXJ0aWNpcGFudFByb3ZpZGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL3BhcnRpY2lwYW50XCI7XG5cbmV4cG9ydCBjb25zdCBRdWVzdHNQcm92aWRlciA9ICh7XG4gIGNoaWxkcmVuLFxuICBhcGlLZXksXG4gIGFwaVVybCxcbiAgZXJyb3JDYWxsYmFjayxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgYXBpS2V5OiBzdHJpbmc7XG4gIGFwaVVybDogc3RyaW5nO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSA9PiB7XG4gIHJldHVybiAoXG4gICAgPEdhbWVzb2NpYWxQcm92aWRlciBhcGlLZXk9e2FwaUtleX0gYXBpVXJsPXthcGlVcmx9PlxuICAgICAgPFBhcnRpY2lwYW50UHJvdmlkZXIgZXJyb3JDYWxsYmFjaz17ZXJyb3JDYWxsYmFja30+XG4gICAgICAgIDxNaXNzaW9uc1Byb3ZpZGVyPntjaGlsZHJlbn08L01pc3Npb25zUHJvdmlkZXI+XG4gICAgICA8L1BhcnRpY2lwYW50UHJvdmlkZXI+XG4gICAgPC9HYW1lc29jaWFsUHJvdmlkZXI+XG4gICk7XG59O1xuIl19