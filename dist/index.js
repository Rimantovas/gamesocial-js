'use strict';

var react = require('react');
var jsxRuntime = require('react/jsx-runtime');
var Pt = require('axios');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var Pt__default = /*#__PURE__*/_interopDefault(Pt);

var ot=Object.defineProperty,nt=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var G=(e,t,r)=>t in e?ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))ct.call(t,r)&&G(e,r,t[r]);if(F)for(var r of F(t))dt.call(t,r)&&G(e,r,t[r]);return e},g=(e,t)=>nt(e,st(t));var A=(e,t,r)=>new Promise((a,i)=>{var n=c=>{try{u(r.next(c));}catch(o){i(o);}},_=c=>{try{u(r.throw(c));}catch(o){i(o);}},u=c=>c.done?a(c.value):Promise.resolve(c.value).then(n,_);u((r=r.apply(e,t)).next());});var C=(i=>(i.created="created",i.pending="pending",i.completed="completed",i.failed="failed",i))(C||{}),ut=(i=>(i.created="created",i.started="started",i.completed="completed",i.failed="failed",i))(ut||{});var O=(u=>(u.NO_PARTICIPANT="NO_PARTICIPANT",u.START="START",u.CLAIM="CLAIM",u.PENDING="PENDING",u.COMPLETED="COMPLETED",u.FAILED="FAILED",u.AUTH_REQUIRED="AUTH_REQUIRED",u))(O||{});var T=(p=>(p.telegram_join="telegram_join",p.telegram_connect="telegram_connect",p.youtube_view="youtube_view",p.image_upload="image_upload",p.twitter_repost="twitter_repost",p.twitter_follow="twitter_follow",p.twitter_reply="twitter_reply",p.twitter_like="twitter_like",p.twitter_activity="twitter_activity",p.twitter_connect="twitter_connect",p.discord_join="discord_join",p.discord_connect="discord_connect",p.submit_string="submit_string",p.manual="manual",p.daily_login="daily_login",p.open_url="open_url",p.youtube_subscribe="youtube_subscribe",p.twitch_follow="twitch_follow",p))(T||{});var N=react.createContext({apiUrl:"",apiKey:"",authToken:void 0,setAuthToken:()=>{}}),y=()=>react.useContext(N);function j({children:e,state:t,apiKey:r,apiUrl:a}){return t!=null||(t=_t(r,a)),jsxRuntime.jsx(N.Provider,{value:t,children:e})}var _t=(e,t)=>{let[r,a]=react.useState({apiUrl:t,apiKey:e,userAuthToken:void 0}),i=r.userAuthToken,n=react.useCallback(_=>{a(u=>g(w({},u),{userAuthToken:_}));},[]);return {apiUrl:t,apiKey:e,authToken:i,setAuthToken:n}};var k=()=>{let{authToken:e,apiUrl:t,apiKey:r}=y();return ()=>{let i=Pt__default.default.create({baseURL:t,timeout:1e4,headers:{"Api-Key":r,"Api-Version":"1.0"}});return i.interceptors.request.use(n=>{let _=e;return _&&(n.headers.Authorization=`Bearer ${_}`),n},n=>Promise.reject(n)),i.interceptors.response.use(n=>n,n=>(n.response&&n.response.status===401&&typeof window!="undefined"&&localStorage.removeItem("token"),Promise.reject(n))),i}};var x={discord_not_connected:"Discord account is not connected",discord_guild_user_not_found:"Discord user not found in channel ",discord_guild_required_role_not_exists:"Discord channel verification must be passed",discord_guild_user_is_pending:"Please validate that your accepted Terms of Discord channel",discord_unauthenticated:"Please re-authenticate your discord account",telegram_not_connected:"Telegram account is not connected",telegram_member_not_found:"Telegram account not found in group",telegram_unauthenticated:"Please re-authenticate your telegram account",twitter_not_connected:"X account is not connected",twitter_follower_not_found:"Your X account do not follow required account",twitter_unauthenticated:"Please re-authenticate your X account",youtube_invalid_video_watch_length:"Please watch whole video",file_not_provided:"File not provided",file_size_exceeds:"File size exceeds limit",invalid_file_type:"Invalid file type",mission_not_found:"Mission not found",mission_not_started:"Mission not started",mission_ended:"Mission ended",task_not_found:"Task not found",task_inactive:"Task inactive",participant_not_found:"Participant not found",third_party_unauthenticated:"Please re-authenticate your account",invalid_email:"Invalid email address",invalid_value:"Invalid value",invalid_captcha:"Invalid captcha"},K=e=>e===x.discord_unauthenticated||e===x.telegram_unauthenticated||e===x.twitter_unauthenticated;var $=react.createContext({missions:[],tasks:[],getTasksForMission:()=>[],updateTaskStatus:()=>{},maintenance:!1}),H=()=>react.useContext($);function Y({children:e,state:t}){return t!=null||(t=kt()),jsxRuntime.jsx($.Provider,{value:t,children:e})}var kt=()=>{let[e,t]=react.useState([]),[r,a]=react.useState([]),{authToken:i}=y(),n=k(),[_,u]=react.useState(!1);react.useEffect(()=>{c();},[i]),react.useEffect(()=>{e.length>0&&o(e.map(d=>d.id));},[e]),react.useEffect(()=>{i&&i.length===0&&u(!0);},[i]);let c=()=>{n().get("missions").then(function(d){t(d.data);}).catch(function(){u(!0);}).finally(function(){});},o=d=>{let m=d.map(f=>n().get(`missions/${f}/tasks`));Promise.all(m).then(function(f){let P=new Set(Object.values(T)),h=f.map(v=>v.data).flat().filter(v=>P.has(v.type));a(h);}).catch(function(){u(!0);});},s=(d,m)=>{a(r.map(f=>f.id===d?g(w({},f),{participation:{status:m}}):f));},l=react.useCallback(d=>r.filter(m=>m.mission_id===d),[r]);return {missions:e,tasks:r,getTasksForMission:l,updateTaskStatus:s,maintenance:_}};var q=(r=>(r.points="points",r.multiplier="multiplier",r))(q||{});var J=react.createContext({participant:void 0,isThirdPartyAuthenticated:()=>!1,addPoints:()=>{},getParticipant:()=>{}}),M=()=>react.useContext(J);function z({children:e,state:t,errorCallback:r}){return t!=null||(t=St(r)),jsxRuntime.jsx(J.Provider,{value:t,children:e})}var St=e=>{let[t,r]=react.useState(),{authToken:a}=y(),i=k();react.useEffect(()=>{a?n():r(void 0);},[a]);let n=()=>{i().get("participants/me").then(function(c){r(c.data);}).catch(function(c){console.error(c),e&&e(c);});};return {participant:t,isThirdPartyAuthenticated:c=>!!(t!=null&&t.authenticated.includes(c)),addPoints:c=>{c.points_reward&&r(o=>{var s;if(o)if(c.reward_type==="points"){let l=Math.floor(c.points_reward*((s=t==null?void 0:t.points_multiplier)!=null?s:1));r(d=>{if(d)return g(w({},d),{points:(d==null?void 0:d.points)+l})});}else r(l=>{if(l)return g(w({},l),{points_multiplier:(l==null?void 0:l.points_multiplier)+c.points_reward})});});},getParticipant:n}};var W=react.createContext({isParticipationLoading:!1,participate:()=>Promise.resolve(!1)}),X=()=>react.useContext(W);function Q({children:e,state:t,errorCallback:r}){return t!=null||(t=Lt(r)),jsxRuntime.jsx(W.Provider,{value:t,children:e})}var Lt=e=>{let[t,r]=react.useState(!1),{updateTaskStatus:a}=H(),{addPoints:i,getParticipant:n}=M(),_=k(),u=o=>{var l,d,m,f,P,h,v,p;let s="";(d=(l=o==null?void 0:o.response)==null?void 0:l.data)!=null&&d.message?typeof((f=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:f.message)=="string"&&(s=(h=(P=o==null?void 0:o.response)==null?void 0:P.data)==null?void 0:h.message.toString()):(v=o==null?void 0:o.response)!=null&&v.message&&(s=(p=o==null?void 0:o.response)==null?void 0:p.message.toString()),s?s in x?(K(s)&&n(),e&&e(x[s])):e&&e(s):e&&e("Server error, please try again later");};return {isParticipationLoading:t,participate:(o,s,l)=>A(void 0,null,function*(){r(!0);let d=w({},s);if(s!=null&&s.file){let m=yield fetch(s.file).then(f=>f.blob()).then(f=>{let P=new FileReader;return P.readAsDataURL(f),new Promise(h=>{P.onloadend=()=>{h(P.result);};})});d=g(w({},s),{file:{imageSrc:m}});}return yield _().post(`tasks/${o.id}`,s?d:void 0).then(function(m){return a(o.id,m.data.status),m.data.status==="completed"&&o.points_reward&&i(o),l&&l(),!0}).catch(function(m){u(m);}).finally(function(){r(!1);}),!1})}};var S=(a=>(a.twitter="twitter",a.telegram="telegram",a.discord="discord",a))(S||{});var V=()=>{let e=new URL(window.location.href);return e.search="",e.href};var B=Object.fromEntries(Object.values(S).map(e=>[e,!1])),tt=react.createContext({isLoading:!1,authenticated:B,authenticate:()=>({}),isAuthenticated:()=>!1}),et=()=>react.useContext(tt);function rt({children:e,state:t,errorCallback:r}){return t!=null||(t=Gt(r)),jsxRuntime.jsx(tt.Provider,{value:t,children:e})}var Gt=e=>{let[t,r]=react.useState(B),[a,i]=react.useState(!1),{participant:n}=M(),_=k();return react.useEffect(()=>{let o=Object.fromEntries(Object.values(S).map(s=>[s,!!(n!=null&&n.authenticated.includes(s))]));r(o);},[n]),{isLoading:a,authenticated:t,authenticate:o=>{i(!0),_().get(`auth/${o}`,{params:{redirect_url:V()}}).then(function(s){if(s.data.url){if(s.data.url.includes("?error="))throw new Error("Failed to authenticate with ThirdPartyAuth: "+s.data.url.split("?error=")[1]);window.location.href=s.data.url;}}).catch(function(s){console.error(s),e&&e(s);}).finally(()=>{i(!1);});},isAuthenticated:o=>t[o]||!1}};var jt=e=>{var U;let{task:t,participationDisabled:r,maintenance:a,children:i,callbacks:n,onSuccess:_}=e,[u,c]=react.useState(!1),{participate:o,isParticipationLoading:s}=X(),l=et(),d=t.participation&&t.participation.status==="completed",m=()=>A(void 0,null,function*(){switch(t.type){case"discord_join":window.open(t.metadata.invite_url,"_blank");break;case"twitter_follow":window.open(`https://twitter.com/intent/follow?screen_name=${t.metadata.username}`,"_blank");break;case"twitter_like":window.open(t.metadata.post_url,"_blank");break;case"twitter_reply":window.open(t.metadata.post_url,"_blank");break;case"twitter_repost":window.open(`https://twitter.com/intent/retweet?tweet_id=${t.metadata.post_id}`,"_blank");break;case"telegram_join":window.open(`https://t.me/${t.metadata.username}`,"_blank");break;case"image_upload":let b=yield n.onFileUpload(t);h({file:b});return;case"submit_string":let I=yield n.onSubmitString(t);h({value:I});return;case"open_url":window.open(t.metadata.url,"_blank");break;case"youtube_view":let at=yield n.onYoutubeView(t,t.metadata.video_id);h({seconds:at});return;case"daily_login":h();return;case"twitch_follow":window.open(t.metadata.twitch_url,"_blank");break;case"youtube_subscribe":window.open(t.metadata.channel_url,"_blank");break}c(!0);}),f=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.isAuthenticated("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.isAuthenticated("twitter");case"telegram_connect":case"telegram_join":return l.isAuthenticated("telegram");default:return !0}},P=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.authenticate("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.authenticate("twitter");case"telegram_connect":case"telegram_join":return l.authenticate("telegram")}},h=b=>A(void 0,null,function*(){(yield o(t,b,_))||c(!1);}),v=()=>{r||a||d||(f()?u?h():m():P());},p=()=>{var b,I;return d?"COMPLETED":t.participation?((b=t.participation)==null?void 0:b.status)==="pending"?"PENDING":((I=t.participation)==null?void 0:I.status)==="failed"?"FAILED":u?"CLAIM":f()?"START":"AUTH_REQUIRED":"NO_PARTICIPANT"};return i({onClick:!!(d||a||r||t.type==="manual"||t.type==="twitter_activity")?void 0:v,type:p(),isLoading:l.isLoading||s,disabled:r||a,comment:(U=t.participation)==null?void 0:U.comment})},Kt=e=>{let{task:t,participationDisabled:r,maintenance:a,errorCallback:i,onSuccess:n}=e;return jsxRuntime.jsx(Q,{errorCallback:i,children:jsxRuntime.jsx(rt,{errorCallback:i,children:jsxRuntime.jsx(jt,{task:t,participationDisabled:r,maintenance:a,callbacks:e.callbacks,onSuccess:n,children:e.children})})})},$t=Kt;var Ht=(a=>(a.guaranteed="guaranteed",a.scoreboard="scoreboard",a.lottery="lottery",a))(Ht||{}),Yt=(a=>(a.crypto="crypto",a.points="points",a.points_per_task="points_per_task",a))(Yt||{});var qt=(i=>(i.participant_reward_added="participant_reward_added",i.participant_reward_removed="participant_reward_removed",i.third_party_authenticated="third_party_authenticated",i.task_completed="task_completed",i))(qt||{});var Jt=(r=>(r.email="email",r.is_equal="is_equal",r))(Jt||{});var Ir=({children:e,apiKey:t,apiUrl:r,errorCallback:a})=>jsxRuntime.jsx(j,{apiKey:t,apiUrl:r,children:jsxRuntime.jsx(z,{errorCallback:a,children:jsxRuntime.jsx(Y,{children:e})})});

exports.GamesocialProvider = j;
exports.MissionRewardType = Yt;
exports.MissionType = Ht;
exports.MissionsProvider = Y;
exports.ParticipantMissionStatus = ut;
exports.ParticipantProvider = z;
exports.ParticipantTaskStatus = C;
exports.QuestWebhookType = qt;
exports.QuestsProvider = Ir;
exports.TaskButtonType = O;
exports.TaskProvider = Q;
exports.TaskRewardType = q;
exports.TaskType = T;
exports.TaskValidation = Jt;
exports.TaskWrapper = $t;
exports.ThirdPartyProvider = S;
exports.errorMessages = x;
exports.getCurrentHrefWithoutQueryParams = V;
exports.shouldRefetchParticipant = K;
exports.useGamesocial = y;
exports.useGamesocialState = _t;
exports.useMissions = H;
exports.useMissionsState = kt;
exports.useParticipant = M;
exports.useParticipantState = St;
exports.useTask = X;
exports.useTaskState = Lt;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb2RlbHMvZW51bXMvcGFydGljaXBhbnRzLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfYnV0dG9uX3R5cGUuZW51bS50cyIsIi4uL3NyYy9tb2RlbHMvZW51bXMvdGFza3MuZW51bS50cyIsIi4uL3NyYy9wcm92aWRlcnMvdGFzay50c3giLCIuLi9zcmMvcHJvdmlkZXJzL2dhbWVzb2NpYWwudHN4IiwiLi4vc3JjL2hvb2tzL3VzZUFwaS50cyIsIi4uL3NyYy91dGlscy9lcnJvcnMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL21pc3Npb25zLnRzeCIsIi4uL3NyYy9wcm92aWRlcnMvcGFydGljaXBhbnQudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy90YXNrX3Jld2FyZF90eXBlLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3RoaXJkX3BhcnR5LmVudW0udHMiLCIuLi9zcmMvdXRpbHMvdXRpbHMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL3RoaXJkX3BhcnR5X2F1dGgudHN4IiwiLi4vc3JjL2NvbXBvbmVudHMvVGFza1dyYXBwZXIudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy9taXNzaW9ucy5lbnVtLnRzIiwiLi4vc3JjL21vZGVscy9lbnVtcy9xdWVzdF93ZWJob29rX3R5cGUudHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfdmFsaWRhdGlvbi5lbnVtLnRzIiwiLi4vc3JjL3dyYXBwZXJzLnRzeCJdLCJuYW1lcyI6WyJQYXJ0aWNpcGFudFRhc2tTdGF0dXMiLCJQYXJ0aWNpcGFudE1pc3Npb25TdGF0dXMiLCJUYXNrQnV0dG9uVHlwZSIsIlRhc2tUeXBlIiwiY3JlYXRlQ29udGV4dCIsInVzZUNvbnRleHQiLCJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwianN4IiwiY29udGV4dCIsInVzZUdhbWVzb2NpYWwiLCJHYW1lc29jaWFsUHJvdmlkZXIiLCJjaGlsZHJlbiIsInN0YXRlIiwiYXBpS2V5IiwiYXBpVXJsIiwidXNlR2FtZXNvY2lhbFN0YXRlIiwiY29uZmlnIiwic2V0Q29uZmlnIiwiYXV0aFRva2VuIiwic2V0QXV0aFRva2VuIiwidG9rZW4iLCJwcmV2IiwiX19zcHJlYWRQcm9wcyIsIl9fc3ByZWFkVmFsdWVzIiwiYXhpb3MiLCJ1c2VBcGkiLCJhcGkiLCJlcnJvciIsInJlc3BvbnNlIiwiZXJyb3JNZXNzYWdlcyIsInNob3VsZFJlZmV0Y2hQYXJ0aWNpcGFudCIsInVzZUVmZmVjdCIsInVzZU1pc3Npb25zIiwiTWlzc2lvbnNQcm92aWRlciIsInVzZU1pc3Npb25zU3RhdGUiLCJtaXNzaW9ucyIsInNldE1pc3Npb25zIiwidGFza3MiLCJzZXRUYXNrcyIsIm1haW50ZW5hbmNlIiwic2V0TWFpbnRlbmFuY2UiLCJnZXRNaXNzaW9ucyIsImdldFRhc2tzIiwibSIsIm1pc3Npb25JZHMiLCJwcm9taXNlcyIsImlkIiwicmVzcG9uc2VzIiwidmFsaWRUeXBlcyIsInIiLCJ0IiwidXBkYXRlVGFza1N0YXR1cyIsInRhc2tJZCIsInN0YXR1cyIsInRhc2siLCJnZXRUYXNrc0Zvck1pc3Npb24iLCJtaXNzaW9uSWQiLCJUYXNrUmV3YXJkVHlwZSIsInVzZVBhcnRpY2lwYW50IiwiUGFydGljaXBhbnRQcm92aWRlciIsImVycm9yQ2FsbGJhY2siLCJ1c2VQYXJ0aWNpcGFudFN0YXRlIiwicGFydGljaXBhbnQiLCJzZXRQYXJ0aWNpcGFudCIsImdldFBhcnRpY2lwYW50IiwidGhpcmRQYXJ0eSIsIl9hIiwicG9pbnRzIiwidXNlVGFzayIsIlRhc2tQcm92aWRlciIsInVzZVRhc2tTdGF0ZSIsImlzUGFydGljaXBhdGlvbkxvYWRpbmciLCJzZXRJc1BhcnRpY2lwYXRpb25Mb2FkaW5nIiwiYWRkUG9pbnRzIiwiaGFuZGxlRXJyb3IiLCJlIiwiX2IiLCJfYyIsIl9kIiwiX2UiLCJfZiIsIl9nIiwiX2giLCJtZXNzYWdlIiwiYm9keSIsImNhbGxiYWNrIiwiX19hc3luYyIsImRhdGEiLCJiYXNlNjQiLCJibG9iIiwicmVhZGVyIiwicmVzIiwiVGhpcmRQYXJ0eVByb3ZpZGVyIiwiZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMiLCJ1cmwiLCJkZWZhdWx0UHJvdmlkZXJTdGF0dXMiLCJwcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoIiwiVGhpcmRQYXJ0eUF1dGhQcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoU3RhdGUiLCJhdXRoZW50aWNhdGVkIiwic2V0QXV0aGVudGljYXRlZCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsIm5ld1N0YXR1cyIsIlRhc2tXcmFwcGVyQmFzZSIsInByb3BzIiwicGFydGljaXBhdGlvbkRpc2FibGVkIiwiY2FsbGJhY2tzIiwib25TdWNjZXNzIiwibGlua0NsaWNrZWQiLCJzZXRMaW5rQ2xpY2tlZCIsInBhcnRpY2lwYXRlIiwidGhpcmRQYXJ0eUF1dGgiLCJjb21wbGV0ZWQiLCJvbkxpbmtDbGljayIsImZpbGUiLCJvblBhcnRpY2lwYXRlIiwidmFsdWUiLCJzZWNvbmRzV2F0Y2hlZCIsImlzQXV0aGVudGljYXRlZCIsImF1dGhlbnRpY2F0ZSIsImhhbmRsZUNsaWNrIiwiZ2V0VHlwZSIsIlRhc2tXcmFwcGVyIiwiVGFza1dyYXBwZXJfZGVmYXVsdCIsIk1pc3Npb25UeXBlIiwiTWlzc2lvblJld2FyZFR5cGUiLCJRdWVzdFdlYmhvb2tUeXBlIiwiVGFza1ZhbGlkYXRpb24iLCJRdWVzdHNQcm92aWRlciJdLCJtYXBwaW5ncyI6Im9vQkFBTyxJQUFLQSxPQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsT0FBQSxJQU9BQyxRQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsUUFBQSxJQ1BMLElBQUtDLE9BQ1ZBLEVBQUEsZUFBaUIsaUJBQ2pCQSxFQUFBLE1BQVEsUUFDUkEsRUFBQSxNQUFRLFFBQ1JBLEVBQUEs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QUNDLEtBQU1uRCxFQUNOLHNCQUF1QnFELEVBQ3ZCLFlBQWFwRSxFQUNiLFVBQVdtRSxFQUFNLFVBQ2pCLFVBQVdHLEVBRVYsU0FBQUgsRUFBTSxTQUNULEVBQ0YsRUFDRixDQUVKLEVBRU9tQixHQUFRRCxHQy9RUixJQUFLRSxRQUNWQSxFQUFBLFdBQWEsYUFDYkEsRUFBQSxXQUFhLGFBQ2JBLEVBQUEsUUFBVSxVQUhBQSxRQUFBLElBTUFDLFFBQ1ZBLEVBQUEsT0FBUyxTQUNUQSxFQUFBLE9BQVMsU0FDVEEsRUFBQSxnQkFBa0Isa0JBSFJBLFFBQUEsSUNOTCxJQUFLQyxRQUNWQSxFQUFBLHlCQUEyQiwyQkFDM0JBLEVBQUEsMkJBQTZCLDZCQUM3QkEsRUFBQSwwQkFBNEIsNEJBQzVCQSxFQUFBLGVBQWlCLGlCQUpQQSxRQUFBLElDQUwsSUFBS0MsUUFDVkEsRUFBQSxNQUFRLFFBQ1JBLEVBQUEsU0FBVyxXQUZEQSxRQUFBLElDa0JKLGNBQUExSCxNQUFBLG9CQWRELElBQU0ySCxHQUFpQixDQUFDLENBQzdCLFNBQUF2SCxFQUNBLE9BQUFFLEVBQ0EsT0FBQUMsRUFDQSxjQUFBOEMsQ0FDRixJQU9JckQsRUFBQ0csRUFBQSxDQUFtQixPQUFRRyxFQUFRLE9BQVFDLEVBQzFDLFNBQUFQLEVBQUNvRCxFQUFBLENBQW9CLGNBQWVDLEVBQ2xDLFNBQUFyRCxFQUFDMEIsRUFBQSxDQUFrQixTQUFBdEIsRUFBUyxFQUM5QixFQUNGIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGVudW0gUGFydGljaXBhbnRUYXNrU3RhdHVzIHtcbiAgY3JlYXRlZCA9ICdjcmVhdGVkJyxcbiAgcGVuZGluZyA9ICdwZW5kaW5nJyxcbiAgY29tcGxldGVkID0gJ2NvbXBsZXRlZCcsXG4gIGZhaWxlZCA9ICdmYWlsZWQnLFxufVxuXG5leHBvcnQgZW51bSBQYXJ0aWNpcGFudE1pc3Npb25TdGF0dXMge1xuICBjcmVhdGVkID0gJ2NyZWF0ZWQnLFxuICBzdGFydGVkID0gJ3N0YXJ0ZWQnLFxuICBjb21wbGV0ZWQgPSAnY29tcGxldGVkJyxcbiAgZmFpbGVkID0gJ2ZhaWxlZCcsXG59XG4iLCJleHBvcnQgZW51bSBUYXNrQnV0dG9uVHlwZSB7XG4gIE5PX1BBUlRJQ0lQQU5UID0gXCJOT19QQVJUSUNJUEFOVFwiLCAvLyBJZiBub3QgcGFydGljaXBhbnQgaXMgZm91bmQuIFVzdWFsbHkgdGhhdCBtZWFucyB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZC5cbiAgU1RBUlQgPSBcIlNUQVJUXCIsIC8vIElmIHRoZSB0YXNrIGlzIG5vdCBjb21wbGV0ZWQgYW5kIHRoZSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQuXG4gIENMQUlNID0gXCJDTEFJTVwiLCAvLyBJZiB0aGUgdGFzayBoYXMgYmVlbiBzdGFydGVkIGFuZCB0aGUgdXNlciBpcyBhdXRoZW50aWNhdGVkLlxuICBQRU5ESU5HID0gXCJQRU5ESU5HXCIsIC8vIElmIHRoZSB0YXNrIGlzIHBlbmRpbmdcbiAgQ09NUExFVEVEID0gXCJDT01QTEVURURcIiwgLy8gSWYgdGhlIHRhc2sgaXMgY29tcGxldGVkXG4gIEZBSUxFRCA9IFwiRkFJTEVEXCIsIC8vIElmIHRoZSB0YXNrIGhhcyBmYWlsZWRcbiAgQVVUSF9SRVFVSVJFRCA9IFwiQVVUSF9SRVFVSVJFRFwiLCAvLyBJZiB0YXNrIHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIGZpcnN0XG59XG4iLCJleHBvcnQgZW51bSBUYXNrVHlwZSB7XG4gIHRlbGVncmFtX2pvaW4gPSBcInRlbGVncmFtX2pvaW5cIixcbiAgdGVsZWdyYW1fY29ubmVjdCA9IFwidGVsZWdyYW1fY29ubmVjdFwiLFxuXG4gIHlvdXR1YmVfdmlldyA9IFwieW91dHViZV92aWV3XCIsXG4gIGltYWdlX3VwbG9hZCA9IFwiaW1hZ2VfdXBsb2FkXCIsXG5cbiAgdHdpdHRlcl9yZXBvc3QgPSBcInR3aXR0ZXJfcmVwb3N0XCIsXG4gIHR3aXR0ZXJfZm9sbG93ID0gXCJ0d2l0dGVyX2ZvbGxvd1wiLFxuICB0d2l0dGVyX3JlcGx5ID0gXCJ0d2l0dGVyX3JlcGx5XCIsXG4gIHR3aXR0ZXJfbGlrZSA9IFwidHdpdHRlcl9saWtlXCIsXG4gIHR3aXR0ZXJfYWN0aXZpdHkgPSBcInR3aXR0ZXJfYWN0aXZpdHlcIixcbiAgdHdpdHRlcl9jb25uZWN0ID0gXCJ0d2l0dGVyX2Nvbm5lY3RcIixcblxuICBkaXNjb3JkX2pvaW4gPSBcImRpc2NvcmRfam9pblwiLFxuICBkaXNjb3JkX2Nvbm5lY3QgPSBcImRpc2NvcmRfY29ubmVjdFwiLFxuXG4gIHN1Ym1pdF9zdHJpbmcgPSBcInN1Ym1pdF9zdHJpbmdcIixcbiAgbWFudWFsID0gXCJtYW51YWxcIixcblxuICBkYWlseV9sb2dpbiA9IFwiZGFpbHlfbG9naW5cIixcbiAgb3Blbl91cmwgPSBcIm9wZW5fdXJsXCIsXG4gIHlvdXR1YmVfc3Vic2NyaWJlID0gXCJ5b3V0dWJlX3N1YnNjcmliZVwiLFxuICB0d2l0Y2hfZm9sbG93ID0gXCJ0d2l0Y2hfZm9sbG93XCIsXG59XG4iLCJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbXBvcnQgeyB1c2VBcGkgfSBmcm9tIFwiQC9ob29rcy91c2VBcGlcIjtcbmltcG9ydCB7IFBhcnRpY2lwYW50VGFza1N0YXR1cyB9IGZyb20gXCJAL21vZGVscy9lbnVtcy9wYXJ0aWNpcGFudHMuZW51bVwiO1xuaW1wb3J0IHsgSVRhc2sgfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy90YXNrXCI7XG5pbXBvcnQgeyBlcnJvck1lc3NhZ2VzLCBzaG91bGRSZWZldGNoUGFydGljaXBhbnQgfSBmcm9tIFwiQC91dGlscy9lcnJvcnNcIjtcbmltcG9ydCB7IHVzZU1pc3Npb25zIH0gZnJvbSBcIi4vbWlzc2lvbnNcIjtcbmltcG9ydCB7IHVzZVBhcnRpY2lwYW50IH0gZnJvbSBcIi4vcGFydGljaXBhbnRcIjtcblxudHlwZSBUYXNrU3RhdGUgPSB7XG4gIGlzUGFydGljaXBhdGlvbkxvYWRpbmc6IGJvb2xlYW47XG4gIHBhcnRpY2lwYXRlOiAodGFzazogSVRhc2ssIGJvZHk/OiBhbnksIGNhbGxiYWNrPzogYW55KSA9PiBQcm9taXNlPGJvb2xlYW4+O1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8VGFza1N0YXRlPih7XG4gIGlzUGFydGljaXBhdGlvbkxvYWRpbmc6IGZhbHNlLFxuICBwYXJ0aWNpcGF0ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlVGFzayA9ICgpID0+IHVzZUNvbnRleHQoY29udGV4dCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBUYXNrUHJvdmlkZXIoe1xuICBjaGlsZHJlbixcbiAgc3RhdGUsXG4gIGVycm9yQ2FsbGJhY2ssXG59OiB7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIHN0YXRlPzogVGFza1N0YXRlO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICBzdGF0ZSA/Pz0gdXNlVGFza1N0YXRlKGVycm9yQ2FsbGJhY2spO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVRhc2tTdGF0ZSA9IChcbiAgZXJyb3JDYWxsYmFjaz86IChlcnJvcjogYW55KSA9PiB2b2lkXG4pOiBUYXNrU3RhdGUgPT4ge1xuICBjb25zdCBbaXNQYXJ0aWNpcGF0aW9uTG9hZGluZywgc2V0SXNQYXJ0aWNpcGF0aW9uTG9hZGluZ10gPVxuICAgIHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgeyB1cGRhdGVUYXNrU3RhdHVzIH0gPSB1c2VNaXNzaW9ucygpO1xuICBjb25zdCB7IGFkZFBvaW50cywgZ2V0UGFydGljaXBhbnQgfSA9IHVzZVBhcnRpY2lwYW50KCk7XG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIGNvbnN0IGhhbmRsZUVycm9yID0gKGU6IGFueSkgPT4ge1xuICAgIGxldCBtZXNzYWdlOiBzdHJpbmcgPSBcIlwiO1xuICAgIGlmIChlPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSkge1xuICAgICAgaWYgKHR5cGVvZiBlPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtZXNzYWdlID0gZT8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UudG9TdHJpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHRvZG9cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGU/LnJlc3BvbnNlPy5tZXNzYWdlKSB7XG4gICAgICBtZXNzYWdlID0gZT8ucmVzcG9uc2U/Lm1lc3NhZ2UudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIGVycm9yQ2FsbGJhY2sgJiYgZXJyb3JDYWxsYmFjayhcIlNlcnZlciBlcnJvciwgcGxlYXNlIHRyeSBhZ2FpbiBsYXRlclwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG1lc3NhZ2UgaW4gZXJyb3JNZXNzYWdlcykge1xuICAgICAgICBjb25zdCBzID0gc2hvdWxkUmVmZXRjaFBhcnRpY2lwYW50KG1lc3NhZ2UpO1xuICAgICAgICBpZiAocykge1xuICAgICAgICAgIC8vIFRPRE8gTWF5YmUgYXdhaXQgdGhpc1xuICAgICAgICAgIGdldFBhcnRpY2lwYW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKGVycm9yTWVzc2FnZXNbbWVzc2FnZV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBwYXJ0aWNpcGF0ZSA9IGFzeW5jIChcbiAgICB0YXNrOiBJVGFzayxcbiAgICBib2R5PzogYW55LFxuICAgIGNhbGxiYWNrPzogYW55XG4gICk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIHNldElzUGFydGljaXBhdGlvbkxvYWRpbmcodHJ1ZSk7XG4gICAgbGV0IGRhdGEgPSB7IC4uLmJvZHkgfTtcbiAgICBpZiAoYm9keT8uZmlsZSkge1xuICAgICAgY29uc3QgYmFzZTY0ID0gYXdhaXQgZmV0Y2goYm9keS5maWxlKVxuICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmJsb2IoKSlcbiAgICAgICAgLnRoZW4oKGJsb2IpID0+IHtcbiAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpO1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzKSA9PiB7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4ge1xuICAgICAgICAgICAgICByZXMocmVhZGVyLnJlc3VsdCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIGRhdGEgPSB7XG4gICAgICAgIC4uLmJvZHksXG4gICAgICAgIGZpbGU6IHtcbiAgICAgICAgICBpbWFnZVNyYzogYmFzZTY0LFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG4gICAgYXdhaXQgYXBpKClcbiAgICAgIC5wb3N0KGB0YXNrcy8ke3Rhc2suaWR9YCwgYm9keSA/IGRhdGEgOiB1bmRlZmluZWQpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgdXBkYXRlVGFza1N0YXR1cyh0YXNrLmlkLCByZXNwb25zZS5kYXRhLnN0YXR1cyk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICByZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gUGFydGljaXBhbnRUYXNrU3RhdHVzLmNvbXBsZXRlZCAmJlxuICAgICAgICAgIHRhc2sucG9pbnRzX3Jld2FyZFxuICAgICAgICApIHtcbiAgICAgICAgICBhZGRQb2ludHModGFzayk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNldElzUGFydGljaXBhdGlvbkxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpc1BhcnRpY2lwYXRpb25Mb2FkaW5nLFxuICAgIHBhcnRpY2lwYXRlLFxuICB9O1xufTtcbiIsImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNhbGxiYWNrLCB1c2VDb250ZXh0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbnRlcmZhY2UgSUNvbmZpZyB7XG4gIGFwaVVybDogc3RyaW5nO1xuICBhcGlLZXk6IHN0cmluZztcbiAgdXNlckF1dGhUb2tlbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xufVxuXG50eXBlIEdhbWVzb2NpYWxTdGF0ZSA9IHtcbiAgYXBpVXJsOiBzdHJpbmc7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhdXRoVG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgc2V0QXV0aFRva2VuOiAodG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IGNvbnRleHQgPSBjcmVhdGVDb250ZXh0PEdhbWVzb2NpYWxTdGF0ZT4oe1xuICBhcGlVcmw6IFwiXCIsXG4gIGFwaUtleTogXCJcIixcbiAgYXV0aFRva2VuOiB1bmRlZmluZWQsXG4gIHNldEF1dGhUb2tlbjogKCkgPT4ge30sXG59KTtcblxuZXhwb3J0IGNvbnN0IHVzZUdhbWVzb2NpYWwgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gR2FtZXNvY2lhbFByb3ZpZGVyKHtcbiAgY2hpbGRyZW4sXG4gIHN0YXRlLFxuICBhcGlLZXksXG4gIGFwaVVybCxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBHYW1lc29jaWFsU3RhdGU7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhcGlVcmw6IHN0cmluZztcbn0pIHtcbiAgc3RhdGUgPz89IHVzZUdhbWVzb2NpYWxTdGF0ZShhcGlLZXksIGFwaVVybCk7XG4gIHJldHVybiA8Y29udGV4dC5Qcm92aWRlciB2YWx1ZT17c3RhdGV9PntjaGlsZHJlbn08L2NvbnRleHQuUHJvdmlkZXI+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlR2FtZXNvY2lhbFN0YXRlID0gKFxuICBhcGlLZXk6IHN0cmluZyxcbiAgYXBpVXJsOiBzdHJpbmdcbik6IEdhbWVzb2NpYWxTdGF0ZSA9PiB7XG4gIGNvbnN0IFtjb25maWcsIHNldENvbmZpZ10gPSB1c2VTdGF0ZTxJQ29uZmlnPih7XG4gICAgYXBpVXJsOiBhcGlVcmwsXG4gICAgYXBpS2V5OiBhcGlLZXksXG4gICAgdXNlckF1dGhUb2tlbjogdW5kZWZpbmVkLFxuICB9KTtcblxuICBjb25zdCBhdXRoVG9rZW4gPSBjb25maWcudXNlckF1dGhUb2tlbjtcblxuICBjb25zdCBzZXRBdXRoVG9rZW4gPSB1c2VDYWxsYmFjaygodG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIHNldENvbmZpZygocHJldikgPT4gKHtcbiAgICAgIC4uLnByZXYsXG4gICAgICB1c2VyQXV0aFRva2VuOiB0b2tlbixcbiAgICB9KSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4ge1xuICAgIGFwaVVybCxcbiAgICBhcGlLZXksXG4gICAgYXV0aFRva2VuLFxuICAgIHNldEF1dGhUb2tlbixcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyB1c2VHYW1lc29jaWFsIH0gZnJvbSBcIkAvcHJvdmlkZXJzL2dhbWVzb2NpYWxcIjtcbmltcG9ydCBheGlvcywgeyBBeGlvc0luc3RhbmNlIH0gZnJvbSBcImF4aW9zXCI7XG5cbmV4cG9ydCBjb25zdCB1c2VBcGkgPSAoKSA9PiB7XG4gIGNvbnN0IHsgYXV0aFRva2VuLCBhcGlVcmwsIGFwaUtleSB9ID0gdXNlR2FtZXNvY2lhbCgpO1xuXG4gIGNvbnN0IGFwaSA9ICgpOiBBeGlvc0luc3RhbmNlID0+IHtcbiAgICBjb25zdCBhcGkgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgYmFzZVVSTDogYXBpVXJsLFxuICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQXBpLUtleVwiOiBhcGlLZXksXG4gICAgICAgIFwiQXBpLVZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBhcGkuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKFxuICAgICAgKGNvbmZpZykgPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhUb2tlbjtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICB9LFxuICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICB9XG4gICAgKTtcblxuICAgIGFwaS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKFxuICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgIH0sXG4gICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgLy8gRW5zdXJlIHRoaXMgcnVucyBvbmx5IGluIHRoZSBicm93c2VyXG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidG9rZW5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gYXBpO1xuICB9O1xuXG4gIHJldHVybiBhcGk7XG59O1xuIiwiZXhwb3J0IHR5cGUgRXJyb3JNZXNzYWdlcyA9IHtcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGVycm9yTWVzc2FnZXM6IEVycm9yTWVzc2FnZXMgPSB7XG4gIGRpc2NvcmRfbm90X2Nvbm5lY3RlZDogXCJEaXNjb3JkIGFjY291bnQgaXMgbm90IGNvbm5lY3RlZFwiLFxuICBkaXNjb3JkX2d1aWxkX3VzZXJfbm90X2ZvdW5kOiBcIkRpc2NvcmQgdXNlciBub3QgZm91bmQgaW4gY2hhbm5lbCBcIixcbiAgZGlzY29yZF9ndWlsZF9yZXF1aXJlZF9yb2xlX25vdF9leGlzdHM6XG4gICAgXCJEaXNjb3JkIGNoYW5uZWwgdmVyaWZpY2F0aW9uIG11c3QgYmUgcGFzc2VkXCIsXG4gIGRpc2NvcmRfZ3VpbGRfdXNlcl9pc19wZW5kaW5nOlxuICAgIFwiUGxlYXNlIHZhbGlkYXRlIHRoYXQgeW91ciBhY2NlcHRlZCBUZXJtcyBvZiBEaXNjb3JkIGNoYW5uZWxcIixcbiAgZGlzY29yZF91bmF1dGhlbnRpY2F0ZWQ6IFwiUGxlYXNlIHJlLWF1dGhlbnRpY2F0ZSB5b3VyIGRpc2NvcmQgYWNjb3VudFwiLFxuXG4gIHRlbGVncmFtX25vdF9jb25uZWN0ZWQ6IFwiVGVsZWdyYW0gYWNjb3VudCBpcyBub3QgY29ubmVjdGVkXCIsXG4gIHRlbGVncmFtX21lbWJlcl9ub3RfZm91bmQ6IFwiVGVsZWdyYW0gYWNjb3VudCBub3QgZm91bmQgaW4gZ3JvdXBcIixcbiAgdGVsZWdyYW1fdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSByZS1hdXRoZW50aWNhdGUgeW91ciB0ZWxlZ3JhbSBhY2NvdW50XCIsXG5cbiAgdHdpdHRlcl9ub3RfY29ubmVjdGVkOiBcIlggYWNjb3VudCBpcyBub3QgY29ubmVjdGVkXCIsXG4gIHR3aXR0ZXJfZm9sbG93ZXJfbm90X2ZvdW5kOiBcIllvdXIgWCBhY2NvdW50IGRvIG5vdCBmb2xsb3cgcmVxdWlyZWQgYWNjb3VudFwiLFxuICB0d2l0dGVyX3VuYXV0aGVudGljYXRlZDogXCJQbGVhc2UgcmUtYXV0aGVudGljYXRlIHlvdXIgWCBhY2NvdW50XCIsXG5cbiAgeW91dHViZV9pbnZhbGlkX3ZpZGVvX3dhdGNoX2xlbmd0aDogXCJQbGVhc2Ugd2F0Y2ggd2hvbGUgdmlkZW9cIixcblxuICBmaWxlX25vdF9wcm92aWRlZDogXCJGaWxlIG5vdCBwcm92aWRlZFwiLFxuICBmaWxlX3NpemVfZXhjZWVkczogXCJGaWxlIHNpemUgZXhjZWVkcyBsaW1pdFwiLFxuICBpbnZhbGlkX2ZpbGVfdHlwZTogXCJJbnZhbGlkIGZpbGUgdHlwZVwiLFxuXG4gIG1pc3Npb25fbm90X2ZvdW5kOiBcIk1pc3Npb24gbm90IGZvdW5kXCIsXG4gIG1pc3Npb25fbm90X3N0YXJ0ZWQ6IFwiTWlzc2lvbiBub3Qgc3RhcnRlZFwiLFxuICBtaXNzaW9uX2VuZGVkOiBcIk1pc3Npb24gZW5kZWRcIixcblxuICB0YXNrX25vdF9mb3VuZDogXCJUYXNrIG5vdCBmb3VuZFwiLFxuICB0YXNrX2luYWN0aXZlOiBcIlRhc2sgaW5hY3RpdmVcIixcblxuICBwYXJ0aWNpcGFudF9ub3RfZm91bmQ6IFwiUGFydGljaXBhbnQgbm90IGZvdW5kXCIsXG5cbiAgdGhpcmRfcGFydHlfdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSByZS1hdXRoZW50aWNhdGUgeW91ciBhY2NvdW50XCIsXG5cbiAgaW52YWxpZF9lbWFpbDogXCJJbnZhbGlkIGVtYWlsIGFkZHJlc3NcIixcbiAgaW52YWxpZF92YWx1ZTogXCJJbnZhbGlkIHZhbHVlXCIsXG4gIGludmFsaWRfY2FwdGNoYTogXCJJbnZhbGlkIGNhcHRjaGFcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzaG91bGRSZWZldGNoUGFydGljaXBhbnQgPSAoZXJyb3I6IHN0cmluZykgPT4ge1xuICByZXR1cm4gKFxuICAgIGVycm9yID09PSBlcnJvck1lc3NhZ2VzLmRpc2NvcmRfdW5hdXRoZW50aWNhdGVkIHx8XG4gICAgZXJyb3IgPT09IGVycm9yTWVzc2FnZXMudGVsZWdyYW1fdW5hdXRoZW50aWNhdGVkIHx8XG4gICAgZXJyb3IgPT09IGVycm9yTWVzc2FnZXMudHdpdHRlcl91bmF1dGhlbnRpY2F0ZWRcbiAgKTtcbn07XG4iLCJpbXBvcnQgeyB1c2VBcGkgfSBmcm9tIFwiQC9ob29rcy91c2VBcGlcIjtcbmltcG9ydCB7IFBhcnRpY2lwYW50VGFza1N0YXR1cyB9IGZyb20gXCJAL21vZGVscy9lbnVtcy9wYXJ0aWNpcGFudHMuZW51bVwiO1xuaW1wb3J0IHsgSU1pc3Npb24gfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy9taXNzaW9uXCI7XG5pbXBvcnQgeyBJVGFzayB9IGZyb20gXCJAL21vZGVscy9pbnRlcmZhY2VzL3Rhc2tcIjtcbmltcG9ydCB7XG4gIGNyZWF0ZUNvbnRleHQsXG4gIHVzZUNhbGxiYWNrLFxuICB1c2VDb250ZXh0LFxuICB1c2VFZmZlY3QsXG4gIHVzZVN0YXRlLFxufSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IFRhc2tUeXBlIH0gZnJvbSBcIi4uXCI7XG5pbXBvcnQgeyB1c2VHYW1lc29jaWFsIH0gZnJvbSBcIi4vZ2FtZXNvY2lhbFwiO1xuXG50eXBlIE1pc3Npb25zU3RhdGUgPSB7XG4gIG1pc3Npb25zOiBJTWlzc2lvbltdO1xuICB0YXNrczogSVRhc2tbXTtcbiAgZ2V0VGFza3NGb3JNaXNzaW9uOiAobWlzc2lvbklkOiBzdHJpbmcpID0+IElUYXNrW107XG4gIHVwZGF0ZVRhc2tTdGF0dXM6ICh0YXNrSWQ6IHN0cmluZywgc3RhdHVzOiBQYXJ0aWNpcGFudFRhc2tTdGF0dXMpID0+IHZvaWQ7XG4gIG1haW50ZW5hbmNlOiBib29sZWFuO1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8TWlzc2lvbnNTdGF0ZT4oe1xuICBtaXNzaW9uczogW10sXG4gIHRhc2tzOiBbXSxcbiAgZ2V0VGFza3NGb3JNaXNzaW9uOiAoKSA9PiBbXSxcbiAgdXBkYXRlVGFza1N0YXR1czogKCkgPT4ge30sXG4gIG1haW50ZW5hbmNlOiBmYWxzZSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlTWlzc2lvbnMgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gTWlzc2lvbnNQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBNaXNzaW9uc1N0YXRlO1xufSkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvcnVsZXMtb2YtaG9va3NcbiAgc3RhdGUgPz89IHVzZU1pc3Npb25zU3RhdGUoKTtcbiAgcmV0dXJuIDxjb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzdGF0ZX0+e2NoaWxkcmVufTwvY29udGV4dC5Qcm92aWRlcj47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VNaXNzaW9uc1N0YXRlID0gKCk6IE1pc3Npb25zU3RhdGUgPT4ge1xuICBjb25zdCBbbWlzc2lvbnMsIHNldE1pc3Npb25zXSA9IHVzZVN0YXRlPElNaXNzaW9uW10+KFtdKTtcbiAgY29uc3QgW3Rhc2tzLCBzZXRUYXNrc10gPSB1c2VTdGF0ZTxJVGFza1tdPihbXSk7XG4gIGNvbnN0IHsgYXV0aFRva2VuIH0gPSB1c2VHYW1lc29jaWFsKCk7XG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIGNvbnN0IFttYWludGVuYW5jZSwgc2V0TWFpbnRlbmFuY2VdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZ2V0TWlzc2lvbnMoKTtcbiAgfSwgW2F1dGhUb2tlbl0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG1pc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGdldFRhc2tzKG1pc3Npb25zLm1hcCgobSkgPT4gbS5pZCkpO1xuICAgIH1cbiAgfSwgW21pc3Npb25zXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoYXV0aFRva2VuICYmIGF1dGhUb2tlbi5sZW5ndGggPT09IDApIHtcbiAgICAgIHNldE1haW50ZW5hbmNlKHRydWUpO1xuICAgIH1cbiAgfSwgW2F1dGhUb2tlbl0pO1xuXG4gIGNvbnN0IGdldE1pc3Npb25zID0gKCkgPT4ge1xuICAgIGFwaSgpXG4gICAgICAuZ2V0KFwibWlzc2lvbnNcIilcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBzZXRNaXNzaW9ucyhyZXNwb25zZS5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXRNYWludGVuYW5jZSh0cnVlKTtcbiAgICAgIH0pXG5cbiAgICAgIC5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gYWx3YXlzIGV4ZWN1dGVkXG4gICAgICB9KTtcbiAgfTtcblxuICBjb25zdCBnZXRUYXNrcyA9IChtaXNzaW9uSWRzOiBzdHJpbmdbXSkgPT4ge1xuICAgIGNvbnN0IHByb21pc2VzID0gbWlzc2lvbklkcy5tYXAoKGlkKSA9PiBhcGkoKS5nZXQoYG1pc3Npb25zLyR7aWR9L3Rhc2tzYCkpO1xuICAgIFByb21pc2UuYWxsKHByb21pc2VzKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlcykge1xuICAgICAgICBjb25zdCB2YWxpZFR5cGVzID0gbmV3IFNldChPYmplY3QudmFsdWVzKFRhc2tUeXBlKSk7XG4gICAgICAgIGNvbnN0IHRhc2tzID0gcmVzcG9uc2VzXG4gICAgICAgICAgLm1hcCgocikgPT4gci5kYXRhKVxuICAgICAgICAgIC5mbGF0KClcbiAgICAgICAgICAuZmlsdGVyKCh0KSA9PiB2YWxpZFR5cGVzLmhhcyh0LnR5cGUpKTtcbiAgICAgICAgc2V0VGFza3ModGFza3MpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNldE1haW50ZW5hbmNlKHRydWUpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgY29uc3QgdXBkYXRlVGFza1N0YXR1cyA9ICh0YXNrSWQ6IHN0cmluZywgc3RhdHVzOiBQYXJ0aWNpcGFudFRhc2tTdGF0dXMpID0+IHtcbiAgICBzZXRUYXNrcyhcbiAgICAgIHRhc2tzLm1hcCgodGFzaykgPT5cbiAgICAgICAgdGFzay5pZCA9PT0gdGFza0lkID8geyAuLi50YXNrLCBwYXJ0aWNpcGF0aW9uOiB7IHN0YXR1cyB9IH0gOiB0YXNrXG4gICAgICApXG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBnZXRUYXNrc0Zvck1pc3Npb24gPSB1c2VDYWxsYmFjayhcbiAgICAobWlzc2lvbklkOiBzdHJpbmcpID0+IHtcbiAgICAgIHJldHVybiB0YXNrcy5maWx0ZXIoKHQpID0+IHQubWlzc2lvbl9pZCA9PT0gbWlzc2lvbklkKTtcbiAgICB9LFxuICAgIFt0YXNrc11cbiAgKTtcblxuICByZXR1cm4ge1xuICAgIG1pc3Npb25zLFxuICAgIHRhc2tzLFxuICAgIGdldFRhc2tzRm9yTWlzc2lvbixcbiAgICB1cGRhdGVUYXNrU3RhdHVzLFxuICAgIG1haW50ZW5hbmNlLFxuICB9O1xufTtcbiIsImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlQXBpIH0gZnJvbSBcIkAvaG9va3MvdXNlQXBpXCI7XG5pbXBvcnQgeyBUYXNrUmV3YXJkVHlwZSB9IGZyb20gXCJAL21vZGVscy9lbnVtcy90YXNrX3Jld2FyZF90eXBlLmVudW1cIjtcbmltcG9ydCB7IElUYXNrIH0gZnJvbSBcIkAvbW9kZWxzL2ludGVyZmFjZXMvdGFza1wiO1xuaW1wb3J0IHsgVGhpcmRQYXJ0eVByb3ZpZGVyIH0gZnJvbSBcIi4uL21vZGVscy9lbnVtcy90aGlyZF9wYXJ0eS5lbnVtXCI7XG5pbXBvcnQgeyBJUGFydGljaXBhbnQgfSBmcm9tIFwiLi4vbW9kZWxzL2ludGVyZmFjZXMvcGFydGljaXBhbnRcIjtcbmltcG9ydCB7IHVzZUdhbWVzb2NpYWwgfSBmcm9tIFwiLi9nYW1lc29jaWFsXCI7XG5cbnR5cGUgUGFydGljaXBhbnRTdGF0ZSA9IHtcbiAgcGFydGljaXBhbnQ/OiBJUGFydGljaXBhbnQ7XG4gIGlzVGhpcmRQYXJ0eUF1dGhlbnRpY2F0ZWQ6ICh0aGlyZFBhcnR5OiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IGJvb2xlYW47XG4gIGFkZFBvaW50czogKHRhc2s6IElUYXNrKSA9PiB2b2lkO1xuICBnZXRQYXJ0aWNpcGFudDogKCkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IGNvbnRleHQgPSBjcmVhdGVDb250ZXh0PFBhcnRpY2lwYW50U3RhdGU+KHtcbiAgcGFydGljaXBhbnQ6IHVuZGVmaW5lZCxcbiAgaXNUaGlyZFBhcnR5QXV0aGVudGljYXRlZDogKCkgPT4gZmFsc2UsXG4gIGFkZFBvaW50czogKCkgPT4ge30sXG4gIGdldFBhcnRpY2lwYW50OiAoKSA9PiB7fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlUGFydGljaXBhbnQgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gUGFydGljaXBhbnRQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbiAgZXJyb3JDYWxsYmFjayxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBQYXJ0aWNpcGFudFN0YXRlO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG59KSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICBzdGF0ZSA/Pz0gdXNlUGFydGljaXBhbnRTdGF0ZShlcnJvckNhbGxiYWNrKTtcbiAgcmV0dXJuIDxjb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzdGF0ZX0+e2NoaWxkcmVufTwvY29udGV4dC5Qcm92aWRlcj47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VQYXJ0aWNpcGFudFN0YXRlID0gKFxuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWRcbik6IFBhcnRpY2lwYW50U3RhdGUgPT4ge1xuICBjb25zdCBbcGFydGljaXBhbnQsIHNldFBhcnRpY2lwYW50XSA9IHVzZVN0YXRlPElQYXJ0aWNpcGFudD4oKTtcbiAgY29uc3QgeyBhdXRoVG9rZW4gfSA9IHVzZUdhbWVzb2NpYWwoKTtcblxuICBjb25zdCBhcGkgPSB1c2VBcGkoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChhdXRoVG9rZW4pIHtcbiAgICAgIGdldFBhcnRpY2lwYW50KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFBhcnRpY2lwYW50KHVuZGVmaW5lZCk7XG4gICAgfVxuICB9LCBbYXV0aFRva2VuXSk7XG5cbiAgY29uc3QgZ2V0UGFydGljaXBhbnQgPSAoKSA9PiB7XG4gICAgYXBpKClcbiAgICAgIC5nZXQoYHBhcnRpY2lwYW50cy9tZWApXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgc2V0UGFydGljaXBhbnQocmVzcG9uc2UuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBlcnJvckNhbGxiYWNrICYmIGVycm9yQ2FsbGJhY2soZXJyb3IpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgY29uc3QgaXNUaGlyZFBhcnR5QXV0aGVudGljYXRlZCA9IChcbiAgICB0aGlyZFBhcnR5OiBUaGlyZFBhcnR5UHJvdmlkZXJcbiAgKTogYm9vbGVhbiA9PiB7XG4gICAgcmV0dXJuICEhcGFydGljaXBhbnQ/LmF1dGhlbnRpY2F0ZWQuaW5jbHVkZXModGhpcmRQYXJ0eSk7XG4gIH07XG5cbiAgY29uc3QgYWRkUG9pbnRzID0gKHRhc2s6IElUYXNrKSA9PiB7XG4gICAgaWYgKCF0YXNrLnBvaW50c19yZXdhcmQpIHJldHVybjtcblxuICAgIHNldFBhcnRpY2lwYW50KChwcmV2KSA9PiB7XG4gICAgICBpZiAoIXByZXYpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBpZiAodGFzay5yZXdhcmRfdHlwZSA9PT0gVGFza1Jld2FyZFR5cGUucG9pbnRzKSB7XG4gICAgICAgIGNvbnN0IHBvaW50cyA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgdGFzay5wb2ludHNfcmV3YXJkISAqIChwYXJ0aWNpcGFudD8ucG9pbnRzX211bHRpcGxpZXIgPz8gMSlcbiAgICAgICAgKTtcbiAgICAgICAgc2V0UGFydGljaXBhbnQoKHByZXYpID0+IHtcbiAgICAgICAgICBpZiAoIXByZXYpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAgICBwb2ludHM6IHByZXY/LnBvaW50cyArIHBvaW50cyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFBhcnRpY2lwYW50KChwcmV2KSA9PiB7XG4gICAgICAgICAgaWYgKCFwcmV2KSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgICAgcG9pbnRzX211bHRpcGxpZXI6IHByZXY/LnBvaW50c19tdWx0aXBsaWVyICsgdGFzay5wb2ludHNfcmV3YXJkISxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHBhcnRpY2lwYW50LFxuICAgIGlzVGhpcmRQYXJ0eUF1dGhlbnRpY2F0ZWQsXG4gICAgYWRkUG9pbnRzLFxuICAgIGdldFBhcnRpY2lwYW50LFxuICB9O1xufTtcbiIsImV4cG9ydCBlbnVtIFRhc2tSZXdhcmRUeXBlIHtcbiAgcG9pbnRzID0gXCJwb2ludHNcIixcbiAgbXVsdGlwbGllciA9IFwibXVsdGlwbGllclwiLFxufVxuIiwiZXhwb3J0IGVudW0gVGhpcmRQYXJ0eVByb3ZpZGVyIHtcbiAgdHdpdHRlciA9IFwidHdpdHRlclwiLFxuICB0ZWxlZ3JhbSA9IFwidGVsZWdyYW1cIixcbiAgZGlzY29yZCA9IFwiZGlzY29yZFwiLFxufVxuIiwiZXhwb3J0IGNvbnN0IGdldEN1cnJlbnRIcmVmV2l0aG91dFF1ZXJ5UGFyYW1zID0gKCkgPT4ge1xuICAvLyBDcmVhdGUgYSBuZXcgVVJMIG9iamVjdCBiYXNlZCBvbiB3aW5kb3cubG9jYXRpb25cbiAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgLy8gU2V0IHRoZSBzZWFyY2ggKHF1ZXJ5IHBhcmFtZXRlcnMpIHRvIGFuIGVtcHR5IHN0cmluZyB0byByZW1vdmUgaXRcbiAgdXJsLnNlYXJjaCA9IFwiXCI7XG5cbiAgLy8gUmV0dXJuIHRoZSBocmVmIHdpdGhvdXQgcXVlcnkgcGFyYW1ldGVyc1xuICByZXR1cm4gdXJsLmhyZWY7XG59O1xuIiwiaW1wb3J0IHsgdXNlQXBpIH0gZnJvbSBcIkAvaG9va3MvdXNlQXBpXCI7XG5pbXBvcnQgeyBUaGlyZFBhcnR5UHJvdmlkZXIgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvdGhpcmRfcGFydHkuZW51bVwiO1xuaW1wb3J0IHsgZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMgfSBmcm9tIFwiQC91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlUGFydGljaXBhbnQgfSBmcm9tIFwiLi9wYXJ0aWNpcGFudFwiO1xuXG50eXBlIFByb3ZpZGVyU3RhdHVzID0ge1xuICBba2V5IGluIFRoaXJkUGFydHlQcm92aWRlcl06IGJvb2xlYW47XG59O1xuXG5jb25zdCBkZWZhdWx0UHJvdmlkZXJTdGF0dXM6IFByb3ZpZGVyU3RhdHVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICBPYmplY3QudmFsdWVzKFRoaXJkUGFydHlQcm92aWRlcikubWFwKChwcm92aWRlcikgPT4gW3Byb3ZpZGVyLCBmYWxzZV0pXG4pIGFzIFByb3ZpZGVyU3RhdHVzO1xuXG50eXBlIFRoaXJkUGFydHlBdXRoU3RhdGUgPSB7XG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbiAgYXV0aGVudGljYXRlZDogUHJvdmlkZXJTdGF0dXM7XG4gIGF1dGhlbnRpY2F0ZTogKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IHZvaWQ7XG4gIGlzQXV0aGVudGljYXRlZDogKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IGJvb2xlYW47XG59O1xuXG5jb25zdCBjb250ZXh0ID0gY3JlYXRlQ29udGV4dDxUaGlyZFBhcnR5QXV0aFN0YXRlPih7XG4gIGlzTG9hZGluZzogZmFsc2UsXG4gIGF1dGhlbnRpY2F0ZWQ6IGRlZmF1bHRQcm92aWRlclN0YXR1cyxcbiAgYXV0aGVudGljYXRlOiAoKSA9PiAoe30pLFxuICBpc0F1dGhlbnRpY2F0ZWQ6ICgpID0+IGZhbHNlLFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VUaGlyZFBhcnR5QXV0aCA9ICgpID0+IHVzZUNvbnRleHQoY29udGV4dCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBUaGlyZFBhcnR5QXV0aFByb3ZpZGVyKHtcbiAgY2hpbGRyZW4sXG4gIHN0YXRlLFxuICBlcnJvckNhbGxiYWNrLFxufToge1xuICBjaGlsZHJlbjogYW55O1xuICBzdGF0ZT86IFRoaXJkUGFydHlBdXRoU3RhdGU7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbn0pIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHN0YXRlID8/PSB1c2VUaGlyZFBhcnR5QXV0aFN0YXRlKGVycm9yQ2FsbGJhY2spO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVRoaXJkUGFydHlBdXRoU3RhdGUgPSAoXG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZFxuKTogVGhpcmRQYXJ0eUF1dGhTdGF0ZSA9PiB7XG4gIGNvbnN0IFthdXRoZW50aWNhdGVkLCBzZXRBdXRoZW50aWNhdGVkXSA9IHVzZVN0YXRlPFByb3ZpZGVyU3RhdHVzPihcbiAgICBkZWZhdWx0UHJvdmlkZXJTdGF0dXNcbiAgKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgeyBwYXJ0aWNpcGFudCB9ID0gdXNlUGFydGljaXBhbnQoKTtcbiAgY29uc3QgYXBpID0gdXNlQXBpKCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBuZXdTdGF0dXM6IFByb3ZpZGVyU3RhdHVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgT2JqZWN0LnZhbHVlcyhUaGlyZFBhcnR5UHJvdmlkZXIpLm1hcCgocHJvdmlkZXIpID0+IFtcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICEhcGFydGljaXBhbnQ/LmF1dGhlbnRpY2F0ZWQuaW5jbHVkZXMocHJvdmlkZXIpLFxuICAgICAgXSlcbiAgICApIGFzIFByb3ZpZGVyU3RhdHVzO1xuXG4gICAgc2V0QXV0aGVudGljYXRlZChuZXdTdGF0dXMpO1xuICB9LCBbcGFydGljaXBhbnRdKTtcblxuICBjb25zdCBpc0F1dGhlbnRpY2F0ZWQgPSAocHJvdmlkZXI6IFRoaXJkUGFydHlQcm92aWRlcik6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiBhdXRoZW50aWNhdGVkW3Byb3ZpZGVyXSB8fCBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBhdXRoZW50aWNhdGUgPSAocHJvdmlkZXI6IFRoaXJkUGFydHlQcm92aWRlcik6IHZvaWQgPT4ge1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICBhcGkoKVxuICAgICAgLmdldChgYXV0aC8ke3Byb3ZpZGVyfWAsIHtcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgcmVkaXJlY3RfdXJsOiBnZXRDdXJyZW50SHJlZldpdGhvdXRRdWVyeVBhcmFtcygpLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS51cmwpIHtcbiAgICAgICAgICAvL2NoZWNrIGlmIHRoZXJlIGlzIGFuIGVycm9yIGluIHF1ZXJ5IHBhcmFtc1xuICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnVybC5pbmNsdWRlcyhcIj9lcnJvcj1cIikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgXCJGYWlsZWQgdG8gYXV0aGVudGljYXRlIHdpdGggVGhpcmRQYXJ0eUF1dGg6IFwiICtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLnVybC5zcGxpdChcIj9lcnJvcj1cIilbMV1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXNwb25zZS5kYXRhLnVybDtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIGVycm9yQ2FsbGJhY2sgJiYgZXJyb3JDYWxsYmFjayhlcnJvcik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpc0xvYWRpbmcsXG4gICAgYXV0aGVudGljYXRlZCxcbiAgICBhdXRoZW50aWNhdGUsXG4gICAgaXNBdXRoZW50aWNhdGVkLFxuICB9O1xufTtcbiIsImltcG9ydCB7IFBhcnRpY2lwYW50VGFza1N0YXR1cyB9IGZyb20gXCJAL21vZGVscy9lbnVtcy9wYXJ0aWNpcGFudHMuZW51bVwiO1xuaW1wb3J0IHsgVGFza0J1dHRvblR5cGUgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvdGFza19idXR0b25fdHlwZS5lbnVtXCI7XG5pbXBvcnQgeyBUYXNrVHlwZSB9IGZyb20gXCJAL21vZGVscy9lbnVtcy90YXNrcy5lbnVtXCI7XG5pbXBvcnQge1xuICBJRGlzY29yZEpvaW5NZXRhZGF0YSxcbiAgSU9wZW5VcmxNZXRhZGF0YSxcbiAgSVRhc2ssXG4gIElUZWxlZ3JhbUpvaW5NZXRhZGF0YSxcbiAgSVR3aXRjaEZvbGxvd01ldGFkYXRhLFxuICBJVHdpdHRlckZvbGxvd01ldGFkYXRhLFxuICBJVHdpdHRlckxpa2VNZXRhZGF0YSxcbiAgSVR3aXR0ZXJSZXBseU1ldGFkYXRhLFxuICBJVHdpdHRlclJlcG9zdE1ldGFkYXRhLFxuICBJWW91dHViZVN1YnNjcmliZU1ldGFkYXRhLFxuICBJWW91dHViZVZpZXdNZXRhZGF0YSxcbn0gZnJvbSBcIkAvbW9kZWxzL2ludGVyZmFjZXMvdGFza1wiO1xuaW1wb3J0IHsgVGFza1Byb3ZpZGVyLCB1c2VUYXNrIH0gZnJvbSBcIkAvcHJvdmlkZXJzL3Rhc2tcIjtcbmltcG9ydCB7XG4gIFRoaXJkUGFydHlBdXRoUHJvdmlkZXIsXG4gIHVzZVRoaXJkUGFydHlBdXRoLFxufSBmcm9tIFwiQC9wcm92aWRlcnMvdGhpcmRfcGFydHlfYXV0aFwiO1xuXG5pbXBvcnQgeyBUaGlyZFBhcnR5UHJvdmlkZXIgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvdGhpcmRfcGFydHkuZW51bVwiO1xuaW1wb3J0IHsgVGFza0NhbGxiYWNrcyB9IGZyb20gXCJAL21vZGVscy9pbnRlcmZhY2VzL3Rhc2tfY2FsbGJhY2tzXCI7XG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcblxudHlwZSBQcm9wcyA9IHtcbiAgdGFzazogSVRhc2s7XG4gIHBhcnRpY2lwYXRpb25EaXNhYmxlZDogYm9vbGVhbjtcbiAgbWFpbnRlbmFuY2U6IGJvb2xlYW47XG4gIGNoaWxkcmVuOiAocHJvcHM6IHtcbiAgICBvbkNsaWNrPzogKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTEJ1dHRvbkVsZW1lbnQsIE1vdXNlRXZlbnQ+KSA9PiB2b2lkO1xuICAgIHR5cGU6IFRhc2tCdXR0b25UeXBlO1xuICAgIGlzTG9hZGluZz86IGJvb2xlYW47XG4gICAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAgIGNvbW1lbnQ6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIH0pID0+IFJlYWN0LlJlYWN0RWxlbWVudDtcbiAgY2FsbGJhY2tzOiBUYXNrQ2FsbGJhY2tzO1xuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWQ7XG4gIG9uU3VjY2Vzcz86ICgpID0+IHZvaWQ7XG59O1xuXG5jb25zdCBUYXNrV3JhcHBlckJhc2U6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wczogUHJvcHMpID0+IHtcbiAgY29uc3Qge1xuICAgIHRhc2ssXG4gICAgcGFydGljaXBhdGlvbkRpc2FibGVkLFxuICAgIG1haW50ZW5hbmNlLFxuICAgIGNoaWxkcmVuLFxuICAgIGNhbGxiYWNrcyxcbiAgICBvblN1Y2Nlc3MsXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgW2xpbmtDbGlja2VkLCBzZXRMaW5rQ2xpY2tlZF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG5cbiAgY29uc3QgeyBwYXJ0aWNpcGF0ZSwgaXNQYXJ0aWNpcGF0aW9uTG9hZGluZyB9ID0gdXNlVGFzaygpO1xuXG4gIGNvbnN0IHRoaXJkUGFydHlBdXRoID0gdXNlVGhpcmRQYXJ0eUF1dGgoKTtcblxuICBjb25zdCBjb21wbGV0ZWQgPVxuICAgIHRhc2sucGFydGljaXBhdGlvbiAmJlxuICAgIHRhc2sucGFydGljaXBhdGlvbi5zdGF0dXMgPT09IFBhcnRpY2lwYW50VGFza1N0YXR1cy5jb21wbGV0ZWQ7XG5cbiAgY29uc3Qgb25MaW5rQ2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgc3dpdGNoICh0YXNrLnR5cGUpIHtcbiAgICAgIGNhc2UgVGFza1R5cGUuZGlzY29yZF9qb2luOlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJRGlzY29yZEpvaW5NZXRhZGF0YSkuaW52aXRlX3VybCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2ZvbGxvdzpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgYGh0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L2ZvbGxvdz9zY3JlZW5fbmFtZT0ke1xuICAgICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVR3aXR0ZXJGb2xsb3dNZXRhZGF0YSkudXNlcm5hbWVcbiAgICAgICAgICB9YCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2xpa2U6XG4gICAgICAgIHdpbmRvdy5vcGVuKCh0YXNrLm1ldGFkYXRhIGFzIElUd2l0dGVyTGlrZU1ldGFkYXRhKS5wb3N0X3VybCwgXCJfYmxhbmtcIik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcGx5OlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJVHdpdHRlclJlcGx5TWV0YWRhdGEpLnBvc3RfdXJsLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwb3N0OlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICBgaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvcmV0d2VldD90d2VldF9pZD0ke1xuICAgICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVR3aXR0ZXJSZXBvc3RNZXRhZGF0YSkucG9zdF9pZFxuICAgICAgICAgIH1gLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnRlbGVncmFtX2pvaW46XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgIGBodHRwczovL3QubWUvJHsodGFzay5tZXRhZGF0YSBhcyBJVGVsZWdyYW1Kb2luTWV0YWRhdGEpLnVzZXJuYW1lfWAsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUuaW1hZ2VfdXBsb2FkOlxuICAgICAgICBjb25zdCBmaWxlID0gYXdhaXQgY2FsbGJhY2tzLm9uRmlsZVVwbG9hZCh0YXNrKTtcbiAgICAgICAgb25QYXJ0aWNpcGF0ZSh7XG4gICAgICAgICAgZmlsZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIGNhc2UgVGFza1R5cGUuc3VibWl0X3N0cmluZzpcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhd2FpdCBjYWxsYmFja3Mub25TdWJtaXRTdHJpbmcodGFzayk7XG4gICAgICAgIG9uUGFydGljaXBhdGUoe1xuICAgICAgICAgIHZhbHVlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY2FzZSBUYXNrVHlwZS5vcGVuX3VybDpcbiAgICAgICAgd2luZG93Lm9wZW4oKHRhc2subWV0YWRhdGEgYXMgSU9wZW5VcmxNZXRhZGF0YSkudXJsLCBcIl9ibGFua1wiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnlvdXR1YmVfdmlldzpcbiAgICAgICAgY29uc3Qgc2Vjb25kc1dhdGNoZWQgPSBhd2FpdCBjYWxsYmFja3Mub25Zb3V0dWJlVmlldyhcbiAgICAgICAgICB0YXNrLFxuICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElZb3V0dWJlVmlld01ldGFkYXRhKS52aWRlb19pZFxuICAgICAgICApO1xuICAgICAgICBvblBhcnRpY2lwYXRlKHtcbiAgICAgICAgICBzZWNvbmRzOiBzZWNvbmRzV2F0Y2hlZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIGNhc2UgVGFza1R5cGUuZGFpbHlfbG9naW46XG4gICAgICAgIG9uUGFydGljaXBhdGUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0Y2hfZm9sbG93OlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJVHdpdGNoRm9sbG93TWV0YWRhdGEpLnR3aXRjaF91cmwsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUueW91dHViZV9zdWJzY3JpYmU6XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElZb3V0dWJlU3Vic2NyaWJlTWV0YWRhdGEpLmNoYW5uZWxfdXJsLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgc2V0TGlua0NsaWNrZWQodHJ1ZSk7XG4gIH07XG5cbiAgY29uc3QgaXNBdXRoZW50aWNhdGVkID0gKCkgPT4ge1xuICAgIHN3aXRjaCAodGFzay50eXBlKSB7XG4gICAgICBjYXNlIFRhc2tUeXBlLmRpc2NvcmRfY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUuZGlzY29yZF9qb2luOlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguaXNBdXRoZW50aWNhdGVkKFRoaXJkUGFydHlQcm92aWRlci5kaXNjb3JkKTtcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2ZvbGxvdzpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9saWtlOlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcGx5OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcG9zdDpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmlzQXV0aGVudGljYXRlZChUaGlyZFBhcnR5UHJvdmlkZXIudHdpdHRlcik7XG4gICAgICBjYXNlIFRhc2tUeXBlLnRlbGVncmFtX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLnRlbGVncmFtX2pvaW46XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5pc0F1dGhlbnRpY2F0ZWQoVGhpcmRQYXJ0eVByb3ZpZGVyLnRlbGVncmFtKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBhdXRoZW50aWNhdGUgPSAoKSA9PiB7XG4gICAgc3dpdGNoICh0YXNrLnR5cGUpIHtcbiAgICAgIGNhc2UgVGFza1R5cGUuZGlzY29yZF9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS5kaXNjb3JkX2pvaW46XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5hdXRoZW50aWNhdGUoVGhpcmRQYXJ0eVByb3ZpZGVyLmRpc2NvcmQpO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfZm9sbG93OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2xpa2U6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwbHk6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfcmVwb3N0OlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguYXV0aGVudGljYXRlKFRoaXJkUGFydHlQcm92aWRlci50d2l0dGVyKTtcbiAgICAgIGNhc2UgVGFza1R5cGUudGVsZWdyYW1fY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUudGVsZWdyYW1fam9pbjpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmF1dGhlbnRpY2F0ZShUaGlyZFBhcnR5UHJvdmlkZXIudGVsZWdyYW0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBvblBhcnRpY2lwYXRlID0gYXN5bmMgKGJvZHk/OiBhbnkpID0+IHtcbiAgICBjb25zdCByZXNwID0gYXdhaXQgcGFydGljaXBhdGUodGFzaywgYm9keSwgb25TdWNjZXNzKTtcbiAgICBpZiAoIXJlc3ApIHtcbiAgICAgIHNldExpbmtDbGlja2VkKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoKSA9PiB7XG4gICAgaWYgKHBhcnRpY2lwYXRpb25EaXNhYmxlZCB8fCBtYWludGVuYW5jZSB8fCBjb21wbGV0ZWQpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgYXV0aGVudGljYXRlKCk7XG4gICAgfSBlbHNlIGlmIChsaW5rQ2xpY2tlZCkge1xuICAgICAgb25QYXJ0aWNpcGF0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvbkxpbmtDbGljaygpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZXRUeXBlID0gKCkgPT4ge1xuICAgIGlmIChjb21wbGV0ZWQpIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5DT01QTEVURUQ7XG4gICAgfVxuXG4gICAgaWYgKCF0YXNrLnBhcnRpY2lwYXRpb24pIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5OT19QQVJUSUNJUEFOVDtcbiAgICB9XG5cbiAgICBpZiAodGFzay5wYXJ0aWNpcGF0aW9uPy5zdGF0dXMgPT09IFBhcnRpY2lwYW50VGFza1N0YXR1cy5wZW5kaW5nKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuUEVORElORztcbiAgICB9XG5cbiAgICBpZiAodGFzay5wYXJ0aWNpcGF0aW9uPy5zdGF0dXMgPT09IFBhcnRpY2lwYW50VGFza1N0YXR1cy5mYWlsZWQpIHtcbiAgICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5GQUlMRUQ7XG4gICAgfVxuXG4gICAgaWYgKGxpbmtDbGlja2VkKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuQ0xBSU07XG4gICAgfVxuXG4gICAgaWYgKGlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuU1RBUlQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLkFVVEhfUkVRVUlSRUQ7XG4gIH07XG5cbiAgY29uc3Qgbm9PbkNsaWNrID0gKCkgPT4ge1xuICAgIGlmIChjb21wbGV0ZWQgfHwgbWFpbnRlbmFuY2UgfHwgcGFydGljaXBhdGlvbkRpc2FibGVkKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdGFzay50eXBlID09PSBUYXNrVHlwZS5tYW51YWwgfHxcbiAgICAgIHRhc2sudHlwZSA9PT0gVGFza1R5cGUudHdpdHRlcl9hY3Rpdml0eVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4gY2hpbGRyZW4oe1xuICAgIG9uQ2xpY2s6ICFub09uQ2xpY2soKSA/IGhhbmRsZUNsaWNrIDogdW5kZWZpbmVkLFxuICAgIHR5cGU6IGdldFR5cGUoKSxcbiAgICBpc0xvYWRpbmc6IHRoaXJkUGFydHlBdXRoLmlzTG9hZGluZyB8fCBpc1BhcnRpY2lwYXRpb25Mb2FkaW5nLFxuICAgIGRpc2FibGVkOiBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQgfHwgbWFpbnRlbmFuY2UsXG4gICAgY29tbWVudDogdGFzay5wYXJ0aWNpcGF0aW9uPy5jb21tZW50LFxuICB9KTtcbn07XG5cbmNvbnN0IFRhc2tXcmFwcGVyOiBSZWFjdC5GQzxQcm9wcz4gPSAocHJvcHM6IFByb3BzKSA9PiB7XG4gIGNvbnN0IHsgdGFzaywgcGFydGljaXBhdGlvbkRpc2FibGVkLCBtYWludGVuYW5jZSwgZXJyb3JDYWxsYmFjaywgb25TdWNjZXNzIH0gPVxuICAgIHByb3BzO1xuICByZXR1cm4gKFxuICAgIDxUYXNrUHJvdmlkZXIgZXJyb3JDYWxsYmFjaz17ZXJyb3JDYWxsYmFja30+XG4gICAgICA8VGhpcmRQYXJ0eUF1dGhQcm92aWRlciBlcnJvckNhbGxiYWNrPXtlcnJvckNhbGxiYWNrfT5cbiAgICAgICAgPFRhc2tXcmFwcGVyQmFzZVxuICAgICAgICAgIHRhc2s9e3Rhc2t9XG4gICAgICAgICAgcGFydGljaXBhdGlvbkRpc2FibGVkPXtwYXJ0aWNpcGF0aW9uRGlzYWJsZWR9XG4gICAgICAgICAgbWFpbnRlbmFuY2U9e21haW50ZW5hbmNlfVxuICAgICAgICAgIGNhbGxiYWNrcz17cHJvcHMuY2FsbGJhY2tzfVxuICAgICAgICAgIG9uU3VjY2Vzcz17b25TdWNjZXNzfVxuICAgICAgICA+XG4gICAgICAgICAge3Byb3BzLmNoaWxkcmVufVxuICAgICAgICA8L1Rhc2tXcmFwcGVyQmFzZT5cbiAgICAgIDwvVGhpcmRQYXJ0eUF1dGhQcm92aWRlcj5cbiAgICA8L1Rhc2tQcm92aWRlcj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFRhc2tXcmFwcGVyO1xuIiwiZXhwb3J0IGVudW0gTWlzc2lvblR5cGUge1xuICBndWFyYW50ZWVkID0gXCJndWFyYW50ZWVkXCIsXG4gIHNjb3JlYm9hcmQgPSBcInNjb3JlYm9hcmRcIixcbiAgbG90dGVyeSA9IFwibG90dGVyeVwiLFxufVxuXG5leHBvcnQgZW51bSBNaXNzaW9uUmV3YXJkVHlwZSB7XG4gIGNyeXB0byA9IFwiY3J5cHRvXCIsXG4gIHBvaW50cyA9IFwicG9pbnRzXCIsXG4gIHBvaW50c19wZXJfdGFzayA9IFwicG9pbnRzX3Blcl90YXNrXCIsXG59XG4iLCJleHBvcnQgZW51bSBRdWVzdFdlYmhvb2tUeXBlIHtcbiAgcGFydGljaXBhbnRfcmV3YXJkX2FkZGVkID0gJ3BhcnRpY2lwYW50X3Jld2FyZF9hZGRlZCcsXG4gIHBhcnRpY2lwYW50X3Jld2FyZF9yZW1vdmVkID0gJ3BhcnRpY2lwYW50X3Jld2FyZF9yZW1vdmVkJyxcbiAgdGhpcmRfcGFydHlfYXV0aGVudGljYXRlZCA9ICd0aGlyZF9wYXJ0eV9hdXRoZW50aWNhdGVkJyxcbiAgdGFza19jb21wbGV0ZWQgPSAndGFza19jb21wbGV0ZWQnLFxufVxuIiwiZXhwb3J0IGVudW0gVGFza1ZhbGlkYXRpb24ge1xuICBlbWFpbCA9IFwiZW1haWxcIixcbiAgaXNfZXF1YWwgPSBcImlzX2VxdWFsXCIsXG59XG4iLCJpbXBvcnQgeyBHYW1lc29jaWFsUHJvdmlkZXIgfSBmcm9tIFwiLi9wcm92aWRlcnMvZ2FtZXNvY2lhbFwiO1xuaW1wb3J0IHsgTWlzc2lvbnNQcm92aWRlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9taXNzaW9uc1wiO1xuaW1wb3J0IHsgUGFydGljaXBhbnRQcm92aWRlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9wYXJ0aWNpcGFudFwiO1xuXG5leHBvcnQgY29uc3QgUXVlc3RzUHJvdmlkZXIgPSAoe1xuICBjaGlsZHJlbixcbiAgYXBpS2V5LFxuICBhcGlVcmwsXG4gIGVycm9yQ2FsbGJhY2ssXG59OiB7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhcGlVcmw6IHN0cmluZztcbiAgZXJyb3JDYWxsYmFjaz86IChlcnJvcjogYW55KSA9PiB2b2lkO1xufSkgPT4ge1xuICByZXR1cm4gKFxuICAgIDxHYW1lc29jaWFsUHJvdmlkZXIgYXBpS2V5PXthcGlLZXl9IGFwaVVybD17YXBpVXJsfT5cbiAgICAgIDxQYXJ0aWNpcGFudFByb3ZpZGVyIGVycm9yQ2FsbGJhY2s9e2Vycm9yQ2FsbGJhY2t9PlxuICAgICAgICA8TWlzc2lvbnNQcm92aWRlcj57Y2hpbGRyZW59PC9NaXNzaW9uc1Byb3ZpZGVyPlxuICAgICAgPC9QYXJ0aWNpcGFudFByb3ZpZGVyPlxuICAgIDwvR2FtZXNvY2lhbFByb3ZpZGVyPlxuICApO1xufTtcbiJdfQ==