'use strict';

var react = require('react');
var jsxRuntime = require('react/jsx-runtime');
var Pt = require('axios');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var Pt__default = /*#__PURE__*/_interopDefault(Pt);

var ot=Object.defineProperty,nt=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var G=(e,t,r)=>t in e?ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))ct.call(t,r)&&G(e,r,t[r]);if(F)for(var r of F(t))dt.call(t,r)&&G(e,r,t[r]);return e},g=(e,t)=>nt(e,st(t));var A=(e,t,r)=>new Promise((i,a)=>{var u=c=>{try{n(r.next(c));}catch(o){a(o);}},_=c=>{try{n(r.throw(c));}catch(o){a(o);}},n=c=>c.done?i(c.value):Promise.resolve(c.value).then(u,_);n((r=r.apply(e,t)).next());});var C=(a=>(a.created="created",a.pending="pending",a.completed="completed",a.failed="failed",a))(C||{}),ut=(a=>(a.created="created",a.started="started",a.completed="completed",a.failed="failed",a))(ut||{});var O=(n=>(n.NO_PARTICIPANT="NO_PARTICIPANT",n.START="START",n.CLAIM="CLAIM",n.PENDING="PENDING",n.COMPLETED="COMPLETED",n.FAILED="FAILED",n.AUTH_REQUIRED="AUTH_REQUIRED",n))(O||{});var T=(p=>(p.telegram_join="telegram_join",p.telegram_connect="telegram_connect",p.youtube_view="youtube_view",p.image_upload="image_upload",p.twitter_repost="twitter_repost",p.twitter_follow="twitter_follow",p.twitter_reply="twitter_reply",p.twitter_like="twitter_like",p.twitter_activity="twitter_activity",p.twitter_connect="twitter_connect",p.discord_join="discord_join",p.discord_connect="discord_connect",p.submit_string="submit_string",p.manual="manual",p.daily_login="daily_login",p.open_url="open_url",p.youtube_subscribe="youtube_subscribe",p.twitch_follow="twitch_follow",p))(T||{});var N=react.createContext({apiUrl:"",apiKey:"",authToken:void 0,setAuthToken:()=>{}}),y=()=>react.useContext(N);function j({children:e,state:t,apiKey:r,apiUrl:i}){return t!=null||(t=_t(r,i)),jsxRuntime.jsx(N.Provider,{value:t,children:e})}var _t=(e,t)=>{let[r,i]=react.useState({apiUrl:t,apiKey:e,userAuthToken:void 0}),a=r.userAuthToken,u=react.useCallback(_=>{i(n=>g(w({},n),{userAuthToken:_}));},[]);return {apiUrl:t,apiKey:e,authToken:a,setAuthToken:u}};var v=()=>{let{authToken:e,apiUrl:t,apiKey:r}=y(),i=()=>{let _=Pt__default.default.create({baseURL:t,timeout:1e4,headers:{"Api-Key":r,"Api-Version":"1.0"}});return _.interceptors.request.use(n=>{let c=e;return c&&(n.headers.Authorization=`Bearer ${c}`),n},n=>Promise.reject(n)),_.interceptors.response.use(n=>n,n=>(n.response&&n.response.status===401&&typeof window!="undefined"&&localStorage.removeItem("token"),Promise.reject(n))),_},[a,u]=react.useState(i());return react.useEffect(()=>{u(i());},[t,r,e]),a};var x={discord_not_connected:"Discord account is not connected",discord_guild_user_not_found:"Discord user not found in channel ",discord_guild_required_role_not_exists:"Discord channel verification must be passed",discord_guild_user_is_pending:"Please validate that your accepted Terms of Discord channel",discord_unauthenticated:"Please re-authenticate your discord account",telegram_not_connected:"Telegram account is not connected",telegram_member_not_found:"Telegram account not found in group",telegram_unauthenticated:"Please re-authenticate your telegram account",twitter_not_connected:"X account is not connected",twitter_follower_not_found:"Your X account do not follow required account",twitter_unauthenticated:"Please re-authenticate your X account",youtube_invalid_video_watch_length:"Please watch whole video",file_not_provided:"File not provided",file_size_exceeds:"File size exceeds limit",invalid_file_type:"Invalid file type",mission_not_found:"Mission not found",mission_not_started:"Mission not started",mission_ended:"Mission ended",task_not_found:"Task not found",task_inactive:"Task inactive",participant_not_found:"Participant not found",third_party_unauthenticated:"Please re-authenticate your account",invalid_email:"Invalid email address",invalid_value:"Invalid value",invalid_captcha:"Invalid captcha"},K=e=>e===x.discord_unauthenticated||e===x.telegram_unauthenticated||e===x.twitter_unauthenticated;var Y=react.createContext({missions:[],tasks:[],getTasksForMission:()=>[],updateTaskStatus:()=>{},maintenance:!1}),$=()=>react.useContext(Y);function H({children:e,state:t}){return t!=null||(t=yt()),jsxRuntime.jsx(Y.Provider,{value:t,children:e})}var yt=()=>{let[e,t]=react.useState([]),[r,i]=react.useState([]),{authToken:a}=y(),u=v(),[_,n]=react.useState(!1);react.useEffect(()=>{c();},[a]),react.useEffect(()=>{e.length>0&&o(e.map(d=>d.id));},[e]),react.useEffect(()=>{a&&a.length===0&&n(!0);},[a]);let c=()=>{u.get("missions").then(function(d){t(d.data);}).catch(function(){n(!0);}).finally(function(){});},o=d=>{let m=d.map(f=>u.get(`missions/${f}/tasks`));Promise.all(m).then(function(f){let P=new Set(Object.values(T)),h=f.map(k=>k.data).flat().filter(k=>P.has(k.type));i(h);}).catch(function(){n(!0);});},s=(d,m)=>{i(r.map(f=>f.id===d?g(w({},f),{participation:{status:m}}):f));},l=react.useCallback(d=>r.filter(m=>m.mission_id===d),[r]);return {missions:e,tasks:r,getTasksForMission:l,updateTaskStatus:s,maintenance:_}};var q=(r=>(r.points="points",r.multiplier="multiplier",r))(q||{});var J=react.createContext({participant:void 0,isThirdPartyAuthenticated:()=>!1,addPoints:()=>{},getParticipant:()=>{}}),M=()=>react.useContext(J);function z({children:e,state:t,errorCallback:r}){return t!=null||(t=Mt(r)),jsxRuntime.jsx(J.Provider,{value:t,children:e})}var Mt=e=>{let[t,r]=react.useState(),{authToken:i}=y(),a=v();react.useEffect(()=>{i?u():r(void 0);},[i]);let u=()=>{a.get("participants/me").then(function(c){r(c.data);}).catch(function(c){console.error(c),e&&e(c);});};return {participant:t,isThirdPartyAuthenticated:c=>!!(t!=null&&t.authenticated.includes(c)),addPoints:c=>{c.points_reward&&r(o=>{var s;if(o)if(c.reward_type==="points"){let l=Math.floor(c.points_reward*((s=t==null?void 0:t.points_multiplier)!=null?s:1));r(d=>{if(d)return g(w({},d),{points:(d==null?void 0:d.points)+l})});}else r(l=>{if(l)return g(w({},l),{points_multiplier:(l==null?void 0:l.points_multiplier)+c.points_reward})});});},getParticipant:u}};var V=react.createContext({isParticipationLoading:!1,participate:()=>Promise.resolve(!1)}),W=()=>react.useContext(V);function X({children:e,state:t,errorCallback:r}){return t!=null||(t=Dt(r)),jsxRuntime.jsx(V.Provider,{value:t,children:e})}var Dt=e=>{let[t,r]=react.useState(!1),{updateTaskStatus:i}=$(),{addPoints:a,getParticipant:u}=M(),_=v(),n=o=>{var l,d,m,f,P,h,k,p;let s="";(d=(l=o==null?void 0:o.response)==null?void 0:l.data)!=null&&d.message?typeof((f=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:f.message)=="string"&&(s=(h=(P=o==null?void 0:o.response)==null?void 0:P.data)==null?void 0:h.message.toString()):(k=o==null?void 0:o.response)!=null&&k.message&&(s=(p=o==null?void 0:o.response)==null?void 0:p.message.toString()),s?s in x?(K(s)&&u(),e&&e(x[s])):e&&e(s):e&&e("Server error, please try again later");};return {isParticipationLoading:t,participate:(o,s,l)=>A(void 0,null,function*(){r(!0);let d=w({},s);if(s!=null&&s.file){let m=yield fetch(s.file).then(f=>f.blob()).then(f=>{let P=new FileReader;return P.readAsDataURL(f),new Promise(h=>{P.onloadend=()=>{h(P.result);};})});d=g(w({},s),{file:{imageSrc:m}});}return yield _.post(`tasks/${o.id}`,s?d:void 0).then(function(m){return i(o.id,m.data.status),m.data.status==="completed"&&o.points_reward&&a(o),l&&l(),!0}).catch(function(m){n(m);}).finally(function(){r(!1);}),!1})}};var S=(i=>(i.twitter="twitter",i.telegram="telegram",i.discord="discord",i))(S||{});var Q=()=>{let e=new URL(window.location.href);return e.search="",e.href};var B=Object.fromEntries(Object.values(S).map(e=>[e,!1])),tt=react.createContext({isLoading:!1,authenticated:B,authenticate:()=>({}),isAuthenticated:()=>!1}),et=()=>react.useContext(tt);function rt({children:e,state:t,errorCallback:r}){return t!=null||(t=Nt(r)),jsxRuntime.jsx(tt.Provider,{value:t,children:e})}var Nt=e=>{let[t,r]=react.useState(B),[i,a]=react.useState(!1),{participant:u}=M(),_=v();return react.useEffect(()=>{let o=Object.fromEntries(Object.values(S).map(s=>[s,!!(u!=null&&u.authenticated.includes(s))]));r(o);},[u]),{isLoading:i,authenticated:t,authenticate:o=>{a(!0),_.get(`auth/${o}`,{params:{redirect_url:Q()}}).then(function(s){if(s.data.url){if(s.data.url.includes("?error="))throw new Error("Failed to authenticate with ThirdPartyAuth: "+s.data.url.split("?error=")[1]);window.location.href=s.data.url;}}).catch(function(s){console.error(s),e&&e(s);}).finally(()=>{a(!1);});},isAuthenticated:o=>t[o]||!1}};var Yt=e=>{var U;let{task:t,participationDisabled:r,maintenance:i,children:a,callbacks:u,onSuccess:_}=e,[n,c]=react.useState(!1),{participate:o,isParticipationLoading:s}=W(),l=et(),d=t.participation&&t.participation.status==="completed",m=()=>A(void 0,null,function*(){switch(t.type){case"discord_join":window.open(t.metadata.invite_url,"_blank");break;case"twitter_follow":window.open(`https://twitter.com/intent/follow?screen_name=${t.metadata.username}`,"_blank");break;case"twitter_like":window.open(t.metadata.post_url,"_blank");break;case"twitter_reply":window.open(t.metadata.post_url,"_blank");break;case"twitter_repost":window.open(`https://twitter.com/intent/retweet?tweet_id=${t.metadata.post_id}`,"_blank");break;case"telegram_join":window.open(`https://t.me/${t.metadata.username}`,"_blank");break;case"image_upload":let b=yield u.onFileUpload(t);h({file:b});return;case"submit_string":let I=yield u.onSubmitString(t);h({value:I});return;case"open_url":window.open(t.metadata.url,"_blank");break;case"youtube_view":let at=yield u.onYoutubeView(t,t.metadata.video_id);h({seconds:at});return;case"daily_login":h();return;case"twitch_follow":window.open(t.metadata.twitch_url,"_blank");break;case"youtube_subscribe":window.open(t.metadata.channel_url,"_blank");break}c(!0);}),f=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.isAuthenticated("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.isAuthenticated("twitter");case"telegram_connect":case"telegram_join":return l.isAuthenticated("telegram");default:return !0}},P=()=>{switch(t.type){case"discord_connect":case"discord_join":return l.authenticate("discord");case"twitter_connect":case"twitter_follow":case"twitter_like":case"twitter_reply":case"twitter_repost":return l.authenticate("twitter");case"telegram_connect":case"telegram_join":return l.authenticate("telegram")}},h=b=>A(void 0,null,function*(){(yield o(t,b,_))||c(!1);}),k=()=>{r||i||d||(f()?n?h():m():P());},p=()=>{var b,I;return d?"COMPLETED":t.participation?((b=t.participation)==null?void 0:b.status)==="pending"?"PENDING":((I=t.participation)==null?void 0:I.status)==="failed"?"FAILED":n?"CLAIM":f()?"START":"AUTH_REQUIRED":"NO_PARTICIPANT"};return a({onClick:!!(d||i||r||t.type==="manual"||t.type==="twitter_activity")?void 0:k,type:p(),isLoading:l.isLoading||s,disabled:r||i,comment:(U=t.participation)==null?void 0:U.comment})},$t=e=>{let{task:t,participationDisabled:r,maintenance:i,errorCallback:a,onSuccess:u}=e;return jsxRuntime.jsx(X,{errorCallback:a,children:jsxRuntime.jsx(rt,{errorCallback:a,children:jsxRuntime.jsx(Yt,{task:t,participationDisabled:r,maintenance:i,callbacks:e.callbacks,onSuccess:u,children:e.children})})})},Ht=$t;var qt=(i=>(i.guaranteed="guaranteed",i.scoreboard="scoreboard",i.lottery="lottery",i))(qt||{}),Jt=(i=>(i.crypto="crypto",i.points="points",i.points_per_task="points_per_task",i))(Jt||{});var zt=(a=>(a.participant_reward_added="participant_reward_added",a.participant_reward_removed="participant_reward_removed",a.third_party_authenticated="third_party_authenticated",a.task_completed="task_completed",a))(zt||{});var Vt=(r=>(r.email="email",r.is_equal="is_equal",r))(Vt||{});var Tr=({children:e,apiKey:t,apiUrl:r,errorCallback:i})=>jsxRuntime.jsx(j,{apiKey:t,apiUrl:r,children:jsxRuntime.jsx(z,{errorCallback:i,children:jsxRuntime.jsx(H,{children:e})})});

exports.GamesocialProvider = j;
exports.MissionRewardType = Jt;
exports.MissionType = qt;
exports.MissionsProvider = H;
exports.ParticipantMissionStatus = ut;
exports.ParticipantProvider = z;
exports.ParticipantTaskStatus = C;
exports.QuestWebhookType = zt;
exports.QuestsProvider = Tr;
exports.TaskButtonType = O;
exports.TaskProvider = X;
exports.TaskRewardType = q;
exports.TaskType = T;
exports.TaskValidation = Vt;
exports.TaskWrapper = Ht;
exports.ThirdPartyProvider = S;
exports.errorMessages = x;
exports.getCurrentHrefWithoutQueryParams = Q;
exports.shouldRefetchParticipant = K;
exports.useGamesocial = y;
exports.useGamesocialState = _t;
exports.useMissions = $;
exports.useMissionsState = yt;
exports.useParticipant = M;
exports.useParticipantState = Mt;
exports.useTask = W;
exports.useTaskState = Dt;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb2RlbHMvZW51bXMvcGFydGljaXBhbnRzLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfYnV0dG9uX3R5cGUuZW51bS50cyIsIi4uL3NyYy9tb2RlbHMvZW51bXMvdGFza3MuZW51bS50cyIsIi4uL3NyYy9wcm92aWRlcnMvdGFzay50c3giLCIuLi9zcmMvcHJvdmlkZXJzL2dhbWVzb2NpYWwudHN4IiwiLi4vc3JjL2hvb2tzL3VzZUFwaS50cyIsIi4uL3NyYy91dGlscy9lcnJvcnMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL21pc3Npb25zLnRzeCIsIi4uL3NyYy9wcm92aWRlcnMvcGFydGljaXBhbnQudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy90YXNrX3Jld2FyZF90eXBlLmVudW0udHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3RoaXJkX3BhcnR5LmVudW0udHMiLCIuLi9zcmMvdXRpbHMvdXRpbHMudHMiLCIuLi9zcmMvcHJvdmlkZXJzL3RoaXJkX3BhcnR5X2F1dGgudHN4IiwiLi4vc3JjL2NvbXBvbmVudHMvVGFza1dyYXBwZXIudHN4IiwiLi4vc3JjL21vZGVscy9lbnVtcy9taXNzaW9ucy5lbnVtLnRzIiwiLi4vc3JjL21vZGVscy9lbnVtcy9xdWVzdF93ZWJob29rX3R5cGUudHMiLCIuLi9zcmMvbW9kZWxzL2VudW1zL3Rhc2tfdmFsaWRhdGlvbi5lbnVtLnRzIiwiLi4vc3JjL3dyYXBwZXJzLnRzeCJdLCJuYW1lcyI6WyJQYXJ0aWNpcGFudFRhc2tTdGF0dXMiLCJQYXJ0aWNpcGFudE1pc3Npb25TdGF0dXMiLCJUYXNrQnV0dG9uVHlwZSIsIlRhc2tUeXBlIiwiY3JlYXRlQ29udGV4dCIsInVzZUNvbnRleHQiLCJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwianN4IiwiY29udGV4dCIsInVzZUdhbWVzb2NpYWwiLCJHYW1lc29jaWFsUHJvdmlkZXIiLCJjaGlsZHJlbiIsInN0YXRlIiwiYXBpS2V5IiwiYXBpVXJsIiwidXNlR2FtZXNvY2lhbFN0YXRlIiwiY29uZmlnIiwic2V0Q29uZmlnIiwiYXV0aFRva2VuIiwic2V0QXV0aFRva2VuIiwidG9rZW4iLCJwcmV2IiwiX19zcHJlYWRQcm9wcyIsIl9fc3ByZWFkVmFsdWVzIiwiYXhpb3MiLCJ1c2VFZmZlY3QiLCJ1c2VBcGkiLCJjcmVhdGVBcGkiLCJhcGkiLCJlcnJvciIsInJlc3BvbnNlIiwic2V0QXBpIiwiZXJyb3JNZXNzYWdlcyIsInNob3VsZFJlZmV0Y2hQYXJ0aWNpcGFudCIsInVzZU1pc3Npb25zIiwiTWlzc2lvbnNQcm92aWRlciIsInVzZU1pc3Npb25zU3RhdGUiLCJtaXNzaW9ucyIsInNldE1pc3Npb25zIiwidGFza3MiLCJzZXRUYXNrcyIsIm1haW50ZW5hbmNlIiwic2V0TWFpbnRlbmFuY2UiLCJnZXRNaXNzaW9ucyIsImdldFRhc2tzIiwibSIsIm1pc3Npb25JZHMiLCJwcm9taXNlcyIsImlkIiwicmVzcG9uc2VzIiwidmFsaWRUeXBlcyIsInIiLCJ0IiwidXBkYXRlVGFza1N0YXR1cyIsInRhc2tJZCIsInN0YXR1cyIsInRhc2siLCJnZXRUYXNrc0Zvck1pc3Npb24iLCJtaXNzaW9uSWQiLCJUYXNrUmV3YXJkVHlwZSIsInVzZVBhcnRpY2lwYW50IiwiUGFydGljaXBhbnRQcm92aWRlciIsImVycm9yQ2FsbGJhY2siLCJ1c2VQYXJ0aWNpcGFudFN0YXRlIiwicGFydGljaXBhbnQiLCJzZXRQYXJ0aWNpcGFudCIsImdldFBhcnRpY2lwYW50IiwidGhpcmRQYXJ0eSIsIl9hIiwicG9pbnRzIiwidXNlVGFzayIsIlRhc2tQcm92aWRlciIsInVzZVRhc2tTdGF0ZSIsImlzUGFydGljaXBhdGlvbkxvYWRpbmciLCJzZXRJc1BhcnRpY2lwYXRpb25Mb2FkaW5nIiwiYWRkUG9pbnRzIiwiaGFuZGxlRXJyb3IiLCJlIiwiX2IiLCJfYyIsIl9kIiwiX2UiLCJfZiIsIl9nIiwiX2giLCJtZXNzYWdlIiwiYm9keSIsImNhbGxiYWNrIiwiX19hc3luYyIsImRhdGEiLCJiYXNlNjQiLCJibG9iIiwicmVhZGVyIiwicmVzIiwiVGhpcmRQYXJ0eVByb3ZpZGVyIiwiZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMiLCJ1cmwiLCJkZWZhdWx0UHJvdmlkZXJTdGF0dXMiLCJwcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoIiwiVGhpcmRQYXJ0eUF1dGhQcm92aWRlciIsInVzZVRoaXJkUGFydHlBdXRoU3RhdGUiLCJhdXRoZW50aWNhdGVkIiwic2V0QXV0aGVudGljYXRlZCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsIm5ld1N0YXR1cyIsIlRhc2tXcmFwcGVyQmFzZSIsInByb3BzIiwicGFydGljaXBhdGlvbkRpc2FibGVkIiwiY2FsbGJhY2tzIiwib25TdWNjZXNzIiwibGlua0NsaWNrZWQiLCJzZXRMaW5rQ2xpY2tlZCIsInBhcnRpY2lwYXRlIiwidGhpcmRQYXJ0eUF1dGgiLCJjb21wbGV0ZWQiLCJvbkxpbmtDbGljayIsImZpbGUiLCJvblBhcnRpY2lwYXRlIiwidmFsdWUiLCJzZWNvbmRzV2F0Y2hlZCIsImlzQXV0aGVudGljYXRlZCIsImF1dGhlbnRpY2F0ZSIsImhhbmRsZUNsaWNrIiwiZ2V0VHlwZSIsIlRhc2tXcmFwcGVyIiwiVGFza1dyYXBwZXJfZGVmYXVsdCIsIk1pc3Npb25UeXBlIiwiTWlzc2lvblJld2FyZFR5cGUiLCJRdWVzdFdlYmhvb2tUeXBlIiwiVGFza1ZhbGlkYXRpb24iLCJRdWVzdHNQcm92aWRlciJdLCJtYXBwaW5ncyI6Im9vQkFBTyxJQUFLQSxPQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsT0FBQSxJQU9BQyxRQUNWQSxFQUFBLFFBQVUsVUFDVkEsRUFBQSxRQUFVLFVBQ1ZBLEVBQUEsVUFBWSxZQUNaQSxFQUFBLE9BQVMsU0FKQ0EsUUFBQSxJQ1BMLElBQUtDLE9BQ1ZBLEVBQUEsZUFBaUIsaUJBQ2pCQSxFQUFBLE1BQVEsUUFDUkEs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RSxLQUFBcEQsRUFBTSxzQkFBQXFELEVBQXVCLFlBQUFwRSxFQUFhLGNBQUFxQixFQUFlLFVBQUFpRCxDQUFVLEVBQ3pFSCxFQUNGLE9BQ0VyRyxFQUFDZ0UsRUFBQSxDQUFhLGNBQWVULEVBQzNCLFNBQUF2RCxFQUFDNkYsR0FBQSxDQUF1QixjQUFldEMsRUFDckMsU0FBQXZELEVBQUNvRyxHQUFBLENBQ0MsS0FBTW5ELEVBQ04sc0JBQXVCcUQsRUFDdkIsWUFBYXBFLEVBQ2IsVUFBV21FLEVBQU0sVUFDakIsVUFBV0csRUFFVixTQUFBSCxFQUFNLFNBQ1QsRUFDRixFQUNGLENBRUosRUFFT21CLEdBQVFELEdDcFJSLElBQUtFLFFBQ1ZBLEVBQUEsV0FBYSxhQUNiQSxFQUFBLFdBQWEsYUFDYkEsRUFBQSxRQUFVLFVBSEFBLFFBQUEsSUFNQUMsUUFDVkEsRUFBQSxPQUFTLFNBQ1RBLEVBQUEsT0FBUyxTQUNUQSxFQUFBLGdCQUFrQixrQkFIUkEsUUFBQSxJQ05MLElBQUtDLFFBQ1ZBLEVBQUEseUJBQTJCLDJCQUMzQkEsRUFBQSwyQkFBNkIsNkJBQzdCQSxFQUFBLDBCQUE0Qiw0QkFDNUJBLEVBQUEsZUFBaUIsaUJBSlBBLFFBQUEsSUNBTCxJQUFLQyxRQUNWQSxFQUFBLE1BQVEsUUFDUkEsRUFBQSxTQUFXLFdBRkRBLFFBQUEsSUNrQkosY0FBQTVILE1BQUEsb0JBZEQsSUFBTTZILEdBQWlCLENBQUMsQ0FDN0IsU0FBQXpILEVBQ0EsT0FBQUUsRUFDQSxPQUFBQyxFQUNBLGNBQUFnRCxDQUNGLElBT0l2RCxFQUFDRyxFQUFBLENBQW1CLE9BQVFHLEVBQVEsT0FBUUMsRUFDMUMsU0FBQVAsRUFBQ3NELEVBQUEsQ0FBb0IsY0FBZUMsRUFDbEMsU0FBQXZELEVBQUM0QixFQUFBLENBQWtCLFNBQUF4QixFQUFTLEVBQzlCLEVBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBQYXJ0aWNpcGFudFRhc2tTdGF0dXMge1xuICBjcmVhdGVkID0gJ2NyZWF0ZWQnLFxuICBwZW5kaW5nID0gJ3BlbmRpbmcnLFxuICBjb21wbGV0ZWQgPSAnY29tcGxldGVkJyxcbiAgZmFpbGVkID0gJ2ZhaWxlZCcsXG59XG5cbmV4cG9ydCBlbnVtIFBhcnRpY2lwYW50TWlzc2lvblN0YXR1cyB7XG4gIGNyZWF0ZWQgPSAnY3JlYXRlZCcsXG4gIHN0YXJ0ZWQgPSAnc3RhcnRlZCcsXG4gIGNvbXBsZXRlZCA9ICdjb21wbGV0ZWQnLFxuICBmYWlsZWQgPSAnZmFpbGVkJyxcbn1cbiIsImV4cG9ydCBlbnVtIFRhc2tCdXR0b25UeXBlIHtcbiAgTk9fUEFSVElDSVBBTlQgPSBcIk5PX1BBUlRJQ0lQQU5UXCIsIC8vIElmIG5vdCBwYXJ0aWNpcGFudCBpcyBmb3VuZC4gVXN1YWxseSB0aGF0IG1lYW5zIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLlxuICBTVEFSVCA9IFwiU1RBUlRcIiwgLy8gSWYgdGhlIHRhc2sgaXMgbm90IGNvbXBsZXRlZCBhbmQgdGhlIHVzZXIgaXMgYXV0aGVudGljYXRlZC5cbiAgQ0xBSU0gPSBcIkNMQUlNXCIsIC8vIElmIHRoZSB0YXNrIGhhcyBiZWVuIHN0YXJ0ZWQgYW5kIHRoZSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQuXG4gIFBFTkRJTkcgPSBcIlBFTkRJTkdcIiwgLy8gSWYgdGhlIHRhc2sgaXMgcGVuZGluZ1xuICBDT01QTEVURUQgPSBcIkNPTVBMRVRFRFwiLCAvLyBJZiB0aGUgdGFzayBpcyBjb21wbGV0ZWRcbiAgRkFJTEVEID0gXCJGQUlMRURcIiwgLy8gSWYgdGhlIHRhc2sgaGFzIGZhaWxlZFxuICBBVVRIX1JFUVVJUkVEID0gXCJBVVRIX1JFUVVJUkVEXCIsIC8vIElmIHRhc2sgcmVxdWlyZXMgYXV0aGVudGljYXRpb24gZmlyc3Rcbn1cbiIsImV4cG9ydCBlbnVtIFRhc2tUeXBlIHtcbiAgdGVsZWdyYW1fam9pbiA9IFwidGVsZWdyYW1fam9pblwiLFxuICB0ZWxlZ3JhbV9jb25uZWN0ID0gXCJ0ZWxlZ3JhbV9jb25uZWN0XCIsXG5cbiAgeW91dHViZV92aWV3ID0gXCJ5b3V0dWJlX3ZpZXdcIixcbiAgaW1hZ2VfdXBsb2FkID0gXCJpbWFnZV91cGxvYWRcIixcblxuICB0d2l0dGVyX3JlcG9zdCA9IFwidHdpdHRlcl9yZXBvc3RcIixcbiAgdHdpdHRlcl9mb2xsb3cgPSBcInR3aXR0ZXJfZm9sbG93XCIsXG4gIHR3aXR0ZXJfcmVwbHkgPSBcInR3aXR0ZXJfcmVwbHlcIixcbiAgdHdpdHRlcl9saWtlID0gXCJ0d2l0dGVyX2xpa2VcIixcbiAgdHdpdHRlcl9hY3Rpdml0eSA9IFwidHdpdHRlcl9hY3Rpdml0eVwiLFxuICB0d2l0dGVyX2Nvbm5lY3QgPSBcInR3aXR0ZXJfY29ubmVjdFwiLFxuXG4gIGRpc2NvcmRfam9pbiA9IFwiZGlzY29yZF9qb2luXCIsXG4gIGRpc2NvcmRfY29ubmVjdCA9IFwiZGlzY29yZF9jb25uZWN0XCIsXG5cbiAgc3VibWl0X3N0cmluZyA9IFwic3VibWl0X3N0cmluZ1wiLFxuICBtYW51YWwgPSBcIm1hbnVhbFwiLFxuXG4gIGRhaWx5X2xvZ2luID0gXCJkYWlseV9sb2dpblwiLFxuICBvcGVuX3VybCA9IFwib3Blbl91cmxcIixcbiAgeW91dHViZV9zdWJzY3JpYmUgPSBcInlvdXR1YmVfc3Vic2NyaWJlXCIsXG4gIHR3aXRjaF9mb2xsb3cgPSBcInR3aXRjaF9mb2xsb3dcIixcbn1cbiIsImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5cbmltcG9ydCB7IHVzZUFwaSB9IGZyb20gXCJAL2hvb2tzL3VzZUFwaVwiO1xuaW1wb3J0IHsgUGFydGljaXBhbnRUYXNrU3RhdHVzIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3BhcnRpY2lwYW50cy5lbnVtXCI7XG5pbXBvcnQgeyBJVGFzayB9IGZyb20gXCJAL21vZGVscy9pbnRlcmZhY2VzL3Rhc2tcIjtcbmltcG9ydCB7IGVycm9yTWVzc2FnZXMsIHNob3VsZFJlZmV0Y2hQYXJ0aWNpcGFudCB9IGZyb20gXCJAL3V0aWxzL2Vycm9yc1wiO1xuaW1wb3J0IHsgdXNlTWlzc2lvbnMgfSBmcm9tIFwiLi9taXNzaW9uc1wiO1xuaW1wb3J0IHsgdXNlUGFydGljaXBhbnQgfSBmcm9tIFwiLi9wYXJ0aWNpcGFudFwiO1xuXG50eXBlIFRhc2tTdGF0ZSA9IHtcbiAgaXNQYXJ0aWNpcGF0aW9uTG9hZGluZzogYm9vbGVhbjtcbiAgcGFydGljaXBhdGU6ICh0YXNrOiBJVGFzaywgYm9keT86IGFueSwgY2FsbGJhY2s/OiBhbnkpID0+IFByb21pc2U8Ym9vbGVhbj47XG59O1xuXG5jb25zdCBjb250ZXh0ID0gY3JlYXRlQ29udGV4dDxUYXNrU3RhdGU+KHtcbiAgaXNQYXJ0aWNpcGF0aW9uTG9hZGluZzogZmFsc2UsXG4gIHBhcnRpY2lwYXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoZmFsc2UpLFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VUYXNrID0gKCkgPT4gdXNlQ29udGV4dChjb250ZXh0KTtcblxuZXhwb3J0IGZ1bmN0aW9uIFRhc2tQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbiAgZXJyb3JDYWxsYmFjayxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBUYXNrU3RhdGU7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbn0pIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHN0YXRlID8/PSB1c2VUYXNrU3RhdGUoZXJyb3JDYWxsYmFjayk7XG4gIHJldHVybiA8Y29udGV4dC5Qcm92aWRlciB2YWx1ZT17c3RhdGV9PntjaGlsZHJlbn08L2NvbnRleHQuUHJvdmlkZXI+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlVGFza1N0YXRlID0gKFxuICBlcnJvckNhbGxiYWNrPzogKGVycm9yOiBhbnkpID0+IHZvaWRcbik6IFRhc2tTdGF0ZSA9PiB7XG4gIGNvbnN0IFtpc1BhcnRpY2lwYXRpb25Mb2FkaW5nLCBzZXRJc1BhcnRpY2lwYXRpb25Mb2FkaW5nXSA9XG4gICAgdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBjb25zdCB7IHVwZGF0ZVRhc2tTdGF0dXMgfSA9IHVzZU1pc3Npb25zKCk7XG4gIGNvbnN0IHsgYWRkUG9pbnRzLCBnZXRQYXJ0aWNpcGFudCB9ID0gdXNlUGFydGljaXBhbnQoKTtcbiAgY29uc3QgYXBpID0gdXNlQXBpKCk7XG5cbiAgY29uc3QgaGFuZGxlRXJyb3IgPSAoZTogYW55KSA9PiB7XG4gICAgbGV0IG1lc3NhZ2U6IHN0cmluZyA9IFwiXCI7XG4gICAgaWYgKGU/LnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlKSB7XG4gICAgICBpZiAodHlwZW9mIGU/LnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG1lc3NhZ2UgPSBlPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZS50b1N0cmluZygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdG9kb1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZT8ucmVzcG9uc2U/Lm1lc3NhZ2UpIHtcbiAgICAgIG1lc3NhZ2UgPSBlPy5yZXNwb25zZT8ubWVzc2FnZS50b1N0cmluZygpO1xuICAgIH1cblxuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgZXJyb3JDYWxsYmFjayAmJiBlcnJvckNhbGxiYWNrKFwiU2VydmVyIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobWVzc2FnZSBpbiBlcnJvck1lc3NhZ2VzKSB7XG4gICAgICAgIGNvbnN0IHMgPSBzaG91bGRSZWZldGNoUGFydGljaXBhbnQobWVzc2FnZSk7XG4gICAgICAgIGlmIChzKSB7XG4gICAgICAgICAgLy8gVE9ETyBNYXliZSBhd2FpdCB0aGlzXG4gICAgICAgICAgZ2V0UGFydGljaXBhbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlcnJvckNhbGxiYWNrICYmIGVycm9yQ2FsbGJhY2soZXJyb3JNZXNzYWdlc1ttZXNzYWdlXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlcnJvckNhbGxiYWNrICYmIGVycm9yQ2FsbGJhY2sobWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHBhcnRpY2lwYXRlID0gYXN5bmMgKFxuICAgIHRhc2s6IElUYXNrLFxuICAgIGJvZHk/OiBhbnksXG4gICAgY2FsbGJhY2s/OiBhbnlcbiAgKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgc2V0SXNQYXJ0aWNpcGF0aW9uTG9hZGluZyh0cnVlKTtcbiAgICBsZXQgZGF0YSA9IHsgLi4uYm9keSB9O1xuICAgIGlmIChib2R5Py5maWxlKSB7XG4gICAgICBjb25zdCBiYXNlNjQgPSBhd2FpdCBmZXRjaChib2R5LmZpbGUpXG4gICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuYmxvYigpKVxuICAgICAgICAudGhlbigoYmxvYikgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIHJlcyhyZWFkZXIucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgZGF0YSA9IHtcbiAgICAgICAgLi4uYm9keSxcbiAgICAgICAgZmlsZToge1xuICAgICAgICAgIGltYWdlU3JjOiBiYXNlNjQsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cbiAgICBhd2FpdCBhcGlcbiAgICAgIC5wb3N0KGB0YXNrcy8ke3Rhc2suaWR9YCwgYm9keSA/IGRhdGEgOiB1bmRlZmluZWQpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgdXBkYXRlVGFza1N0YXR1cyh0YXNrLmlkLCByZXNwb25zZS5kYXRhLnN0YXR1cyk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICByZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gUGFydGljaXBhbnRUYXNrU3RhdHVzLmNvbXBsZXRlZCAmJlxuICAgICAgICAgIHRhc2sucG9pbnRzX3Jld2FyZFxuICAgICAgICApIHtcbiAgICAgICAgICBhZGRQb2ludHModGFzayk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNldElzUGFydGljaXBhdGlvbkxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpc1BhcnRpY2lwYXRpb25Mb2FkaW5nLFxuICAgIHBhcnRpY2lwYXRlLFxuICB9O1xufTtcbiIsImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNhbGxiYWNrLCB1c2VDb250ZXh0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbnRlcmZhY2UgSUNvbmZpZyB7XG4gIGFwaVVybDogc3RyaW5nO1xuICBhcGlLZXk6IHN0cmluZztcbiAgdXNlckF1dGhUb2tlbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xufVxuXG50eXBlIEdhbWVzb2NpYWxTdGF0ZSA9IHtcbiAgYXBpVXJsOiBzdHJpbmc7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhdXRoVG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgc2V0QXV0aFRva2VuOiAodG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IGNvbnRleHQgPSBjcmVhdGVDb250ZXh0PEdhbWVzb2NpYWxTdGF0ZT4oe1xuICBhcGlVcmw6IFwiXCIsXG4gIGFwaUtleTogXCJcIixcbiAgYXV0aFRva2VuOiB1bmRlZmluZWQsXG4gIHNldEF1dGhUb2tlbjogKCkgPT4ge30sXG59KTtcblxuZXhwb3J0IGNvbnN0IHVzZUdhbWVzb2NpYWwgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gR2FtZXNvY2lhbFByb3ZpZGVyKHtcbiAgY2hpbGRyZW4sXG4gIHN0YXRlLFxuICBhcGlLZXksXG4gIGFwaVVybCxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBHYW1lc29jaWFsU3RhdGU7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhcGlVcmw6IHN0cmluZztcbn0pIHtcbiAgc3RhdGUgPz89IHVzZUdhbWVzb2NpYWxTdGF0ZShhcGlLZXksIGFwaVVybCk7XG4gIHJldHVybiA8Y29udGV4dC5Qcm92aWRlciB2YWx1ZT17c3RhdGV9PntjaGlsZHJlbn08L2NvbnRleHQuUHJvdmlkZXI+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlR2FtZXNvY2lhbFN0YXRlID0gKFxuICBhcGlLZXk6IHN0cmluZyxcbiAgYXBpVXJsOiBzdHJpbmdcbik6IEdhbWVzb2NpYWxTdGF0ZSA9PiB7XG4gIGNvbnN0IFtjb25maWcsIHNldENvbmZpZ10gPSB1c2VTdGF0ZTxJQ29uZmlnPih7XG4gICAgYXBpVXJsOiBhcGlVcmwsXG4gICAgYXBpS2V5OiBhcGlLZXksXG4gICAgdXNlckF1dGhUb2tlbjogdW5kZWZpbmVkLFxuICB9KTtcblxuICBjb25zdCBhdXRoVG9rZW4gPSBjb25maWcudXNlckF1dGhUb2tlbjtcblxuICBjb25zdCBzZXRBdXRoVG9rZW4gPSB1c2VDYWxsYmFjaygodG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIHNldENvbmZpZygocHJldikgPT4gKHtcbiAgICAgIC4uLnByZXYsXG4gICAgICB1c2VyQXV0aFRva2VuOiB0b2tlbixcbiAgICB9KSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4ge1xuICAgIGFwaVVybCxcbiAgICBhcGlLZXksXG4gICAgYXV0aFRva2VuLFxuICAgIHNldEF1dGhUb2tlbixcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyB1c2VHYW1lc29jaWFsIH0gZnJvbSBcIkAvcHJvdmlkZXJzL2dhbWVzb2NpYWxcIjtcbmltcG9ydCBheGlvcywgeyBBeGlvc0luc3RhbmNlIH0gZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBjb25zdCB1c2VBcGkgPSAoKTogQXhpb3NJbnN0YW5jZSA9PiB7XG4gIGNvbnN0IHsgYXV0aFRva2VuLCBhcGlVcmwsIGFwaUtleSB9ID0gdXNlR2FtZXNvY2lhbCgpO1xuXG4gIGNvbnN0IGNyZWF0ZUFwaSA9ICgpOiBBeGlvc0luc3RhbmNlID0+IHtcbiAgICBjb25zdCBhcGkgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgYmFzZVVSTDogYXBpVXJsLFxuICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQXBpLUtleVwiOiBhcGlLZXksXG4gICAgICAgIFwiQXBpLVZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBhcGkuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKFxuICAgICAgKGNvbmZpZykgPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhUb2tlbjtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICB9LFxuICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICB9XG4gICAgKTtcblxuICAgIGFwaS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKFxuICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgIH0sXG4gICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgLy8gRW5zdXJlIHRoaXMgcnVucyBvbmx5IGluIHRoZSBicm93c2VyXG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidG9rZW5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gYXBpO1xuICB9O1xuXG4gIGNvbnN0IFthcGksIHNldEFwaV0gPSB1c2VTdGF0ZTxBeGlvc0luc3RhbmNlPihjcmVhdGVBcGkoKSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRBcGkoY3JlYXRlQXBpKCkpO1xuICB9LCBbYXBpVXJsLCBhcGlLZXksIGF1dGhUb2tlbl0pO1xuXG4gIHJldHVybiBhcGk7XG59O1xuIiwiZXhwb3J0IHR5cGUgRXJyb3JNZXNzYWdlcyA9IHtcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGVycm9yTWVzc2FnZXM6IEVycm9yTWVzc2FnZXMgPSB7XG4gIGRpc2NvcmRfbm90X2Nvbm5lY3RlZDogXCJEaXNjb3JkIGFjY291bnQgaXMgbm90IGNvbm5lY3RlZFwiLFxuICBkaXNjb3JkX2d1aWxkX3VzZXJfbm90X2ZvdW5kOiBcIkRpc2NvcmQgdXNlciBub3QgZm91bmQgaW4gY2hhbm5lbCBcIixcbiAgZGlzY29yZF9ndWlsZF9yZXF1aXJlZF9yb2xlX25vdF9leGlzdHM6XG4gICAgXCJEaXNjb3JkIGNoYW5uZWwgdmVyaWZpY2F0aW9uIG11c3QgYmUgcGFzc2VkXCIsXG4gIGRpc2NvcmRfZ3VpbGRfdXNlcl9pc19wZW5kaW5nOlxuICAgIFwiUGxlYXNlIHZhbGlkYXRlIHRoYXQgeW91ciBhY2NlcHRlZCBUZXJtcyBvZiBEaXNjb3JkIGNoYW5uZWxcIixcbiAgZGlzY29yZF91bmF1dGhlbnRpY2F0ZWQ6IFwiUGxlYXNlIHJlLWF1dGhlbnRpY2F0ZSB5b3VyIGRpc2NvcmQgYWNjb3VudFwiLFxuXG4gIHRlbGVncmFtX25vdF9jb25uZWN0ZWQ6IFwiVGVsZWdyYW0gYWNjb3VudCBpcyBub3QgY29ubmVjdGVkXCIsXG4gIHRlbGVncmFtX21lbWJlcl9ub3RfZm91bmQ6IFwiVGVsZWdyYW0gYWNjb3VudCBub3QgZm91bmQgaW4gZ3JvdXBcIixcbiAgdGVsZWdyYW1fdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSByZS1hdXRoZW50aWNhdGUgeW91ciB0ZWxlZ3JhbSBhY2NvdW50XCIsXG5cbiAgdHdpdHRlcl9ub3RfY29ubmVjdGVkOiBcIlggYWNjb3VudCBpcyBub3QgY29ubmVjdGVkXCIsXG4gIHR3aXR0ZXJfZm9sbG93ZXJfbm90X2ZvdW5kOiBcIllvdXIgWCBhY2NvdW50IGRvIG5vdCBmb2xsb3cgcmVxdWlyZWQgYWNjb3VudFwiLFxuICB0d2l0dGVyX3VuYXV0aGVudGljYXRlZDogXCJQbGVhc2UgcmUtYXV0aGVudGljYXRlIHlvdXIgWCBhY2NvdW50XCIsXG5cbiAgeW91dHViZV9pbnZhbGlkX3ZpZGVvX3dhdGNoX2xlbmd0aDogXCJQbGVhc2Ugd2F0Y2ggd2hvbGUgdmlkZW9cIixcblxuICBmaWxlX25vdF9wcm92aWRlZDogXCJGaWxlIG5vdCBwcm92aWRlZFwiLFxuICBmaWxlX3NpemVfZXhjZWVkczogXCJGaWxlIHNpemUgZXhjZWVkcyBsaW1pdFwiLFxuICBpbnZhbGlkX2ZpbGVfdHlwZTogXCJJbnZhbGlkIGZpbGUgdHlwZVwiLFxuXG4gIG1pc3Npb25fbm90X2ZvdW5kOiBcIk1pc3Npb24gbm90IGZvdW5kXCIsXG4gIG1pc3Npb25fbm90X3N0YXJ0ZWQ6IFwiTWlzc2lvbiBub3Qgc3RhcnRlZFwiLFxuICBtaXNzaW9uX2VuZGVkOiBcIk1pc3Npb24gZW5kZWRcIixcblxuICB0YXNrX25vdF9mb3VuZDogXCJUYXNrIG5vdCBmb3VuZFwiLFxuICB0YXNrX2luYWN0aXZlOiBcIlRhc2sgaW5hY3RpdmVcIixcblxuICBwYXJ0aWNpcGFudF9ub3RfZm91bmQ6IFwiUGFydGljaXBhbnQgbm90IGZvdW5kXCIsXG5cbiAgdGhpcmRfcGFydHlfdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSByZS1hdXRoZW50aWNhdGUgeW91ciBhY2NvdW50XCIsXG5cbiAgaW52YWxpZF9lbWFpbDogXCJJbnZhbGlkIGVtYWlsIGFkZHJlc3NcIixcbiAgaW52YWxpZF92YWx1ZTogXCJJbnZhbGlkIHZhbHVlXCIsXG4gIGludmFsaWRfY2FwdGNoYTogXCJJbnZhbGlkIGNhcHRjaGFcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzaG91bGRSZWZldGNoUGFydGljaXBhbnQgPSAoZXJyb3I6IHN0cmluZykgPT4ge1xuICByZXR1cm4gKFxuICAgIGVycm9yID09PSBlcnJvck1lc3NhZ2VzLmRpc2NvcmRfdW5hdXRoZW50aWNhdGVkIHx8XG4gICAgZXJyb3IgPT09IGVycm9yTWVzc2FnZXMudGVsZWdyYW1fdW5hdXRoZW50aWNhdGVkIHx8XG4gICAgZXJyb3IgPT09IGVycm9yTWVzc2FnZXMudHdpdHRlcl91bmF1dGhlbnRpY2F0ZWRcbiAgKTtcbn07XG4iLCJpbXBvcnQgeyB1c2VBcGkgfSBmcm9tIFwiQC9ob29rcy91c2VBcGlcIjtcbmltcG9ydCB7IFBhcnRpY2lwYW50VGFza1N0YXR1cyB9IGZyb20gXCJAL21vZGVscy9lbnVtcy9wYXJ0aWNpcGFudHMuZW51bVwiO1xuaW1wb3J0IHsgSU1pc3Npb24gfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy9taXNzaW9uXCI7XG5pbXBvcnQgeyBJVGFzayB9IGZyb20gXCJAL21vZGVscy9pbnRlcmZhY2VzL3Rhc2tcIjtcbmltcG9ydCB7XG4gIGNyZWF0ZUNvbnRleHQsXG4gIHVzZUNhbGxiYWNrLFxuICB1c2VDb250ZXh0LFxuICB1c2VFZmZlY3QsXG4gIHVzZVN0YXRlLFxufSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IFRhc2tUeXBlIH0gZnJvbSBcIi4uXCI7XG5pbXBvcnQgeyB1c2VHYW1lc29jaWFsIH0gZnJvbSBcIi4vZ2FtZXNvY2lhbFwiO1xuXG50eXBlIE1pc3Npb25zU3RhdGUgPSB7XG4gIG1pc3Npb25zOiBJTWlzc2lvbltdO1xuICB0YXNrczogSVRhc2tbXTtcbiAgZ2V0VGFza3NGb3JNaXNzaW9uOiAobWlzc2lvbklkOiBzdHJpbmcpID0+IElUYXNrW107XG4gIHVwZGF0ZVRhc2tTdGF0dXM6ICh0YXNrSWQ6IHN0cmluZywgc3RhdHVzOiBQYXJ0aWNpcGFudFRhc2tTdGF0dXMpID0+IHZvaWQ7XG4gIG1haW50ZW5hbmNlOiBib29sZWFuO1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8TWlzc2lvbnNTdGF0ZT4oe1xuICBtaXNzaW9uczogW10sXG4gIHRhc2tzOiBbXSxcbiAgZ2V0VGFza3NGb3JNaXNzaW9uOiAoKSA9PiBbXSxcbiAgdXBkYXRlVGFza1N0YXR1czogKCkgPT4ge30sXG4gIG1haW50ZW5hbmNlOiBmYWxzZSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlTWlzc2lvbnMgPSAoKSA9PiB1c2VDb250ZXh0KGNvbnRleHQpO1xuXG5leHBvcnQgZnVuY3Rpb24gTWlzc2lvbnNQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdGF0ZSxcbn06IHtcbiAgY2hpbGRyZW46IGFueTtcbiAgc3RhdGU/OiBNaXNzaW9uc1N0YXRlO1xufSkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvcnVsZXMtb2YtaG9va3NcbiAgc3RhdGUgPz89IHVzZU1pc3Npb25zU3RhdGUoKTtcbiAgcmV0dXJuIDxjb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzdGF0ZX0+e2NoaWxkcmVufTwvY29udGV4dC5Qcm92aWRlcj47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VNaXNzaW9uc1N0YXRlID0gKCk6IE1pc3Npb25zU3RhdGUgPT4ge1xuICBjb25zdCBbbWlzc2lvbnMsIHNldE1pc3Npb25zXSA9IHVzZVN0YXRlPElNaXNzaW9uW10+KFtdKTtcbiAgY29uc3QgW3Rhc2tzLCBzZXRUYXNrc10gPSB1c2VTdGF0ZTxJVGFza1tdPihbXSk7XG4gIGNvbnN0IHsgYXV0aFRva2VuIH0gPSB1c2VHYW1lc29jaWFsKCk7XG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIGNvbnN0IFttYWludGVuYW5jZSwgc2V0TWFpbnRlbmFuY2VdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZ2V0TWlzc2lvbnMoKTtcbiAgfSwgW2F1dGhUb2tlbl0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG1pc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGdldFRhc2tzKG1pc3Npb25zLm1hcCgobSkgPT4gbS5pZCkpO1xuICAgIH1cbiAgfSwgW21pc3Npb25zXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoYXV0aFRva2VuICYmIGF1dGhUb2tlbi5sZW5ndGggPT09IDApIHtcbiAgICAgIHNldE1haW50ZW5hbmNlKHRydWUpO1xuICAgIH1cbiAgfSwgW2F1dGhUb2tlbl0pO1xuXG4gIGNvbnN0IGdldE1pc3Npb25zID0gKCkgPT4ge1xuICAgIGFwaVxuICAgICAgLmdldChcIm1pc3Npb25zXCIpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgc2V0TWlzc2lvbnMocmVzcG9uc2UuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2V0TWFpbnRlbmFuY2UodHJ1ZSk7XG4gICAgICB9KVxuXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGFsd2F5cyBleGVjdXRlZFxuICAgICAgfSk7XG4gIH07XG5cbiAgY29uc3QgZ2V0VGFza3MgPSAobWlzc2lvbklkczogc3RyaW5nW10pID0+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IG1pc3Npb25JZHMubWFwKChpZCkgPT4gYXBpLmdldChgbWlzc2lvbnMvJHtpZH0vdGFza3NgKSk7XG4gICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2VzKSB7XG4gICAgICAgIGNvbnN0IHZhbGlkVHlwZXMgPSBuZXcgU2V0KE9iamVjdC52YWx1ZXMoVGFza1R5cGUpKTtcbiAgICAgICAgY29uc3QgdGFza3MgPSByZXNwb25zZXNcbiAgICAgICAgICAubWFwKChyKSA9PiByLmRhdGEpXG4gICAgICAgICAgLmZsYXQoKVxuICAgICAgICAgIC5maWx0ZXIoKHQpID0+IHZhbGlkVHlwZXMuaGFzKHQudHlwZSkpO1xuICAgICAgICBzZXRUYXNrcyh0YXNrcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2V0TWFpbnRlbmFuY2UodHJ1ZSk7XG4gICAgICB9KTtcbiAgfTtcblxuICBjb25zdCB1cGRhdGVUYXNrU3RhdHVzID0gKHRhc2tJZDogc3RyaW5nLCBzdGF0dXM6IFBhcnRpY2lwYW50VGFza1N0YXR1cykgPT4ge1xuICAgIHNldFRhc2tzKFxuICAgICAgdGFza3MubWFwKCh0YXNrKSA9PlxuICAgICAgICB0YXNrLmlkID09PSB0YXNrSWQgPyB7IC4uLnRhc2ssIHBhcnRpY2lwYXRpb246IHsgc3RhdHVzIH0gfSA6IHRhc2tcbiAgICAgIClcbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IGdldFRhc2tzRm9yTWlzc2lvbiA9IHVzZUNhbGxiYWNrKFxuICAgIChtaXNzaW9uSWQ6IHN0cmluZykgPT4ge1xuICAgICAgcmV0dXJuIHRhc2tzLmZpbHRlcigodCkgPT4gdC5taXNzaW9uX2lkID09PSBtaXNzaW9uSWQpO1xuICAgIH0sXG4gICAgW3Rhc2tzXVxuICApO1xuXG4gIHJldHVybiB7XG4gICAgbWlzc2lvbnMsXG4gICAgdGFza3MsXG4gICAgZ2V0VGFza3NGb3JNaXNzaW9uLFxuICAgIHVwZGF0ZVRhc2tTdGF0dXMsXG4gICAgbWFpbnRlbmFuY2UsXG4gIH07XG59O1xuIiwiaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbXBvcnQgeyB1c2VBcGkgfSBmcm9tIFwiQC9ob29rcy91c2VBcGlcIjtcbmltcG9ydCB7IFRhc2tSZXdhcmRUeXBlIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3Rhc2tfcmV3YXJkX3R5cGUuZW51bVwiO1xuaW1wb3J0IHsgSVRhc2sgfSBmcm9tIFwiQC9tb2RlbHMvaW50ZXJmYWNlcy90YXNrXCI7XG5pbXBvcnQgeyBUaGlyZFBhcnR5UHJvdmlkZXIgfSBmcm9tIFwiLi4vbW9kZWxzL2VudW1zL3RoaXJkX3BhcnR5LmVudW1cIjtcbmltcG9ydCB7IElQYXJ0aWNpcGFudCB9IGZyb20gXCIuLi9tb2RlbHMvaW50ZXJmYWNlcy9wYXJ0aWNpcGFudFwiO1xuaW1wb3J0IHsgdXNlR2FtZXNvY2lhbCB9IGZyb20gXCIuL2dhbWVzb2NpYWxcIjtcblxudHlwZSBQYXJ0aWNpcGFudFN0YXRlID0ge1xuICBwYXJ0aWNpcGFudD86IElQYXJ0aWNpcGFudDtcbiAgaXNUaGlyZFBhcnR5QXV0aGVudGljYXRlZDogKHRoaXJkUGFydHk6IFRoaXJkUGFydHlQcm92aWRlcikgPT4gYm9vbGVhbjtcbiAgYWRkUG9pbnRzOiAodGFzazogSVRhc2spID0+IHZvaWQ7XG4gIGdldFBhcnRpY2lwYW50OiAoKSA9PiB2b2lkO1xufTtcblxuY29uc3QgY29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8UGFydGljaXBhbnRTdGF0ZT4oe1xuICBwYXJ0aWNpcGFudDogdW5kZWZpbmVkLFxuICBpc1RoaXJkUGFydHlBdXRoZW50aWNhdGVkOiAoKSA9PiBmYWxzZSxcbiAgYWRkUG9pbnRzOiAoKSA9PiB7fSxcbiAgZ2V0UGFydGljaXBhbnQ6ICgpID0+IHt9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VQYXJ0aWNpcGFudCA9ICgpID0+IHVzZUNvbnRleHQoY29udGV4dCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBQYXJ0aWNpcGFudFByb3ZpZGVyKHtcbiAgY2hpbGRyZW4sXG4gIHN0YXRlLFxuICBlcnJvckNhbGxiYWNrLFxufToge1xuICBjaGlsZHJlbjogYW55O1xuICBzdGF0ZT86IFBhcnRpY2lwYW50U3RhdGU7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbn0pIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHN0YXRlID8/PSB1c2VQYXJ0aWNpcGFudFN0YXRlKGVycm9yQ2FsbGJhY2spO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVBhcnRpY2lwYW50U3RhdGUgPSAoXG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZFxuKTogUGFydGljaXBhbnRTdGF0ZSA9PiB7XG4gIGNvbnN0IFtwYXJ0aWNpcGFudCwgc2V0UGFydGljaXBhbnRdID0gdXNlU3RhdGU8SVBhcnRpY2lwYW50PigpO1xuICBjb25zdCB7IGF1dGhUb2tlbiB9ID0gdXNlR2FtZXNvY2lhbCgpO1xuXG4gIGNvbnN0IGFwaSA9IHVzZUFwaSgpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGF1dGhUb2tlbikge1xuICAgICAgZ2V0UGFydGljaXBhbnQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0UGFydGljaXBhbnQodW5kZWZpbmVkKTtcbiAgICB9XG4gIH0sIFthdXRoVG9rZW5dKTtcblxuICBjb25zdCBnZXRQYXJ0aWNpcGFudCA9ICgpID0+IHtcbiAgICBhcGlcbiAgICAgIC5nZXQoYHBhcnRpY2lwYW50cy9tZWApXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgc2V0UGFydGljaXBhbnQocmVzcG9uc2UuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBlcnJvckNhbGxiYWNrICYmIGVycm9yQ2FsbGJhY2soZXJyb3IpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgY29uc3QgaXNUaGlyZFBhcnR5QXV0aGVudGljYXRlZCA9IChcbiAgICB0aGlyZFBhcnR5OiBUaGlyZFBhcnR5UHJvdmlkZXJcbiAgKTogYm9vbGVhbiA9PiB7XG4gICAgcmV0dXJuICEhcGFydGljaXBhbnQ/LmF1dGhlbnRpY2F0ZWQuaW5jbHVkZXModGhpcmRQYXJ0eSk7XG4gIH07XG5cbiAgY29uc3QgYWRkUG9pbnRzID0gKHRhc2s6IElUYXNrKSA9PiB7XG4gICAgaWYgKCF0YXNrLnBvaW50c19yZXdhcmQpIHJldHVybjtcblxuICAgIHNldFBhcnRpY2lwYW50KChwcmV2KSA9PiB7XG4gICAgICBpZiAoIXByZXYpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBpZiAodGFzay5yZXdhcmRfdHlwZSA9PT0gVGFza1Jld2FyZFR5cGUucG9pbnRzKSB7XG4gICAgICAgIGNvbnN0IHBvaW50cyA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgdGFzay5wb2ludHNfcmV3YXJkISAqIChwYXJ0aWNpcGFudD8ucG9pbnRzX211bHRpcGxpZXIgPz8gMSlcbiAgICAgICAgKTtcbiAgICAgICAgc2V0UGFydGljaXBhbnQoKHByZXYpID0+IHtcbiAgICAgICAgICBpZiAoIXByZXYpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAgICBwb2ludHM6IHByZXY/LnBvaW50cyArIHBvaW50cyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFBhcnRpY2lwYW50KChwcmV2KSA9PiB7XG4gICAgICAgICAgaWYgKCFwcmV2KSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgICAgcG9pbnRzX211bHRpcGxpZXI6IHByZXY/LnBvaW50c19tdWx0aXBsaWVyICsgdGFzay5wb2ludHNfcmV3YXJkISxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHBhcnRpY2lwYW50LFxuICAgIGlzVGhpcmRQYXJ0eUF1dGhlbnRpY2F0ZWQsXG4gICAgYWRkUG9pbnRzLFxuICAgIGdldFBhcnRpY2lwYW50LFxuICB9O1xufTtcbiIsImV4cG9ydCBlbnVtIFRhc2tSZXdhcmRUeXBlIHtcbiAgcG9pbnRzID0gXCJwb2ludHNcIixcbiAgbXVsdGlwbGllciA9IFwibXVsdGlwbGllclwiLFxufVxuIiwiZXhwb3J0IGVudW0gVGhpcmRQYXJ0eVByb3ZpZGVyIHtcbiAgdHdpdHRlciA9IFwidHdpdHRlclwiLFxuICB0ZWxlZ3JhbSA9IFwidGVsZWdyYW1cIixcbiAgZGlzY29yZCA9IFwiZGlzY29yZFwiLFxufVxuIiwiZXhwb3J0IGNvbnN0IGdldEN1cnJlbnRIcmVmV2l0aG91dFF1ZXJ5UGFyYW1zID0gKCkgPT4ge1xuICAvLyBDcmVhdGUgYSBuZXcgVVJMIG9iamVjdCBiYXNlZCBvbiB3aW5kb3cubG9jYXRpb25cbiAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgLy8gU2V0IHRoZSBzZWFyY2ggKHF1ZXJ5IHBhcmFtZXRlcnMpIHRvIGFuIGVtcHR5IHN0cmluZyB0byByZW1vdmUgaXRcbiAgdXJsLnNlYXJjaCA9IFwiXCI7XG5cbiAgLy8gUmV0dXJuIHRoZSBocmVmIHdpdGhvdXQgcXVlcnkgcGFyYW1ldGVyc1xuICByZXR1cm4gdXJsLmhyZWY7XG59O1xuIiwiaW1wb3J0IHsgdXNlQXBpIH0gZnJvbSBcIkAvaG9va3MvdXNlQXBpXCI7XG5pbXBvcnQgeyBUaGlyZFBhcnR5UHJvdmlkZXIgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvdGhpcmRfcGFydHkuZW51bVwiO1xuaW1wb3J0IHsgZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMgfSBmcm9tIFwiQC91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlUGFydGljaXBhbnQgfSBmcm9tIFwiLi9wYXJ0aWNpcGFudFwiO1xuXG50eXBlIFByb3ZpZGVyU3RhdHVzID0ge1xuICBba2V5IGluIFRoaXJkUGFydHlQcm92aWRlcl06IGJvb2xlYW47XG59O1xuXG5jb25zdCBkZWZhdWx0UHJvdmlkZXJTdGF0dXM6IFByb3ZpZGVyU3RhdHVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICBPYmplY3QudmFsdWVzKFRoaXJkUGFydHlQcm92aWRlcikubWFwKChwcm92aWRlcikgPT4gW3Byb3ZpZGVyLCBmYWxzZV0pXG4pIGFzIFByb3ZpZGVyU3RhdHVzO1xuXG50eXBlIFRoaXJkUGFydHlBdXRoU3RhdGUgPSB7XG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbiAgYXV0aGVudGljYXRlZDogUHJvdmlkZXJTdGF0dXM7XG4gIGF1dGhlbnRpY2F0ZTogKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IHZvaWQ7XG4gIGlzQXV0aGVudGljYXRlZDogKHByb3ZpZGVyOiBUaGlyZFBhcnR5UHJvdmlkZXIpID0+IGJvb2xlYW47XG59O1xuXG5jb25zdCBjb250ZXh0ID0gY3JlYXRlQ29udGV4dDxUaGlyZFBhcnR5QXV0aFN0YXRlPih7XG4gIGlzTG9hZGluZzogZmFsc2UsXG4gIGF1dGhlbnRpY2F0ZWQ6IGRlZmF1bHRQcm92aWRlclN0YXR1cyxcbiAgYXV0aGVudGljYXRlOiAoKSA9PiAoe30pLFxuICBpc0F1dGhlbnRpY2F0ZWQ6ICgpID0+IGZhbHNlLFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VUaGlyZFBhcnR5QXV0aCA9ICgpID0+IHVzZUNvbnRleHQoY29udGV4dCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBUaGlyZFBhcnR5QXV0aFByb3ZpZGVyKHtcbiAgY2hpbGRyZW4sXG4gIHN0YXRlLFxuICBlcnJvckNhbGxiYWNrLFxufToge1xuICBjaGlsZHJlbjogYW55O1xuICBzdGF0ZT86IFRoaXJkUGFydHlBdXRoU3RhdGU7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbn0pIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHN0YXRlID8/PSB1c2VUaGlyZFBhcnR5QXV0aFN0YXRlKGVycm9yQ2FsbGJhY2spO1xuICByZXR1cm4gPGNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9jb250ZXh0LlByb3ZpZGVyPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVRoaXJkUGFydHlBdXRoU3RhdGUgPSAoXG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZFxuKTogVGhpcmRQYXJ0eUF1dGhTdGF0ZSA9PiB7XG4gIGNvbnN0IFthdXRoZW50aWNhdGVkLCBzZXRBdXRoZW50aWNhdGVkXSA9IHVzZVN0YXRlPFByb3ZpZGVyU3RhdHVzPihcbiAgICBkZWZhdWx0UHJvdmlkZXJTdGF0dXNcbiAgKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgeyBwYXJ0aWNpcGFudCB9ID0gdXNlUGFydGljaXBhbnQoKTtcbiAgY29uc3QgYXBpID0gdXNlQXBpKCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBuZXdTdGF0dXM6IFByb3ZpZGVyU3RhdHVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgT2JqZWN0LnZhbHVlcyhUaGlyZFBhcnR5UHJvdmlkZXIpLm1hcCgocHJvdmlkZXIpID0+IFtcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICEhcGFydGljaXBhbnQ/LmF1dGhlbnRpY2F0ZWQuaW5jbHVkZXMocHJvdmlkZXIpLFxuICAgICAgXSlcbiAgICApIGFzIFByb3ZpZGVyU3RhdHVzO1xuXG4gICAgc2V0QXV0aGVudGljYXRlZChuZXdTdGF0dXMpO1xuICB9LCBbcGFydGljaXBhbnRdKTtcblxuICBjb25zdCBpc0F1dGhlbnRpY2F0ZWQgPSAocHJvdmlkZXI6IFRoaXJkUGFydHlQcm92aWRlcik6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiBhdXRoZW50aWNhdGVkW3Byb3ZpZGVyXSB8fCBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBhdXRoZW50aWNhdGUgPSAocHJvdmlkZXI6IFRoaXJkUGFydHlQcm92aWRlcik6IHZvaWQgPT4ge1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5nZXQoYGF1dGgvJHtwcm92aWRlcn1gLCB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHJlZGlyZWN0X3VybDogZ2V0Q3VycmVudEhyZWZXaXRob3V0UXVlcnlQYXJhbXMoKSxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEudXJsKSB7XG4gICAgICAgICAgLy9jaGVjayBpZiB0aGVyZSBpcyBhbiBlcnJvciBpbiBxdWVyeSBwYXJhbXNcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS51cmwuaW5jbHVkZXMoXCI/ZXJyb3I9XCIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgIFwiRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZSB3aXRoIFRoaXJkUGFydHlBdXRoOiBcIiArXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS51cmwuc3BsaXQoXCI/ZXJyb3I9XCIpWzFdXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmVzcG9uc2UuZGF0YS51cmw7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBlcnJvckNhbGxiYWNrICYmIGVycm9yQ2FsbGJhY2soZXJyb3IpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaXNMb2FkaW5nLFxuICAgIGF1dGhlbnRpY2F0ZWQsXG4gICAgYXV0aGVudGljYXRlLFxuICAgIGlzQXV0aGVudGljYXRlZCxcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyBQYXJ0aWNpcGFudFRhc2tTdGF0dXMgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvcGFydGljaXBhbnRzLmVudW1cIjtcbmltcG9ydCB7IFRhc2tCdXR0b25UeXBlIH0gZnJvbSBcIkAvbW9kZWxzL2VudW1zL3Rhc2tfYnV0dG9uX3R5cGUuZW51bVwiO1xuaW1wb3J0IHsgVGFza1R5cGUgfSBmcm9tIFwiQC9tb2RlbHMvZW51bXMvdGFza3MuZW51bVwiO1xuaW1wb3J0IHtcbiAgSURpc2NvcmRKb2luTWV0YWRhdGEsXG4gIElPcGVuVXJsTWV0YWRhdGEsXG4gIElUYXNrLFxuICBJVGVsZWdyYW1Kb2luTWV0YWRhdGEsXG4gIElUd2l0Y2hGb2xsb3dNZXRhZGF0YSxcbiAgSVR3aXR0ZXJGb2xsb3dNZXRhZGF0YSxcbiAgSVR3aXR0ZXJMaWtlTWV0YWRhdGEsXG4gIElUd2l0dGVyUmVwbHlNZXRhZGF0YSxcbiAgSVR3aXR0ZXJSZXBvc3RNZXRhZGF0YSxcbiAgSVlvdXR1YmVTdWJzY3JpYmVNZXRhZGF0YSxcbiAgSVlvdXR1YmVWaWV3TWV0YWRhdGEsXG59IGZyb20gXCJAL21vZGVscy9pbnRlcmZhY2VzL3Rhc2tcIjtcbmltcG9ydCB7IFRhc2tQcm92aWRlciwgdXNlVGFzayB9IGZyb20gXCJAL3Byb3ZpZGVycy90YXNrXCI7XG5pbXBvcnQge1xuICBUaGlyZFBhcnR5QXV0aFByb3ZpZGVyLFxuICB1c2VUaGlyZFBhcnR5QXV0aCxcbn0gZnJvbSBcIkAvcHJvdmlkZXJzL3RoaXJkX3BhcnR5X2F1dGhcIjtcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBUaGlyZFBhcnR5UHJvdmlkZXIgfSBmcm9tIFwiLi5cIjtcblxuaW50ZXJmYWNlIFRhc2tDYWxsYmFja3Mge1xuICBvbllvdXR1YmVWaWV3OiAodGFzazogSVRhc2ssIHZpZGVvSWQ6IHN0cmluZykgPT4gUHJvbWlzZTxudW1iZXI+O1xuICBvbkZpbGVVcGxvYWQ6ICh0YXNrOiBJVGFzaykgPT4gUHJvbWlzZTxzdHJpbmc+O1xuICBvblN1Ym1pdFN0cmluZzogKHRhc2s6IElUYXNrKSA9PiBQcm9taXNlPHN0cmluZz47XG59XG5cbnR5cGUgUHJvcHMgPSB7XG4gIHRhc2s6IElUYXNrO1xuICBwYXJ0aWNpcGF0aW9uRGlzYWJsZWQ6IGJvb2xlYW47XG4gIG1haW50ZW5hbmNlOiBib29sZWFuO1xuICBjaGlsZHJlbjogKHByb3BzOiB7XG4gICAgb25DbGljaz86IChlOiBSZWFjdC5Nb3VzZUV2ZW50PEhUTUxCdXR0b25FbGVtZW50LCBNb3VzZUV2ZW50PikgPT4gdm9pZDtcbiAgICB0eXBlOiBUYXNrQnV0dG9uVHlwZTtcbiAgICBpc0xvYWRpbmc/OiBib29sZWFuO1xuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgICBjb21tZW50OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkO1xuICB9KSA9PiBSZWFjdC5SZWFjdEVsZW1lbnQ7XG4gIGNhbGxiYWNrczogVGFza0NhbGxiYWNrcztcbiAgZXJyb3JDYWxsYmFjaz86IChlcnJvcjogYW55KSA9PiB2b2lkO1xuICBvblN1Y2Nlc3M/OiAoKSA9PiB2b2lkO1xufTtcblxuY29uc3QgVGFza1dyYXBwZXJCYXNlOiBSZWFjdC5GQzxQcm9wcz4gPSAocHJvcHM6IFByb3BzKSA9PiB7XG4gIGNvbnN0IHtcbiAgICB0YXNrLFxuICAgIHBhcnRpY2lwYXRpb25EaXNhYmxlZCxcbiAgICBtYWludGVuYW5jZSxcbiAgICBjaGlsZHJlbixcbiAgICBjYWxsYmFja3MsXG4gICAgb25TdWNjZXNzLFxuICB9ID0gcHJvcHM7XG4gIGNvbnN0IFtsaW5rQ2xpY2tlZCwgc2V0TGlua0NsaWNrZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIGNvbnN0IHsgcGFydGljaXBhdGUsIGlzUGFydGljaXBhdGlvbkxvYWRpbmcgfSA9IHVzZVRhc2soKTtcblxuICBjb25zdCB0aGlyZFBhcnR5QXV0aCA9IHVzZVRoaXJkUGFydHlBdXRoKCk7XG5cbiAgY29uc3QgY29tcGxldGVkID1cbiAgICB0YXNrLnBhcnRpY2lwYXRpb24gJiZcbiAgICB0YXNrLnBhcnRpY2lwYXRpb24uc3RhdHVzID09PSBQYXJ0aWNpcGFudFRhc2tTdGF0dXMuY29tcGxldGVkO1xuXG4gIGNvbnN0IG9uTGlua0NsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgIHN3aXRjaCAodGFzay50eXBlKSB7XG4gICAgICBjYXNlIFRhc2tUeXBlLmRpc2NvcmRfam9pbjpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSURpc2NvcmRKb2luTWV0YWRhdGEpLmludml0ZV91cmwsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9mb2xsb3c6XG4gICAgICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgIGBodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9mb2xsb3c/c2NyZWVuX25hbWU9JHtcbiAgICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElUd2l0dGVyRm9sbG93TWV0YWRhdGEpLnVzZXJuYW1lXG4gICAgICAgICAgfWAsXG4gICAgICAgICAgXCJfYmxhbmtcIlxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9saWtlOlxuICAgICAgICB3aW5kb3cub3BlbigodGFzay5tZXRhZGF0YSBhcyBJVHdpdHRlckxpa2VNZXRhZGF0YSkucG9zdF91cmwsIFwiX2JsYW5rXCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBseTpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVR3aXR0ZXJSZXBseU1ldGFkYXRhKS5wb3N0X3VybCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcG9zdDpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgYGh0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L3JldHdlZXQ/dHdlZXRfaWQ9JHtcbiAgICAgICAgICAgICh0YXNrLm1ldGFkYXRhIGFzIElUd2l0dGVyUmVwb3N0TWV0YWRhdGEpLnBvc3RfaWRcbiAgICAgICAgICB9YCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS50ZWxlZ3JhbV9qb2luOlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICBgaHR0cHM6Ly90Lm1lLyR7KHRhc2subWV0YWRhdGEgYXMgSVRlbGVncmFtSm9pbk1ldGFkYXRhKS51c2VybmFtZX1gLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLmltYWdlX3VwbG9hZDpcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IGNhbGxiYWNrcy5vbkZpbGVVcGxvYWQodGFzayk7XG4gICAgICAgIG9uUGFydGljaXBhdGUoe1xuICAgICAgICAgIGZpbGUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICBjYXNlIFRhc2tUeXBlLnN1Ym1pdF9zdHJpbmc6XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgY2FsbGJhY2tzLm9uU3VibWl0U3RyaW5nKHRhc2spO1xuICAgICAgICBvblBhcnRpY2lwYXRlKHtcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIGNhc2UgVGFza1R5cGUub3Blbl91cmw6XG4gICAgICAgIHdpbmRvdy5vcGVuKCh0YXNrLm1ldGFkYXRhIGFzIElPcGVuVXJsTWV0YWRhdGEpLnVybCwgXCJfYmxhbmtcIik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUYXNrVHlwZS55b3V0dWJlX3ZpZXc6XG4gICAgICAgIGNvbnN0IHNlY29uZHNXYXRjaGVkID0gYXdhaXQgY2FsbGJhY2tzLm9uWW91dHViZVZpZXcoXG4gICAgICAgICAgdGFzayxcbiAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJWW91dHViZVZpZXdNZXRhZGF0YSkudmlkZW9faWRcbiAgICAgICAgKTtcbiAgICAgICAgb25QYXJ0aWNpcGF0ZSh7XG4gICAgICAgICAgc2Vjb25kczogc2Vjb25kc1dhdGNoZWQsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICBjYXNlIFRhc2tUeXBlLmRhaWx5X2xvZ2luOlxuICAgICAgICBvblBhcnRpY2lwYXRlKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdGNoX2ZvbGxvdzpcbiAgICAgICAgd2luZG93Lm9wZW4oXG4gICAgICAgICAgKHRhc2subWV0YWRhdGEgYXMgSVR3aXRjaEZvbGxvd01ldGFkYXRhKS50d2l0Y2hfdXJsLFxuICAgICAgICAgIFwiX2JsYW5rXCJcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tUeXBlLnlvdXR1YmVfc3Vic2NyaWJlOlxuICAgICAgICB3aW5kb3cub3BlbihcbiAgICAgICAgICAodGFzay5tZXRhZGF0YSBhcyBJWW91dHViZVN1YnNjcmliZU1ldGFkYXRhKS5jaGFubmVsX3VybCxcbiAgICAgICAgICBcIl9ibGFua1wiXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHNldExpbmtDbGlja2VkKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGlzQXV0aGVudGljYXRlZCA9ICgpID0+IHtcbiAgICBzd2l0Y2ggKHRhc2sudHlwZSkge1xuICAgICAgY2FzZSBUYXNrVHlwZS5kaXNjb3JkX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLmRpc2NvcmRfam9pbjpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmlzQXV0aGVudGljYXRlZChUaGlyZFBhcnR5UHJvdmlkZXIuZGlzY29yZCk7XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9mb2xsb3c6XG4gICAgICBjYXNlIFRhc2tUeXBlLnR3aXR0ZXJfbGlrZTpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBseTpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9yZXBvc3Q6XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5pc0F1dGhlbnRpY2F0ZWQoVGhpcmRQYXJ0eVByb3ZpZGVyLnR3aXR0ZXIpO1xuICAgICAgY2FzZSBUYXNrVHlwZS50ZWxlZ3JhbV9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS50ZWxlZ3JhbV9qb2luOlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguaXNBdXRoZW50aWNhdGVkKFRoaXJkUGFydHlQcm92aWRlci50ZWxlZ3JhbSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgYXV0aGVudGljYXRlID0gKCkgPT4ge1xuICAgIHN3aXRjaCAodGFzay50eXBlKSB7XG4gICAgICBjYXNlIFRhc2tUeXBlLmRpc2NvcmRfY29ubmVjdDpcbiAgICAgIGNhc2UgVGFza1R5cGUuZGlzY29yZF9qb2luOlxuICAgICAgICByZXR1cm4gdGhpcmRQYXJ0eUF1dGguYXV0aGVudGljYXRlKFRoaXJkUGFydHlQcm92aWRlci5kaXNjb3JkKTtcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9jb25uZWN0OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX2ZvbGxvdzpcbiAgICAgIGNhc2UgVGFza1R5cGUudHdpdHRlcl9saWtlOlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcGx5OlxuICAgICAgY2FzZSBUYXNrVHlwZS50d2l0dGVyX3JlcG9zdDpcbiAgICAgICAgcmV0dXJuIHRoaXJkUGFydHlBdXRoLmF1dGhlbnRpY2F0ZShUaGlyZFBhcnR5UHJvdmlkZXIudHdpdHRlcik7XG4gICAgICBjYXNlIFRhc2tUeXBlLnRlbGVncmFtX2Nvbm5lY3Q6XG4gICAgICBjYXNlIFRhc2tUeXBlLnRlbGVncmFtX2pvaW46XG4gICAgICAgIHJldHVybiB0aGlyZFBhcnR5QXV0aC5hdXRoZW50aWNhdGUoVGhpcmRQYXJ0eVByb3ZpZGVyLnRlbGVncmFtKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgb25QYXJ0aWNpcGF0ZSA9IGFzeW5jIChib2R5PzogYW55KSA9PiB7XG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IHBhcnRpY2lwYXRlKHRhc2ssIGJvZHksIG9uU3VjY2Vzcyk7XG4gICAgaWYgKCFyZXNwKSB7XG4gICAgICBzZXRMaW5rQ2xpY2tlZChmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUNsaWNrID0gKCkgPT4ge1xuICAgIGlmIChwYXJ0aWNpcGF0aW9uRGlzYWJsZWQgfHwgbWFpbnRlbmFuY2UgfHwgY29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmICghaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgIGF1dGhlbnRpY2F0ZSgpO1xuICAgIH0gZWxzZSBpZiAobGlua0NsaWNrZWQpIHtcbiAgICAgIG9uUGFydGljaXBhdGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb25MaW5rQ2xpY2soKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZ2V0VHlwZSA9ICgpID0+IHtcbiAgICBpZiAoY29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuQ09NUExFVEVEO1xuICAgIH1cblxuICAgIGlmICghdGFzay5wYXJ0aWNpcGF0aW9uKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuTk9fUEFSVElDSVBBTlQ7XG4gICAgfVxuXG4gICAgaWYgKHRhc2sucGFydGljaXBhdGlvbj8uc3RhdHVzID09PSBQYXJ0aWNpcGFudFRhc2tTdGF0dXMucGVuZGluZykge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLlBFTkRJTkc7XG4gICAgfVxuXG4gICAgaWYgKHRhc2sucGFydGljaXBhdGlvbj8uc3RhdHVzID09PSBQYXJ0aWNpcGFudFRhc2tTdGF0dXMuZmFpbGVkKSB7XG4gICAgICByZXR1cm4gVGFza0J1dHRvblR5cGUuRkFJTEVEO1xuICAgIH1cblxuICAgIGlmIChsaW5rQ2xpY2tlZCkge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLkNMQUlNO1xuICAgIH1cblxuICAgIGlmIChpc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgcmV0dXJuIFRhc2tCdXR0b25UeXBlLlNUQVJUO1xuICAgIH1cblxuICAgIHJldHVybiBUYXNrQnV0dG9uVHlwZS5BVVRIX1JFUVVJUkVEO1xuICB9O1xuXG4gIGNvbnN0IG5vT25DbGljayA9ICgpID0+IHtcbiAgICBpZiAoY29tcGxldGVkIHx8IG1haW50ZW5hbmNlIHx8IHBhcnRpY2lwYXRpb25EaXNhYmxlZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHRhc2sudHlwZSA9PT0gVGFza1R5cGUubWFudWFsIHx8XG4gICAgICB0YXNrLnR5cGUgPT09IFRhc2tUeXBlLnR3aXR0ZXJfYWN0aXZpdHlcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIGNoaWxkcmVuKHtcbiAgICBvbkNsaWNrOiAhbm9PbkNsaWNrKCkgPyBoYW5kbGVDbGljayA6IHVuZGVmaW5lZCxcbiAgICB0eXBlOiBnZXRUeXBlKCksXG4gICAgaXNMb2FkaW5nOiB0aGlyZFBhcnR5QXV0aC5pc0xvYWRpbmcgfHwgaXNQYXJ0aWNpcGF0aW9uTG9hZGluZyxcbiAgICBkaXNhYmxlZDogcGFydGljaXBhdGlvbkRpc2FibGVkIHx8IG1haW50ZW5hbmNlLFxuICAgIGNvbW1lbnQ6IHRhc2sucGFydGljaXBhdGlvbj8uY29tbWVudCxcbiAgfSk7XG59O1xuXG5jb25zdCBUYXNrV3JhcHBlcjogUmVhY3QuRkM8UHJvcHM+ID0gKHByb3BzOiBQcm9wcykgPT4ge1xuICBjb25zdCB7IHRhc2ssIHBhcnRpY2lwYXRpb25EaXNhYmxlZCwgbWFpbnRlbmFuY2UsIGVycm9yQ2FsbGJhY2ssIG9uU3VjY2VzcyB9ID1cbiAgICBwcm9wcztcbiAgcmV0dXJuIChcbiAgICA8VGFza1Byb3ZpZGVyIGVycm9yQ2FsbGJhY2s9e2Vycm9yQ2FsbGJhY2t9PlxuICAgICAgPFRoaXJkUGFydHlBdXRoUHJvdmlkZXIgZXJyb3JDYWxsYmFjaz17ZXJyb3JDYWxsYmFja30+XG4gICAgICAgIDxUYXNrV3JhcHBlckJhc2VcbiAgICAgICAgICB0YXNrPXt0YXNrfVxuICAgICAgICAgIHBhcnRpY2lwYXRpb25EaXNhYmxlZD17cGFydGljaXBhdGlvbkRpc2FibGVkfVxuICAgICAgICAgIG1haW50ZW5hbmNlPXttYWludGVuYW5jZX1cbiAgICAgICAgICBjYWxsYmFja3M9e3Byb3BzLmNhbGxiYWNrc31cbiAgICAgICAgICBvblN1Y2Nlc3M9e29uU3VjY2Vzc31cbiAgICAgICAgPlxuICAgICAgICAgIHtwcm9wcy5jaGlsZHJlbn1cbiAgICAgICAgPC9UYXNrV3JhcHBlckJhc2U+XG4gICAgICA8L1RoaXJkUGFydHlBdXRoUHJvdmlkZXI+XG4gICAgPC9UYXNrUHJvdmlkZXI+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBUYXNrV3JhcHBlcjtcbiIsImV4cG9ydCBlbnVtIE1pc3Npb25UeXBlIHtcbiAgZ3VhcmFudGVlZCA9IFwiZ3VhcmFudGVlZFwiLFxuICBzY29yZWJvYXJkID0gXCJzY29yZWJvYXJkXCIsXG4gIGxvdHRlcnkgPSBcImxvdHRlcnlcIixcbn1cblxuZXhwb3J0IGVudW0gTWlzc2lvblJld2FyZFR5cGUge1xuICBjcnlwdG8gPSBcImNyeXB0b1wiLFxuICBwb2ludHMgPSBcInBvaW50c1wiLFxuICBwb2ludHNfcGVyX3Rhc2sgPSBcInBvaW50c19wZXJfdGFza1wiLFxufVxuIiwiZXhwb3J0IGVudW0gUXVlc3RXZWJob29rVHlwZSB7XG4gIHBhcnRpY2lwYW50X3Jld2FyZF9hZGRlZCA9ICdwYXJ0aWNpcGFudF9yZXdhcmRfYWRkZWQnLFxuICBwYXJ0aWNpcGFudF9yZXdhcmRfcmVtb3ZlZCA9ICdwYXJ0aWNpcGFudF9yZXdhcmRfcmVtb3ZlZCcsXG4gIHRoaXJkX3BhcnR5X2F1dGhlbnRpY2F0ZWQgPSAndGhpcmRfcGFydHlfYXV0aGVudGljYXRlZCcsXG4gIHRhc2tfY29tcGxldGVkID0gJ3Rhc2tfY29tcGxldGVkJyxcbn1cbiIsImV4cG9ydCBlbnVtIFRhc2tWYWxpZGF0aW9uIHtcbiAgZW1haWwgPSBcImVtYWlsXCIsXG4gIGlzX2VxdWFsID0gXCJpc19lcXVhbFwiLFxufVxuIiwiaW1wb3J0IHsgR2FtZXNvY2lhbFByb3ZpZGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL2dhbWVzb2NpYWxcIjtcbmltcG9ydCB7IE1pc3Npb25zUHJvdmlkZXIgfSBmcm9tIFwiLi9wcm92aWRlcnMvbWlzc2lvbnNcIjtcbmltcG9ydCB7IFBhcnRpY2lwYW50UHJvdmlkZXIgfSBmcm9tIFwiLi9wcm92aWRlcnMvcGFydGljaXBhbnRcIjtcblxuZXhwb3J0IGNvbnN0IFF1ZXN0c1Byb3ZpZGVyID0gKHtcbiAgY2hpbGRyZW4sXG4gIGFwaUtleSxcbiAgYXBpVXJsLFxuICBlcnJvckNhbGxiYWNrLFxufToge1xuICBjaGlsZHJlbjogYW55O1xuICBhcGlLZXk6IHN0cmluZztcbiAgYXBpVXJsOiBzdHJpbmc7XG4gIGVycm9yQ2FsbGJhY2s/OiAoZXJyb3I6IGFueSkgPT4gdm9pZDtcbn0pID0+IHtcbiAgcmV0dXJuIChcbiAgICA8R2FtZXNvY2lhbFByb3ZpZGVyIGFwaUtleT17YXBpS2V5fSBhcGlVcmw9e2FwaVVybH0+XG4gICAgICA8UGFydGljaXBhbnRQcm92aWRlciBlcnJvckNhbGxiYWNrPXtlcnJvckNhbGxiYWNrfT5cbiAgICAgICAgPE1pc3Npb25zUHJvdmlkZXI+e2NoaWxkcmVufTwvTWlzc2lvbnNQcm92aWRlcj5cbiAgICAgIDwvUGFydGljaXBhbnRQcm92aWRlcj5cbiAgICA8L0dhbWVzb2NpYWxQcm92aWRlcj5cbiAgKTtcbn07XG4iXX0=